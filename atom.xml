<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Gmet&#39;s Blog</title>
  
  <subtitle>Eureka!</subtitle>
  <link href="https://guoyujian.github.io/atom.xml" rel="self"/>
  
  <link href="https://guoyujian.github.io/"/>
  <updated>2023-11-28T06:26:53.432Z</updated>
  <id>https://guoyujian.github.io/</id>
  
  <author>
    <name>Met Guo</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CloudCompareå¸¸ç”¨æ“ä½œåŠPythonæ’ä»¶</title>
    <link href="https://guoyujian.github.io/2023/11/28/CloudCompare%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E5%8F%8APython%E6%8F%92%E4%BB%B6/"/>
    <id>https://guoyujian.github.io/2023/11/28/CloudCompare%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E5%8F%8APython%E6%8F%92%E4%BB%B6/</id>
    <published>2023-11-28T06:14:52.000Z</published>
    <updated>2023-11-28T06:26:53.432Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><blockquote><p>æœ€è¿‘åœ¨åšç‚¹äº‘å¤„ç†ç›¸å…³çš„å·¥ä½œï¼Œè¿™é‡Œæ‰¾åˆ°äº†ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å¼€æºè½¯ä»¶CloudCompareï¼ˆä¸‹ç§°CCï¼‰ã€‚è¿™é‡Œå¯¹æˆ‘çš„å¸¸ç”¨æ“ä½œè¿›è¡Œæ€»ç»“ï¼Œå¹¶ä»‹ç»CCçš„Pythonæ’ä»¶ï¼Œè¯¥æ’ä»¶å¯ä»¥å®ç°è‡ªå®šä¹‰çš„ç‚¹äº‘æ“ä½œå®ç°ï¼Œæå¤§åœ°æ‰©å±•äº†CCçš„åŠŸèƒ½ã€‚</p></blockquote><h1 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h1><h2 id="ç‚¹äº‘æŒ‰é«˜ç¨‹èµ‹è‰²"><a href="#ç‚¹äº‘æŒ‰é«˜ç¨‹èµ‹è‰²" class="headerlink" title="ç‚¹äº‘æŒ‰é«˜ç¨‹èµ‹è‰²"></a>ç‚¹äº‘æŒ‰é«˜ç¨‹èµ‹è‰²</h2><p>æ‰“å¼€çš„ç‚¹äº‘æ²¡æœ‰é¢œè‰²ï¼Œå¾ˆéš¾çœ‹ä¸”å¾ˆéš¾æ“ä½œï¼Œä¸ºäº†è®©ç‚¹äº‘æ›´æœ‰ç«‹ä½“æ„Ÿï¼Œå¯ä»¥æŒ‰é«˜ç¨‹å¯¹ç‚¹äº‘è¿›è¡Œèµ‹è‰²ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Edit -&gt; Colors -&gt; Height Ramp</span><br></pre></td></tr></table></figure><p><img src="wps1-20231128113644-3f440qp.jpg" alt="img"></p><p>CCä¹Ÿå¯ä»¥æŒ‰ç…§å…¶ä»–è½´è¿›è¡Œèµ‹è‰²</p><p><code>Edit -&gt; Scalar fields -&gt; export coordinate to SF</code>ï¼Œ é€‰æ‹©x/y/zè½´</p><p><img src="wps2-20231128113644-ecarnyw.jpg" alt="img"></p><p><img src="wps3-20231128113644-ibdm0ik.jpg" alt="img"></p><h2 id="ä½¿ç”¨å¤šè¾¹å½¢å¯¹ç‚¹äº‘è£å‰ª"><a href="#ä½¿ç”¨å¤šè¾¹å½¢å¯¹ç‚¹äº‘è£å‰ª" class="headerlink" title="ä½¿ç”¨å¤šè¾¹å½¢å¯¹ç‚¹äº‘è£å‰ª"></a>ä½¿ç”¨å¤šè¾¹å½¢å¯¹ç‚¹äº‘è£å‰ª</h2><p><a href="https://blog.csdn.net/qq_32867925/article/details/124187166">https://blog.csdn.net/qq_32867925/article/details/124187166</a></p><h2 id="è®¡ç®—ç‚¹äº‘ä¸­ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»"><a href="#è®¡ç®—ç‚¹äº‘ä¸­ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»" class="headerlink" title="è®¡ç®—ç‚¹äº‘ä¸­ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»"></a>è®¡ç®—ç‚¹äº‘ä¸­ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»</h2><p><a href="https://blog.csdn.net/qq_36686437/article/details/122224036">https://blog.csdn.net/qq_36686437/article/details/122224036</a></p><h2 id="ä¸‹é‡‡æ ·"><a href="#ä¸‹é‡‡æ ·" class="headerlink" title="ä¸‹é‡‡æ ·"></a>ä¸‹é‡‡æ ·</h2><p><a href="https://blog.csdn.net/qq_27353621/article/details/124008810">https://blog.csdn.net/qq_27353621/article/details/124008810</a></p><h2 id="ç»Ÿè®¡æ»¤æ³¢"><a href="#ç»Ÿè®¡æ»¤æ³¢" class="headerlink" title="ç»Ÿè®¡æ»¤æ³¢"></a>ç»Ÿè®¡æ»¤æ³¢</h2><p><a href="https://blog.csdn.net/qq_36686437/article/details/120011047">https://blog.csdn.net/qq_36686437/article/details/120011047</a></p><p>CCå¥½åƒæ²¡æœ‰å®ç°åŠå¾„æ»¤æ³¢ï¼Œéœ€è¦è‡ªè¡Œå®ç°</p><h2 id="è®¡ç®—ä½“ç§¯"><a href="#è®¡ç®—ä½“ç§¯" class="headerlink" title="è®¡ç®—ä½“ç§¯"></a>è®¡ç®—ä½“ç§¯</h2><p><a href="https://www.cnblogs.com/codeAndlearn/p/12317673.html">https://www.cnblogs.com/codeAndlearn/p/12317673.html</a></p><p>CCè®¡ç®—çš„å¹¶éæ˜¯ç‚¹äº‘çš„å‡¸åŒ…ä½“ç§¯ï¼ŒCCå¥½åƒæ²¡æœ‰å®ç°å‡¸åŒ…ä½“ç§¯è®¡ç®—ï¼Œéœ€è¦è‡ªè¡Œå®ç°</p><h2 id="åˆ›å»ºçƒå¹¶ç§»åŠ¨ï¼Œè®¡ç®—çƒå’Œçƒä¹‹é—´çš„è·ç¦»"><a href="#åˆ›å»ºçƒå¹¶ç§»åŠ¨ï¼Œè®¡ç®—çƒå’Œçƒä¹‹é—´çš„è·ç¦»" class="headerlink" title="åˆ›å»ºçƒå¹¶ç§»åŠ¨ï¼Œè®¡ç®—çƒå’Œçƒä¹‹é—´çš„è·ç¦»"></a>åˆ›å»ºçƒå¹¶ç§»åŠ¨ï¼Œè®¡ç®—çƒå’Œçƒä¹‹é—´çš„è·ç¦»</h2><p>æœ‰æ—¶éœ€è¦è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œä½†æ˜¯è¿™ä¸¤ç‚¹è™½ç„¶ä»£è¡¨ç‚¹äº‘ä½†å¹¶ä¸åœ¨ç‚¹äº‘é›†åˆä¸­ï¼Œéœ€è¦è‡ªå®šä¹‰ä½ç½®ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸¤ä¸ªçƒï¼Œç„¶åå°†å®ƒä»¬æ‹–åŠ¨åˆ°æŒ‡å®šä½ç½®ï¼Œç„¶åå†è®¡ç®—è·ç¦»ã€‚</p><p>é¦–å…ˆï¼Œåˆ›å»ºçƒ</p><p><code>File -&gt; Primitive Factory</code>ï¼Œé€‰æ‹©sphereï¼Œç¡®å®šä½ç½®å’ŒåŠå¾„</p><p><img src="wps4-20231128113644-n938rmx.jpg?lastModify=1701152207" alt="img"></p><p>ç„¶åæ‹–åŠ¨çƒï¼šé€‰ä¸­çƒï¼Œå¹¶ç‚¹é€‰ä¸‹å›¾å›¾æ ‡ã€‚é¼ æ ‡å³é”®æ‹–åŠ¨ã€‚</p><p><img src="wps5-20231128113644-mbw49ys.jpg" alt="img"></p><p>å°†ä¸¤ä¸ªçƒæ‹–åŠ¨åˆ°åˆé€‚çš„ä½ç½®ï¼Œè®¡ç®—è·ç¦»</p><p><img src="wps6-20231128113644-oc6tpfo.jpg?lastModify=1701152207" alt="img"></p><h2 id="æ›´å¤šæ“ä½œ"><a href="#æ›´å¤šæ“ä½œ" class="headerlink" title="æ›´å¤šæ“ä½œ"></a>æ›´å¤šæ“ä½œ</h2><p>è¿™é‡Œæœ‰äººæ€»ç»“äº†CCçš„æ“ä½œï¼Œéå¸¸å…¨é¢ã€‚</p><p><a href="https://blog.csdn.net/qq_36686437/article/details/120100839">https://blog.csdn.net/qq_36686437/article/details/120100839</a></p><h1 id="CC-Pythonæ’ä»¶"><a href="#CC-Pythonæ’ä»¶" class="headerlink" title="CC-Pythonæ’ä»¶"></a>CC-Pythonæ’ä»¶</h1><h2 id="å‰ç½®æ¡ä»¶-Win10"><a href="#å‰ç½®æ¡ä»¶-Win10" class="headerlink" title="å‰ç½®æ¡ä»¶(Win10)"></a>å‰ç½®æ¡ä»¶(Win10)</h2><p>ä½¿ç”¨è¯¥æ’ä»¶éœ€è¦å®‰è£…æœ€æ–°ç‰ˆçš„CCï¼Œæˆ‘å®‰è£…çš„ç‰ˆæœ¬æ˜¯2.13</p><p><img src="image-20231128114621-bo1kz5e.png" alt="image"></p><p>åœ¨å®‰è£…æ—¶ï¼Œè®°å¾—å‹¾é€‰</p><p><img src="image-20231128114706-bwwrkfk.png" alt="image"></p><blockquote><p>Windowsæ˜¯ç›´æ¥å¸¦æœ‰è¿™ä¸ªæ’ä»¶çš„ï¼Œè€ŒMacOSä¸‹å®‰è£…è¯¥æ’ä»¶éœ€è¦è‡ªå·±å»ç¼–è¯‘æ’ä»¶ä»£ç å¹¶å®‰è£…ã€‚</p><p>è¿™æ˜¯æ’ä»¶ä»£ç çš„æ–‡æ¡£ï¼š<a href="https://tmontaigu.github.io/CloudCompare-PythonPlugin/">https://tmontaigu.github.io/CloudCompare-PythonPlugin/</a></p><p>åŒ…æ‹¬å¦‚ä½•ç¼–è¯‘æºç &amp;Useage</p></blockquote><p>å®‰è£…å®Œæˆåï¼Œè®°å¾—æ›´æ–°ä¸€ä¸‹pipï¼š</p><p>è¿›å…¥å®‰è£…ç›®å½•ä¸‹<code>CloudCompare/plugins/Python</code>ï¼Œæ‰§è¡Œ<code>.\python.exe -m pip install --upgrade pip</code></p><h2 id="ä½¿ç”¨æ’ä»¶ç¤ºä¾‹"><a href="#ä½¿ç”¨æ’ä»¶ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨æ’ä»¶ç¤ºä¾‹"></a>ä½¿ç”¨æ’ä»¶ç¤ºä¾‹</h2><p>æœ‰äº›ç‚¹äº‘æ–‡ä»¶å·¨å¤§ï¼ŒåŠ è½½è¿›æ¥ä¼šå¾ˆæ…¢ï¼Œæˆ‘è¿™é‡Œå…ˆå°†ç‚¹äº‘é™é‡‡æ ·ä¹‹åæ‰æŠŠä»–åŠ è½½åˆ°CCä¸­ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘éœ€è¦å®‰è£…open3d</p><p>æ‰“å¼€Python Managerï¼š <code>Plugins -&gt; Python Plugins -&gt; Package Manager</code></p><p><img src="image-20231128120020-x27frq0.png" alt="image">ç‚¹å‡»installï¼Œè¾“å…¥open3d è¿›è¡Œå®‰è£…ã€‚</p><p><img src="image-20231128120130-6obtvph.png" alt="image"></p><p>æ‰“å¼€Show REPLï¼š <code>Plugins -&gt; Python Plugins -&gt; Show REPL</code></p><p>çº¢æ¡†è¾“å…¥æŒ‡ä»¤</p><p><img src="image-20231128120448-c9cul9e.png" alt="image"></p><p>ä»¥ä¸‹æ˜¯æˆ‘è¾“å…¥çš„æŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import pycc</span><br><span class="line">&gt;&gt;&gt; import cccorelib</span><br><span class="line">&gt;&gt;&gt; cc = pycc.GetInstance()</span><br><span class="line">&gt;&gt;&gt; import open3d as o3d</span><br><span class="line">&gt;&gt;&gt; import numpy as np</span><br><span class="line">&gt;&gt;&gt; pcd = o3d.io.read_point_cloud(&#x27;C:/Users/Administrator/Desktop/merged_room.pcd&#x27;)</span><br><span class="line">&gt;&gt;&gt; pcd = pcd.voxel_down_sample(0.5)</span><br><span class="line">&gt;&gt;&gt; points = np.asarray(pcd.points)</span><br><span class="line">&gt;&gt;&gt; xs = points[:, 0]</span><br><span class="line">&gt;&gt;&gt; ys = points[:, 1]</span><br><span class="line">&gt;&gt;&gt; zs = points[:, 2]</span><br><span class="line">&gt;&gt;&gt; pc = pycc.ccPointCloud(xs, ys, zs)</span><br><span class="line">&gt;&gt;&gt; cc.addToDB(pc)</span><br></pre></td></tr></table></figure><p>è‡³æ­¤å¯ä»¥çœ‹åˆ°CCåœºæ™¯ä¸­å·²ç»åŠ è½½äº†ç‚¹äº‘</p><p><img src="image-20231128120849-90hz4hw.png" alt="image"></p><p>æˆ‘ä»¬å¯ä»¥ç”¨æ’ä»¶å®ç°å‰é¢CCæœªå®ç°çš„è¯¸å¤šåŠŸèƒ½ã€‚æ›´å¤šç”¨æ³•å¯ä»¥å‚è€ƒå‰æ–‡æåˆ°çš„æ’ä»¶çš„å®˜æ–¹æ–‡æ¡£ã€‚</p><h1 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;æœ€è¿‘åœ¨åšç‚¹äº‘å¤„ç†ç›¸å…³çš„å·¥ä½œï¼Œè¿™é‡Œæ‰¾åˆ°äº†ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å¼€æºè½¯ä»¶CloudCompareï¼ˆä¸‹ç§°CCï¼‰ã€‚è¿™é‡Œå¯¹æˆ‘çš„å¸¸ç”¨æ“</summary>
      
    
    
    
    <category term="ç‚¹äº‘æ•°æ®å¤„ç†" scheme="https://guoyujian.github.io/categories/%E7%82%B9%E4%BA%91%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/"/>
    
    
    <category term="CloudCompare" scheme="https://guoyujian.github.io/tags/CloudCompare/"/>
    
    <category term="Point Cloud" scheme="https://guoyujian.github.io/tags/Point-Cloud/"/>
    
  </entry>
  
  <entry>
    <title>CPUå¯†é›†å‹ä»»åŠ¡çš„åç«¯å®ç°æ–¹æ³•æ¯”è¾ƒæ€»ç»“</title>
    <link href="https://guoyujian.github.io/2023/10/19/CPU%E5%AF%86%E9%9B%86%E5%9E%8B%E4%BB%BB%E5%8A%A1%E7%9A%84%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95%E6%AF%94%E8%BE%83%E6%80%BB%E7%BB%93/"/>
    <id>https://guoyujian.github.io/2023/10/19/CPU%E5%AF%86%E9%9B%86%E5%9E%8B%E4%BB%BB%E5%8A%A1%E7%9A%84%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95%E6%AF%94%E8%BE%83%E6%80%BB%E7%BB%93/</id>
    <published>2023-10-19T14:38:32.000Z</published>
    <updated>2023-10-19T14:49:55.040Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>å…ˆä»‹ç»ä¸‹æ•´ä½“ç³»ç»Ÿæ¡†æ¶ï¼Œç³»ç»Ÿåˆ†ä¸ºå‰ç«¯å’Œåç«¯ï¼ŒäºŒè€…é€šè¿‡websocketåè®®è¿›è¡Œé€šä¿¡ã€‚é€šè¿‡è¯·æ±‚æ•°æ®ä¸­çš„codeå­—æ®µæ¥å“åº”ä¸åŒçš„æ“ä½œã€‚</p><p><img src="å‰åç«¯é€šä¿¡.png" alt="å‰åç«¯é€šä¿¡"></p><p><img src="æ—¶åºå›¾.png" alt="æ—¶åºå›¾"></p><p><img src="åç«¯å¤„ç†ä¸€æ¬¡è¯·æ±‚çš„æµç¨‹å›¾.png" alt="åç«¯å¤„ç†ä¸€æ¬¡è¯·æ±‚çš„æµç¨‹å›¾"></p><p>ä»¥ä¸Šä»‹ç»æ•´ä½“çš„è½¯ä»¶é€»è¾‘ã€‚æ­¤å¤–ï¼Œåç«¯ä½¿ç”¨Pythonçš„asyncioæ¥å®ç°å¼‚æ­¥ç¼–ç¨‹ã€‚</p><p>ä¾‹å¦‚ï¼Œå®ç°å°†æ•°æ®æ’å…¥åˆ°æ•°æ®åº“å¹¶å°†æ•°æ®å‘é€åˆ°å‰ç«¯ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">insert_data2db(data)</span><br><span class="line">ws_send(websocket, data)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç¨‹åºæ˜¯é¡ºåºæ‰§è¡Œçš„ã€‚å¼‚æ­¥ç‰ˆæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">await</span> insert_data2db(data)</span><br><span class="line"><span class="keyword">await</span> ws_send(websocket, data)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œç¨‹åºä¸ä¼šç­‰å¾…insert_data2dbå®Œæˆï¼Œç›´æ¥ç»§ç»­æ‰§è¡Œws_sendæ–¹æ³•ã€‚ä¸¤è€…åŒºåˆ«å¦‚ä¸‹è‰å›¾ï¼š</p><p><img src="åŒæ­¥å¼‚æ­¥.png" alt="åŒæ­¥å¼‚æ­¥"></p><p>è¿™ç§å¼‚æ­¥çš„æ–¹å¼åœ¨IO-Bound Taskä¸­å¥½ç”¨ã€‚ä½†æ˜¯å¯¹äºCPU-Bound Taskä¼˜åŒ–æ•ˆæœä¸å¤§ï¼ˆç”šè‡³ä¼šæœ‰åæ•ˆæœï¼‰</p><p>æ­¤å¤–ï¼Œå¦‚æœåä¸€ä¸ªæ“ä½œéœ€è¦ç”¨åˆ°å‰ä¸€ä¸ªæ“ä½œçš„ç»“æœï¼Œè¿™ä¸ªä»£ç å®é™…æ˜¯é¡ºåºæ‰§è¡Œçš„ã€‚</p><h1 id="ä¸»è¦ä»£ç ç»“æ„ï¼ˆä¼ªï¼‰"><a href="#ä¸»è¦ä»£ç ç»“æ„ï¼ˆä¼ªï¼‰" class="headerlink" title="ä¸»è¦ä»£ç ç»“æ„ï¼ˆä¼ªï¼‰"></a>ä¸»è¦ä»£ç ç»“æ„ï¼ˆä¼ªï¼‰</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">ws_send</span>(<span class="params">websocket, data</span>)</span><br><span class="line"><span class="keyword">await</span> websocket.send(data)</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯é€šè¿‡websocketè¿æ¥å°†æ•°æ®å‘é€å›å‰ç«¯çš„é€šç”¨æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">dealPointCloudData</span>(<span class="params">websocket, request_data</span>):</span><br><span class="line">code = request_data[<span class="string">&#x27;code&#x27;</span>]</span><br><span class="line"><span class="keyword">if</span> code == <span class="number">0</span>:</span><br><span class="line"><span class="comment"># å¿ƒè·³</span></span><br><span class="line"><span class="keyword">await</span> ws_send(websocket, response_heartbeat_data)</span><br><span class="line"><span class="keyword">elif</span> code == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">await</span> func1()</span><br><span class="line"><span class="keyword">elif</span> code == <span class="number">2</span>:</span><br><span class="line"><span class="keyword">await</span> func2(websocket, request_data)</span><br><span class="line"><span class="comment"># ...</span></span><br></pre></td></tr></table></figure><p>å…¶æ¬¡ï¼Œæ˜¯åˆ†å‘è¯·æ±‚çš„æ–¹æ³•dealPointCloudDataï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œwebsocketè¿æ¥å’Œrequest_dataå‰ç«¯å‘æ¥çš„æ•°æ®ã€‚</p><p>æœ€åï¼Œä¸»ç¨‹åºä¸­ä¼šèµ·ä¸€ä¸ªwebsocketæœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ä¼šå°†è¿æ¥å‘é€åˆ°dispatchæ–¹æ³•ï¼Œdispatchæ–¹æ³•ä¼šè½®è¯¢æ¯ä¸€ä¸ªwebsocketè¿æ¥çš„æ¶ˆæ¯ï¼Œå¹¶äº¤ç»™dealPointCloudDataå¤„ç†ã€‚ä¼ªä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">server = websockets.serve(dispatch, ip, port)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">dispatch</span>(<span class="params">websocket_conn</span>):</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">for</span> message <span class="keyword">in</span> websocket:  <span class="comment"># recv message from a websocket client.</span></span><br><span class="line">msg_dict = parse_json(message)</span><br><span class="line"><span class="keyword">await</span> dealPointCloudData(websocket, msg_dict)</span><br></pre></td></tr></table></figure><h1 id="ç°çŠ¶"><a href="#ç°çŠ¶" class="headerlink" title="ç°çŠ¶"></a>ç°çŠ¶</h1><p>ç›®å‰ï¼Œå½“code==2æ—¶ï¼Œéœ€è¦å¤„ç†ä¸€ä¸ªè®¡ç®—ä»»åŠ¡ã€‚request_dataå‚æ•°ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶å¤¹è·¯å¾„ï¼Œè¯¥è®¡ç®—ä»»åŠ¡æ˜¯è¯»å–æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å†…å®¹ï¼Œå°†æ–‡ä»¶å†…å®¹è¿›è¡Œmergeï¼Œæœ€ç»ˆç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶ã€‚æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="è®¡ç®—æµç¨‹.png" alt="è®¡ç®—æµç¨‹"></p><p>ä¼ªä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func2</span>(<span class="params">websocket, request_data</span>):</span><br><span class="line">total = init()</span><br><span class="line">file_list = get_file_list(request_data) <span class="comment"># ä»request_dataä¸­å–å‡ºæ–‡ä»¶å¤¹ï¼Œ</span></span><br><span class="line"><span class="keyword">for</span> i, file_path <span class="keyword">in</span> <span class="built_in">enumerate</span>(file_list):</span><br><span class="line">obj = read_file_as_obj(file_path)</span><br><span class="line">total = merge(total, obj)</span><br><span class="line"><span class="keyword">await</span> ws_send(websocket, <span class="string">&#x27;è¿›åº¦ï¼š...&#x27;</span>) <span class="comment"># æœ¬æ¬¡mergeç»“æŸåå‘å‰ç«¯å‘é€è¿›åº¦</span></span><br><span class="line">save2file(total)</span><br><span class="line"><span class="keyword">await</span> ws_send(websocket, finish_flag)</span><br></pre></td></tr></table></figure><p>ç”±äºfunc2ä¸»è¦æ—¶é—´èŠ±è´¹åœ¨ä¸€ä¸ªforå¾ªç¯ä¸­ï¼Œ æ¯æ¬¡forå¾ªç¯ä¸­éƒ½æœ‰ä¸€ä¸ªè€—æ—¶çš„è®¡ç®—ä»»åŠ¡mergeã€‚mergeæ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•</p><p>æ‰€ä»¥func2ä¸­è™½ç„¶ä½¿ç”¨äº†awaitå¼‚æ­¥ç¼–ç¨‹ï¼Œä½†æ•´ä½“æ¥çœ‹ï¼Œè¿˜æ˜¯ä¸ªåŒæ­¥å¤„ç†ç¨‹åºã€‚</p><p>è¿™å°±å¯¼è‡´ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå°±æ˜¯å½“å•çº¿ç¨‹æ‰§è¡Œfunc2è¿›è¡Œé•¿æ—¶é—´è®¡ç®—çš„æ—¶å€™ï¼Œæ–°çš„å¿ƒè·³åŒ…è¯·æ±‚-å“åº”ä¼šè¢«é˜»å¡æ‰ã€‚å¦‚å›¾</p><p><img src="å¿ƒè·³å“åº”é˜»å¡.png" alt="å¿ƒè·³å“åº”é˜»å¡"></p><p>å¦‚æœé˜»å¡çš„æ—¶é—´è¿‡é•¿ï¼Œå‰åç«¯å°±ä¼šå¤±å»æœ¬æ¬¡è¿æ¥ã€‚</p><p>é’ˆå¯¹è¯¥é—®é¢˜ï¼Œæˆ‘å°è¯•äº†å‡ ç§è§£å†³æ–¹æ³•ã€‚</p><h1 id="å°è¯•"><a href="#å°è¯•" class="headerlink" title="å°è¯•"></a>å°è¯•</h1><h2 id="1-å¼€å¯çº¿ç¨‹æ‰§è¡Œè®¡ç®—ï¼ˆmergeï¼‰"><a href="#1-å¼€å¯çº¿ç¨‹æ‰§è¡Œè®¡ç®—ï¼ˆmergeï¼‰" class="headerlink" title="1 å¼€å¯çº¿ç¨‹æ‰§è¡Œè®¡ç®—ï¼ˆmergeï¼‰"></a>1 å¼€å¯çº¿ç¨‹æ‰§è¡Œè®¡ç®—ï¼ˆmergeï¼‰</h2><p>func2å‡½æ•°ä¸­å¼€å¯ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ‰§è¡Œè®¡ç®—ï¼Œå¹¶è¿”å›æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func2</span>(<span class="params">websocket, request_data</span>):</span><br><span class="line">    t = DealPcdsThread(websocket, other_params)</span><br><span class="line">    t.start()</span><br></pre></td></tr></table></figure><p>DealPcdsThreadçº¿ç¨‹ç±»çš„å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DealPcdsThread</span>(threading.Thread):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å¤„ç†pcdæ–‡ä»¶å¤¹çš„çº¿ç¨‹</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, websocket, request_data</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        file_list = get_file_list(request_data)</span><br><span class="line">        self.websocket = websocket</span><br><span class="line">        self.file_list = file_list </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        asyncio.run(self.merge()) <span class="comment"># åœ¨çº¿ç¨‹ä¸­å¼€å¯æ–°çš„äº‹ä»¶å¾ªç¯æ¥æ‰§è¡Œåç¨‹å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">self</span>):</span><br><span class="line">        total = init()</span><br><span class="line">file_list = get_file_list(request_data) <span class="comment"># ä»request_dataä¸­å–å‡ºæ–‡ä»¶å¤¹ï¼Œ</span></span><br><span class="line"><span class="keyword">for</span> i, file_path <span class="keyword">in</span> <span class="built_in">enumerate</span>(file_list):</span><br><span class="line">obj = read_file_as_obj(file_path)</span><br><span class="line">total = merge(total, obj)</span><br><span class="line">log.info(<span class="string">f&#x27;...&#x27;</span>)</span><br><span class="line"><span class="keyword">await</span> ws_send(websocket, <span class="string">&#x27;è¿›åº¦ï¼š...&#x27;</span>) <span class="comment"># æœ¬æ¬¡mergeç»“æŸåå‘å‰ç«¯å‘é€è¿›åº¦</span></span><br><span class="line">save2file(total)</span><br><span class="line"><span class="keyword">await</span> ws_send(websocket, finish_flag)</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—å¦‚å›¾ï¼š</p><p><img src="æ§åˆ¶å°æ—¥å¿—.png" alt="æ§åˆ¶å°æ—¥å¿—"></p><p>è¿™è¯´æ˜åœ¨å¤„ç†è®¡ç®—ä»»åŠ¡æ—¶ï¼Œä¸»çº¿ç¨‹æ²¡æœ‰é˜»å¡ï¼Œå¿ƒè·³åŒ…èƒ½å¤Ÿæ­£å¸¸è¿”å›ï¼Œå’Œé¢„æœŸä¸€è‡´ã€‚</p><p>æœ¬æ¥é—®é¢˜åˆ°è¿™é‡Œå°±è§£å†³äº†ï¼Œä½†æ˜¯åœ¨å®é™…æµ‹è¯•ä¸­åˆå‘ç°äº†å…¶ä»–é—®é¢˜ã€‚</p><h3 id="é—®é¢˜1-å‰ç«¯æ˜¾ç¤ºä¸æµç•…"><a href="#é—®é¢˜1-å‰ç«¯æ˜¾ç¤ºä¸æµç•…" class="headerlink" title="é—®é¢˜1: å‰ç«¯æ˜¾ç¤ºä¸æµç•…"></a>é—®é¢˜1: å‰ç«¯æ˜¾ç¤ºä¸æµç•…</h3><p><img src="åˆæˆè¿›åº¦æ¡.gif" alt="åˆæˆè¿›åº¦æ¡"></p><p>å¦‚å›¾å¯ä»¥çœ‹åˆ°è¿›åº¦æ¡å¡åœ¨2.21%åï¼Œè¿‡äº†å‡ ç§’éå¸¸è¿…é€Ÿçš„è¹¦åˆ°äº†40.79%ã€‚ä½†æ˜¯åå°çš„æ—¥å¿—æ‰“å°æ˜¯â€œæµç•…çš„â€ï¼Œå³æ²¡æœ‰ç±»ä¼¼çš„åœé¡¿ã€‚</p><p>çŒœæµ‹å¯èƒ½æ˜¯å’Œå¼‚æ­¥æœ‰å…³ï¼Œæ¯•ç«Ÿåœ¨<code>await ws_send()</code>â€‹åç›´æ¥è¿”å›äº†ï¼Œäº‹ä»¶å¾ªç¯é€‰æ‹©äº†æŸä¸ªæ—¶é—´ç‚¹ç»Ÿä¸€å‘é€è¿™äº›è¯·æ±‚ã€‚</p><p>ä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯è®¡ç®—çº¿ç¨‹å¤±å»äº†CPUçš„æ§åˆ¶æƒå¯¼è‡´çš„ï¼Œåæ¥ä¸€æƒ³å¯èƒ½æ€§ä¸å¤§ï¼Œä¸€æ–¹é¢å ç”¨æ—¶é—´åº”è¯¥åœ¨å¾ˆçŸ­çš„æ—¶é—´ï¼Œæˆ‘åº”è¯¥æ„Ÿè§‰ä¸åˆ°ï¼Œå¦ä¸€æ–¹é¢ï¼Œåå°æ—¥å¿—æ‰“å°æµç•…ã€‚</p><h3 id="é—®é¢˜2-åå°æŠ¥é”™"><a href="#é—®é¢˜2-åå°æŠ¥é”™" class="headerlink" title="é—®é¢˜2: åå°æŠ¥é”™"></a>é—®é¢˜2: åå°æŠ¥é”™</h3><p>åœ¨æ‰§è¡Œè®¡ç®—çš„è¿‡ç¨‹ï¼Œå‡ºç°æŠ¥é”™å¦‚ä¸‹å›¾</p><p><img src="æŠ¥é”™.png" alt="æŠ¥é”™"></p><p>è¯¥æŠ¥é”™æˆ‘æœç´¢äº†å¾ˆä¹…ä¹Ÿæ²¡æœ‰æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œåœ¨åŠ ä¸Šè¯¥æŠ¥é”™ä¸ä¼šå¯¼è‡´ä»»åŠ¡å¤±è´¥ï¼Œä¹Ÿä¸ä¼šæœ‰å…¶ä»–å½±å“ã€‚æ‰€ä»¥æç½®äº†ã€‚</p><p>è¯¥æ–¹æ¡ˆæ˜¯ç›®å‰æœ€å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä¹Ÿå°è¯•äº†å¾ˆå¤šå…¶ä»–è§£å†³æ–¹æ¡ˆã€‚è¿™é‡Œä¹Ÿä¸€å¹¶åˆ—å‡ºã€‚</p><h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p>æ–¹æ¡ˆ2ä¸æ–¹æ¡ˆ1ç›¸åŒï¼ŒåŒæ ·æ˜¯å¼€å¯æ–°çº¿ç¨‹æ‰§è¡Œåˆå¹¶ï¼Œåªæ˜¯æ–°çš„äº‹ä»¶å¾ªç¯æœ‰ä¸»çº¿ç¨‹åˆ›å»ºï¼Œè€Œéåœ¨æ–°çº¿ç¨‹ä¸­åˆ›å»ºã€‚æµ‹è¯•è¿™ä¸¤ç§æ–¹æ³•è¡¨ç°ä¸€è‡´ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func2</span>(<span class="params">websocket, request_data</span>):</span><br><span class="line">new_loop: AbstractEventLoop = asyncio.new_event_loop()</span><br><span class="line">    <span class="comment"># å®šä¹‰</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">start_loop</span>(<span class="params">loop: AbstractEventLoop</span>):</span><br><span class="line">        asyncio.set_event_loop(loop)</span><br><span class="line">        loop.run_forever()</span><br><span class="line">    <span class="comment">#é€šè¿‡å½“å‰çº¿ç¨‹å¼€å¯æ–°çš„çº¿ç¨‹å¯åŠ¨äº‹ä»¶å¾ªç¯</span></span><br><span class="line">    t = threading.Thread(target=start_loop, args= (new_loop,))</span><br><span class="line">    t.start()</span><br><span class="line">    asyncio.run_coroutine_threadsafe(</span><br><span class="line">        DealPcdsThread(websocket, request_data).merge(),</span><br><span class="line">        new_loop</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p>ä½¿ç”¨asyncio.run_in_executorå°†ä»»åŠ¡æ”¾åˆ°çº¿ç¨‹æ± ä¸­è¿è¡Œ</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func2</span>(<span class="params">websocket, request_data</span>):</span><br><span class="line"><span class="comment"># 4.4 ä½¿ç”¨asyncio.run_in_executorå°†ä»»åŠ¡æ”¾åˆ°çº¿ç¨‹æ± ä¸­è¿è¡Œã€‚æ•ˆæœå’Œ4.2ä¸€æ ·</span></span><br><span class="line">loop: AbstractEventLoop = asyncio.get_event_loop()</span><br><span class="line"><span class="keyword">await</span> loop.run_in_executor(<span class="literal">None</span>, DealPcdsThread(websocket, request_data).run)</span><br><span class="line"><span class="comment"># await asyncio.to_thread(DealPcdsNoThread.run, loop) # new py3.9</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•è¯´æ˜ï¼Œè¿™ç§æ–¹æ³•ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå¯¼è‡´å¿ƒè·³åŒ…æ— æ³•åŠæ—¶å“åº”ã€‚ã€‚</p><h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p>ä¸ºäº†åŠ å¿«è®¡ç®—çš„é€Ÿåº¦ï¼Œæƒ³åˆ°å°è¯•å¼€å¯æ–°çš„è¿›ç¨‹æ‰§è¡Œè®¡ç®—ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Process(target=merge, args=(websocket, request_data)).start()</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ²¡æƒ³åˆ°ï¼Œè¿›ç¨‹ä¹‹é—´ä¼ é€’çš„Pythonå¯¹è±¡å¿…é¡»å¯ä»¥è¢«åºåˆ—åŒ–ï¼ˆpickleï¼‰æ‰å¯ä»¥ï¼Œè€Œwebsocketå¯¹è±¡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•æ— æ•ˆã€‚</p><h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><p>æœ€åä¸€ç§ï¼ŒåŒæ ·ä¹Ÿæ˜¯å¼€å¯ä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œä¸è¿‡targetä¼ å…¥çš„æ˜¯å¼‚æ­¥è®¡ç®—æ–¹æ³•ï¼ˆè™½ç„¶æ˜¯å¼‚æ­¥çš„ï¼Œä½†æ˜¯å†…éƒ¨ç¡®æ˜¯åŒæ­¥çš„ã€‚ã€‚ã€‚ï¼‰</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">threading.Thread(target=<span class="keyword">await</span> DealPcdsThread(websocket, request_data).merge()).start()</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•ä¹Ÿä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚</p><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>åœ¨å®éªŒè¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°å‡¡æ˜¯å¼€å¯æ–°çº¿ç¨‹å¹¶ä¸”æ–°çº¿ç¨‹ä¸­ä½¿ç”¨æ–°çš„äº‹ä»¶å¾ªç¯æ¥å¤„ç†å‘é€è¯·æ±‚éƒ½å¯ä»¥è®©ä¸»çº¿ç¨‹ä¸é˜»å¡ã€‚ä¾‹å¦‚æ–¹æ¡ˆ1ã€2</p><p>ä½†æ˜¯å¦‚æœåªå¼€æ–°çº¿ç¨‹ï¼Œè€Œäº‹ä»¶å¾ªç¯ä¾ç„¶ä½¿ç”¨ä¸»çº¿ç¨‹loopçš„è¯ï¼Œä¸èƒ½è§£å†³ä¸»çº¿ç¨‹é˜»å¡çš„é—®é¢˜ã€‚ä¾‹å¦‚æ–¹æ¡ˆ3ã€5</p><h1 id="å±•æœ›"><a href="#å±•æœ›" class="headerlink" title="å±•æœ›"></a>å±•æœ›</h1><ol><li>ç”¨<code>concurrent.futures.ThreadPoolExecutor</code>â€‹æ›¿æ¢threadingã€‚<code>concurrent.futures.ThreadPoolExecutor</code>â€‹æä¾›äº†ä¸€ä¸ªé«˜å±‚çº§æ¥å£ç”¨æ¥å‘åå°çº¿ç¨‹æ¨é€ä»»åŠ¡è€Œä¸ä¼šé˜»å¡è°ƒç”¨æ–¹çº¿ç¨‹çš„æ‰§è¡Œï¼ŒåŒæ—¶ä»ç„¶èƒ½å¤Ÿåœ¨éœ€è¦æ—¶è·å–ä»»åŠ¡çš„ç»“æœã€‚</li><li>å…ˆè¯»å‡ºæ‰€æœ‰çš„æ–‡ä»¶åˆ°å†…å­˜ä¸­ï¼Œæ”¾åˆ°ä¸€ä¸ªæ•°ç»„é‡Œï¼Œå†å¼€å¯å¤šè¿›ç¨‹å¯¹è¿™ä¸ªæ•°ç»„çš„ç‚¹äº‘æ•°æ®è¿›è¡Œreduceã€‚åˆ©ç”¨å¤šæ ¸åŠ å¿«åˆå¹¶é€Ÿåº¦ï¼Ÿ</li><li>å…¶å®æˆ‘è§‰å¾—æœ€å¥½çš„æ–¹å¼æ˜¯ï¼Œå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè®¡ç®—ä»»åŠ¡ï¼Œçº¿ç¨‹ç±»ä¸­æœ‰ä¸€ä¸ªæŒ‡ç¤ºè¿›åº¦çš„å˜é‡ã€‚åœ¨ä¸»çº¿ç¨‹ä¸­ä½¿ç”¨ä¸€ä¸ªåç¨‹æ¯éš”Xç§’è·å–ä¸€æ¬¡è¿›åº¦å¹¶å°†å…¶å‘é€ç»™å‰ç«¯ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼æ— æ³•åšåˆ°å®æ—¶ã€‚</li><li>ä»€ä¹ˆæ—¶å€™Pythonå¯ä»¥å»æ‰GILçš„é™åˆ¶ï¼Œè®©è¿™ç§è®¡ç®—å¯†é›†å‹ä»»åŠ¡èƒ½å¤Ÿå……åˆ†åˆ©ç”¨å¤šæ ¸CPUã€‚ã€‚ã€‚ğŸ˜¢</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä»‹ç»&quot;&gt;&lt;/a&gt;ä»‹ç»&lt;/h1&gt;&lt;p&gt;å…ˆä»‹ç»ä¸‹æ•´ä½“ç³»ç»Ÿæ¡†æ¶ï¼Œç³»ç»Ÿåˆ†ä¸ºå‰ç«¯å’Œåç«¯ï¼ŒäºŒè€…é€šè¿‡websocketåè®®è¿›è¡Œé€šä¿¡ã€‚é€šè¿‡è¯·æ±‚æ•°æ®ä¸­çš„codeå­—æ®µæ¥å“åº”ä¸åŒçš„æ“ä½œã€‚&lt;/p&gt;
&lt;</summary>
      
    
    
    
    <category term="Python" scheme="https://guoyujian.github.io/categories/Python/"/>
    
    
    <category term="Python" scheme="https://guoyujian.github.io/tags/Python/"/>
    
    <category term="asyncio" scheme="https://guoyujian.github.io/tags/asyncio/"/>
    
    <category term="websocket" scheme="https://guoyujian.github.io/tags/websocket/"/>
    
  </entry>
  
  <entry>
    <title>Python é¢è¯•é¢˜</title>
    <link href="https://guoyujian.github.io/2023/10/07/Python-%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <id>https://guoyujian.github.io/2023/10/07/Python-%E9%9D%A2%E8%AF%95%E9%A2%98/</id>
    <published>2023-10-07T14:48:30.000Z</published>
    <updated>2023-10-07T14:50:39.894Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è®°ä¸€æ¬¡Pythoné¢è¯•è¢«é—®åˆ°çš„é¢˜</p></blockquote><h1 id="1"><a href="#1" class="headerlink" title="1"></a>1</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a=&#123;<span class="number">1</span>:<span class="number">2</span>,<span class="number">2</span>:<span class="number">3</span>&#125;</span><br><span class="line">b=a</span><br><span class="line">b.pop(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure><p>é—®ï¼šaçš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>ç­”ï¼š<code>&#123;2:3&#125;</code>â€‹</p><h1 id="2"><a href="#2" class="headerlink" title="2"></a>2</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">b=[[]]*<span class="number">2</span>; b[<span class="number">0</span>].append(<span class="number">1</span>); <span class="built_in">print</span>(b)</span><br><span class="line">a=[]; b=[a]*<span class="number">2</span>; b[<span class="number">0</span>].append(<span class="number">1</span>); <span class="built_in">print</span>(b)</span><br><span class="line">a=[]; b=[a, a]; b[<span class="number">0</span>].append(<span class="number">1</span>); <span class="built_in">print</span>(b)</span><br><span class="line">b=[[], []]; b[<span class="number">0</span>].append(<span class="number">1</span>); <span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure><p>é—®ï¼šè¿™å››ä¸ª<code>b</code>â€‹çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>ç­”ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[[1], [1]]</span><br><span class="line">[[1], [1]]</span><br><span class="line">[[1], [1]]</span><br><span class="line">[[1], []]</span><br></pre></td></tr></table></figure><h1 id="3"><a href="#3" class="headerlink" title="3"></a>3</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=&quot;123&quot;; b=a; b=b[:-1]; </span><br><span class="line">print(a, b)</span><br></pre></td></tr></table></figure><p>é—®ï¼šè¾“å‡ºï¼Ÿ</p><p>ç­”ï¼š<code>123 12</code>â€‹</p><h1 id="4"><a href="#4" class="headerlink" title="4"></a>4</h1><p>æ¯”è¾ƒä»¥ä¸‹ä¸¤æ®µä»£ç çš„æ‰§è¡Œæ•ˆç‡å’Œå†…å­˜å¼€é”€</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">resÂ = 1</span><br><span class="line">forÂ numÂ in [1,2,3,4]+[6,7,8,9]:</span><br><span class="line">Â Â Â Â resÂ *=Â num</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">importÂ itertools</span><br><span class="line">resÂ = 1</span><br><span class="line">forÂ numÂ inÂ itertools.chain([1,2,3,4], [6,7,8,9]):</span><br><span class="line">Â Â Â Â resÂ *=Â num</span><br></pre></td></tr></table></figure><p><a href="https://docs.python.org/3/library/itertools.html">https://docs.python.org/3/library/itertools.html</a></p><p>ç­”ï¼šé¦–å…ˆç¬¬ä¸€ä¸ªä»£ç éœ€è¦å°†ä¸¤ä¸ªåˆ—è¡¨å’Œå¹¶ä¸ºä¸€ä¸ªåˆ—è¡¨ï¼Œè€Œç¬¬äºŒæ®µä»£ç æ˜¯ç›´æ¥éå†ä¸¤ä¸ªåˆ—è¡¨ï¼Œå…¶æ¬¡itertools.chainè¿”å›çš„æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªä»£ç çš„æ‰§è¡Œæ•ˆç‡é«˜ï¼Œå†…å­˜å¼€é”€å°ã€‚</p><h1 id="5"><a href="#5" class="headerlink" title="5"></a>5</h1><p>What is the difference between tuple() and list[]ï¼Ÿloop over tuple and listï¼Œwhich one is more effectiveï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if var in [&quot;xxx&quot;, &quot;yyy&quot;]:</span><br><span class="line">if var in (&quot;xxx&quot;, &quot;yyy&quot;):</span><br><span class="line">if var in &#123;&quot;xxx&quot;, &quot;yyy&quot;&#125;:</span><br></pre></td></tr></table></figure><p>Which one above is more efficitive? Note: The value after â€˜inâ€™ is a constant.</p><p>æ—¶é—´å¤æ‚åº¦ï¼štuple O(?) list O(?) set O(?)</p><p>ç­”ï¼štupleæ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œlistæ˜¯å¯å˜å¯¹è±¡ã€‚ç”±äºtupleä¸å¯å˜ï¼Œæ‰€ä»¥ç”³è¯·å†…å­˜ä¸ºè¿ç»­å®šé•¿å†…å­˜ï¼Œè€Œlistç±»ä¼¼äºä¸€ä¸ªé“¾è¡¨ã€‚</p><p>æ‰€ä»¥åœ¨loopä¸­ï¼Œtuple is more effective.</p><p><code>if var in &#123;&quot;xxx&quot;, &quot;yyy&quot;&#125;</code>â€‹ is more effective. å› ä¸ºé›†åˆæŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œtupleå’Œlistä¸ºO(N)</p><h1 id="6"><a href="#6" class="headerlink" title="6"></a>6</h1><p>Python classä¸­å˜é‡åå’Œå‡½æ•°åå‰ç¼€å•ä¸‹åˆ’çº¿å’ŒåŒä¸‹åˆ’çº¿(åç¼€æ²¡æœ‰ä¸‹åˆ’çº¿)åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼ŸFor example,</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class A:</span><br><span class="line">   def _method1(): pass   //Â What&#x27;sÂ theÂ meaningÂ ofÂ _</span><br><span class="line">   def __method2(): pass  //Â What&#x27;sÂ theÂ meaningÂ ofÂ __</span><br></pre></td></tr></table></figure><p> Whatâ€™s the difference among the concepts protected, public, and private?</p><p>ç­”ï¼šå˜é‡å‰æ²¡æœ‰ä¸‹åˆ’çº¿çš„ä¸ºpublic<br>å˜é‡å‰æœ‰å•ä¸‹åˆ’çº¿ä¸ºprotectedï¼Œè¿™ç§å˜é‡åªèƒ½åœ¨æœ¬ç±»æˆ–è€…å…¶å­ç±»ä¸­è°ƒç”¨ï¼ˆå¦‚æœä½ æƒ³åœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯ä¼šæœ‰è­¦å‘Šï¼‰<br>å˜é‡å‰æœ‰åŒä¸‹åˆ’çº¿ä¸ºprivateï¼Œè¿™ç§å˜é‡åªèƒ½åœ¨æœ¬ç±»ä¸­è°ƒç”¨ï¼ˆåœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨ä¼šæŠ¥é”™ï¼‰</p><h1 id="7"><a href="#7" class="headerlink" title="7"></a>7</h1><p>åœ¨ç”¨mongoç­‰éå…³ç³»å‹æ•°æ®åº“çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æŠŠè„æ•°æ®ã€ç©ºæ•°æ®å­˜è¿›æ•°æ®åº“ï¼Œé€ æˆåé¢çš„æ··ä¹±ã€‚å†™ä¸€ä¸ªå‡½æ•°(Python3)ï¼Œåˆ é™¤json dicté‡Œé¢çš„ç©ºæ•°æ®ï¼ŒåŒ…æ‹¬ç©ºdictï¼Œç©ºlistï¼Œç©ºstringï¼ŒNoneã€‚å‡è®¾è¾“å…¥çš„Python dictä»åˆæ³•jsonè¯»å–, å³keyå¿…ä¸ºstring, valueå¯ä»¥æ˜¯number/string/list/dictã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;a&quot;: [1,0,&quot;c&quot;, &#123;&quot;x&quot;:1&#125;]&#125; -&gt; &#123;&quot;a&quot;: [1,0,&quot;c&quot;, &#123;&quot;x&quot;:1&#125;]&#125;</span><br><span class="line">&#123;&quot;a&quot;:[1,None]&#125; -&gt; &#123;&quot;a&quot;: [1]&#125;</span><br><span class="line">&#123;&quot;a&quot;: &#123;&quot;a&quot;:[None, &quot;&quot;, &#123;&#125;,&#123;&quot;x&quot;:None&#125;]&#125;&#125; -&gt; None</span><br></pre></td></tr></table></figure><p>ç­”ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">clean_json</span>(<span class="params">data: (<span class="params"><span class="built_in">dict</span>,<span class="built_in">list</span>,<span class="built_in">int</span>,<span class="built_in">float</span>,<span class="built_in">str</span>,<span class="literal">None</span></span>)</span>):</span><br><span class="line">    <span class="comment"># put your code here</span></span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> data == <span class="string">&#x27;&#x27;</span> <span class="keyword">or</span> data == <span class="built_in">dict</span>() <span class="keyword">or</span> data == []:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(data) == <span class="built_in">list</span>:</span><br><span class="line">        data1 = [item <span class="keyword">for</span> item <span class="keyword">in</span> data <span class="keyword">if</span> clean_json(item) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>] <span class="comment"># å¤åˆ¶ä¸€ä»½å‡ºæ¥</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data1:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> data1</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(data) == <span class="built_in">dict</span>:</span><br><span class="line">        data1 = &#123;k: clean_json(v) <span class="keyword">for</span> k, v <span class="keyword">in</span> data.items() <span class="keyword">if</span> clean_json(v) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>&#125; <span class="comment"># å¤åˆ¶ä¸€ä»½å‡ºæ¥</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data1:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> data1</span><br><span class="line">    <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šä¸èƒ½ç›´æ¥å¯¹åŸæ•°ç»„orå­—å…¸ä½œåˆ é™¤æ“ä½œï¼Œä¼šæŠ¥é”™ï¼</p><p>ä¾‹å¦‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">l = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">    <span class="keyword">if</span> l[i] == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">del</span> l[i] <span class="comment"># do not do this</span></span><br></pre></td></tr></table></figure><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;è®°ä¸€æ¬¡Pythoné¢è¯•è¢«é—®åˆ°çš„é¢˜&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;1&quot;&gt;&lt;a href=&quot;#1&quot; class=&quot;headerlink&quot; title=&quot;1&quot;&gt;&lt;/a&gt;1&lt;/h1&gt;&lt;figure class=&quot;highlight p</summary>
      
    
    
    
    <category term="Python" scheme="https://guoyujian.github.io/categories/Python/"/>
    
    <category term="åŸºç¡€" scheme="https://guoyujian.github.io/categories/Python/%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="Python" scheme="https://guoyujian.github.io/tags/Python/"/>
    
    <category term="é¢è¯•" scheme="https://guoyujian.github.io/tags/%E9%9D%A2%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>Python open3dç‚¹äº‘ç›¸å…³æ“ä½œï¼ˆæŒç»­æ›´æ–°ï¼‰</title>
    <link href="https://guoyujian.github.io/2023/09/16/Python-open3d%E7%82%B9%E4%BA%91%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/"/>
    <id>https://guoyujian.github.io/2023/09/16/Python-open3d%E7%82%B9%E4%BA%91%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/</id>
    <published>2023-09-16T14:26:37.000Z</published>
    <updated>2023-09-16T14:28:04.353Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Prerequisite"><a href="#Prerequisite" class="headerlink" title="Prerequisite"></a>Prerequisite</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">!pip install open3d</span><br><span class="line">!pip install scipy</span><br><span class="line"><span class="keyword">import</span> open3d <span class="keyword">as</span> o3d</span><br><span class="line"><span class="keyword">from</span> scipy.spatial.transform <span class="keyword">import</span> Rotation <span class="keyword">as</span> R</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure><h2 id="è¯»å’Œå†™ç‚¹äº‘æ–‡ä»¶"><a href="#è¯»å’Œå†™ç‚¹äº‘æ–‡ä»¶" class="headerlink" title="è¯»å’Œå†™ç‚¹äº‘æ–‡ä»¶"></a>è¯»å’Œå†™ç‚¹äº‘æ–‡ä»¶</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">point_cloud = o3d.io.read_point_cloud(file_path) <span class="comment"># æ”¯æŒçš„æ ¼å¼pcdã€ptsç­‰</span></span><br><span class="line"><span class="comment"># type(point_cloud) == open3d.cpu.pybind.geometry.PointCloud</span></span><br><span class="line"></span><br><span class="line">o3d.io.write_point_cloud(point_cloud, file_path) </span><br></pre></td></tr></table></figure><h2 id="è¯»å–ç‚¹äº‘å¯¹è±¡ä¸­ç‚¹çš„åæ ‡"><a href="#è¯»å–ç‚¹äº‘å¯¹è±¡ä¸­ç‚¹çš„åæ ‡" class="headerlink" title="è¯»å–ç‚¹äº‘å¯¹è±¡ä¸­ç‚¹çš„åæ ‡"></a>è¯»å–ç‚¹äº‘å¯¹è±¡ä¸­ç‚¹çš„åæ ‡</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">np.asarray(point_cloud.points)</span><br></pre></td></tr></table></figure><h2 id="å°†ç‚¹åæ ‡èµ‹å€¼åˆ°ç‚¹äº‘å¯¹è±¡"><a href="#å°†ç‚¹åæ ‡èµ‹å€¼åˆ°ç‚¹äº‘å¯¹è±¡" class="headerlink" title="å°†ç‚¹åæ ‡èµ‹å€¼åˆ°ç‚¹äº‘å¯¹è±¡"></a>å°†ç‚¹åæ ‡èµ‹å€¼åˆ°ç‚¹äº‘å¯¹è±¡</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># points = np.array([[...]])</span></span><br><span class="line"></span><br><span class="line">point_cloud.points = o3d.utility.Vector3dVector(points)</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºç‚¹äº‘å¯¹è±¡"><a href="#åˆ›å»ºç‚¹äº‘å¯¹è±¡" class="headerlink" title="åˆ›å»ºç‚¹äº‘å¯¹è±¡"></a>åˆ›å»ºç‚¹äº‘å¯¹è±¡</h2><p>åˆ›å»ºä¸€ä¸ªç©ºçš„ç‚¹äº‘å¯¹è±¡</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pc = o3d.geometry.PointCloud()</span><br></pre></td></tr></table></figure><h2 id="åˆå¹¶ç‚¹äº‘å¯¹è±¡"><a href="#åˆå¹¶ç‚¹äº‘å¯¹è±¡" class="headerlink" title="åˆå¹¶ç‚¹äº‘å¯¹è±¡"></a>åˆå¹¶ç‚¹äº‘å¯¹è±¡</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥+</span></span><br><span class="line">pc += point_cloud</span><br></pre></td></tr></table></figure><h2 id="ç‚¹äº‘å¹³ç§»"><a href="#ç‚¹äº‘å¹³ç§»" class="headerlink" title="ç‚¹äº‘å¹³ç§»"></a>ç‚¹äº‘å¹³ç§»</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">point_cloud.translate(translation)  <span class="comment"># åº”ç”¨å¹³ç§»,translation æ˜¯å¹³ç§»å‘é‡</span></span><br></pre></td></tr></table></figure><h2 id="ç‚¹äº‘æ—‹è½¬"><a href="#ç‚¹äº‘æ—‹è½¬" class="headerlink" title="ç‚¹äº‘æ—‹è½¬"></a>ç‚¹äº‘æ—‹è½¬</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">point_cloud.rotate(rotation_matrix, center = (<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))  <span class="comment"># åº”ç”¨æ—‹è½¬, rotation_matrixæ˜¯æ—‹è½¬çŸ©é˜µ</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„ç¬¬äºŒä¸ªå‚æ•°centeræ˜¯æŒ‡å®šæ—‹è½¬ä¸­å¿ƒï¼Œå¦‚æœä¸ä¼ ï¼Œé»˜è®¤æ—‹è½¬ä¸­å¿ƒæ˜¯ç‚¹äº‘çš„è´¨å¿ƒã€‚</p><p>è€Œä¸€èˆ¬æ¥è¯´ï¼Œæ—‹è½¬ä¸­å¿ƒä¸ºåŸç‚¹</p><h2 id="ç‚¹äº‘ä¸Šè‰²"><a href="#ç‚¹äº‘ä¸Šè‰²" class="headerlink" title="ç‚¹äº‘ä¸Šè‰²"></a>ç‚¹äº‘ä¸Šè‰²</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">point_cloud.paint_uniform_color([<span class="number">0</span>, <span class="number">0</span>, <span class="number">1.0</span>]) <span class="comment"># ä¼ å…¥çš„ä¸‰ä¸ªå€¼åˆ†åˆ«æ˜¯rgb</span></span><br></pre></td></tr></table></figure><h2 id="ç‚¹äº‘å±•ç¤º"><a href="#ç‚¹äº‘å±•ç¤º" class="headerlink" title="ç‚¹äº‘å±•ç¤º"></a>ç‚¹äº‘å±•ç¤º</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">o3d.visualization.draw_geometries([point_cloud])</span><br></pre></td></tr></table></figure><h2 id="å››å…ƒæ•°è½¬æ—‹è½¬çŸ©é˜µ"><a href="#å››å…ƒæ•°è½¬æ—‹è½¬çŸ©é˜µ" class="headerlink" title="å››å…ƒæ•°è½¬æ—‹è½¬çŸ©é˜µ"></a>å››å…ƒæ•°è½¬æ—‹è½¬çŸ©é˜µ</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">quaternion = np.array([ori_x, ori_y, ori_z, ori_w])  <span class="comment"># å®šä¹‰å››å…ƒæ•°</span></span><br><span class="line">rotation_matrix = R.from_quat(quaternion).as_matrix()</span><br></pre></td></tr></table></figure><p>æ³¨æ„å››å…ƒæ•°é¡ºåºæ˜¯xyzwï¼Œåœ¨æœ‰äº›åœ°æ–¹é¡ºåºæ˜¯wxyz</p><h2 id="ç‚¹äº‘ä¸‹é‡‡æ ·"><a href="#ç‚¹äº‘ä¸‹é‡‡æ ·" class="headerlink" title="ç‚¹äº‘ä¸‹é‡‡æ ·"></a>ç‚¹äº‘ä¸‹é‡‡æ ·</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">point_cloud = point_cloud.voxel_down_sample()</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„</p><ol><li>éœ€è¦æ¥æ”¶è¿”å›å€¼</li><li>ä¸‹é‡‡æ ·æ˜¯æŒ‡åªä¿ç•™æŸä¸€å¤§å°ç«‹æ–¹ä½“å†…çš„ä¸€ä¸ªç‚¹ã€‚voxel_down_sampleæ–¹æ³•æœ‰ä¸ªé»˜è®¤å€¼å‚æ•°ï¼Œä¸º0.05ã€‚è¿™ä¸ªå‚æ•°å°±è¡¨ç¤ºç«‹æ–¹ä½“çš„å¤§å°ï¼Œå› æ­¤è¿™ä¸ªæ•°è¶Šå¤§ï¼Œä¸‹é‡‡æ ·çš„å¼ºåº¦è¶Šå¼ºï¼Œä¿ç•™çš„ç‚¹å°±è¶Šå°‘ã€‚</li></ol><h2 id="ç»Ÿè®¡æ»¤æ³¢"><a href="#ç»Ÿè®¡æ»¤æ³¢" class="headerlink" title="ç»Ÿè®¡æ»¤æ³¢"></a>ç»Ÿè®¡æ»¤æ³¢</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">point_cloud.remove_statistical_outlier(nb_neighbors=<span class="number">20</span>, std_ratio=<span class="number">2.0</span>)</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•å¯ä»¥å»æ‰è·ç¦»ç‚¹äº‘å¯†é›†å¤„å¾ˆè¿œçš„ç‚¹ã€‚è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°</p><ol><li>nb_neighborså…è®¸æŒ‡å®šè¦è€ƒè™‘å¤šå°‘ä¸ªé‚»å±…ï¼Œä»¥ä¾¿è®¡ç®—ç»™å®šç‚¹çš„å¹³å‡è·ç¦»ã€‚</li><li>std_ratioå…è®¸åŸºäºè·¨ç‚¹äº‘çš„å¹³å‡è·ç¦»çš„æ ‡å‡†åå·®æ¥è®¾ç½®é˜ˆå€¼çº§åˆ«ã€‚æ­¤æ•°å­—è¶Šä½ï¼Œè¿‡æ»¤å™¨å°†è¶Šå…·æœ‰æ”»å‡»æ€§ã€‚</li></ol><h2 id="ç­›é€‰ç‚¹äº‘ä¸­çš„ç‚¹"><a href="#ç­›é€‰ç‚¹äº‘ä¸­çš„ç‚¹" class="headerlink" title="ç­›é€‰ç‚¹äº‘ä¸­çš„ç‚¹"></a>ç­›é€‰ç‚¹äº‘ä¸­çš„ç‚¹</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># indices_to_keep =[0,1,2...] ç‚¹çš„ç´¢å¼•</span></span><br><span class="line">point_cloud = point_cloud.select_by_index(indices_to_keep)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Prerequisite&quot;&gt;&lt;a href=&quot;#Prerequisite&quot; class=&quot;headerlink&quot; title=&quot;Prerequisite&quot;&gt;&lt;/a&gt;Prerequisite&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Python numpyå¯¹ä¸‰ç»´ç‚¹çš„æ“ä½œæ±‡æ€»ï¼ˆæŒç»­æ›´æ–°ï¼‰</title>
    <link href="https://guoyujian.github.io/2023/09/16/Python-numpy%E5%AF%B9%E4%B8%89%E7%BB%B4%E7%82%B9%E7%9A%84%E6%93%8D%E4%BD%9C%E6%B1%87%E6%80%BB%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/"/>
    <id>https://guoyujian.github.io/2023/09/16/Python-numpy%E5%AF%B9%E4%B8%89%E7%BB%B4%E7%82%B9%E7%9A%84%E6%93%8D%E4%BD%9C%E6%B1%87%E6%80%BB%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/</id>
    <published>2023-09-16T14:04:30.000Z</published>
    <updated>2023-09-16T14:05:50.824Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Prerequisite"><a href="#Prerequisite" class="headerlink" title="Prerequisite"></a>Prerequisite</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure><h2 id="å°†ä¸€ä¸ªåˆ—è¡¨ä¸­çš„ç‚¹æˆ–è€…å…¶ä»–å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªnumpy-ndarrayå¯¹è±¡"><a href="#å°†ä¸€ä¸ªåˆ—è¡¨ä¸­çš„ç‚¹æˆ–è€…å…¶ä»–å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªnumpy-ndarrayå¯¹è±¡" class="headerlink" title="å°†ä¸€ä¸ªåˆ—è¡¨ä¸­çš„ç‚¹æˆ–è€…å…¶ä»–å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªnumpy.ndarrayå¯¹è±¡"></a>å°†ä¸€ä¸ªåˆ—è¡¨ä¸­çš„ç‚¹æˆ–è€…å…¶ä»–å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªnumpy.ndarrayå¯¹è±¡</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">points = np.asarray([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],[<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>]])</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹numpy-ndarrayçš„å½¢çŠ¶"><a href="#æŸ¥çœ‹numpy-ndarrayçš„å½¢çŠ¶" class="headerlink" title="æŸ¥çœ‹numpy.ndarrayçš„å½¢çŠ¶"></a>æŸ¥çœ‹numpy.ndarrayçš„å½¢çŠ¶</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">##  n : numpy.ndarray </span></span><br><span class="line">n.shape </span><br></pre></td></tr></table></figure><h2 id="è®¡ç®—ç‚¹åˆ°åŸç‚¹çš„æ¬§å‡ é‡Œå¾—è·ç¦»"><a href="#è®¡ç®—ç‚¹åˆ°åŸç‚¹çš„æ¬§å‡ é‡Œå¾—è·ç¦»" class="headerlink" title="è®¡ç®—ç‚¹åˆ°åŸç‚¹çš„æ¬§å‡ é‡Œå¾—è·ç¦»"></a>è®¡ç®—ç‚¹åˆ°åŸç‚¹çš„æ¬§å‡ é‡Œå¾—è·ç¦»</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># points like array([[x1,y1,z1],[x2,y2,z2],[x3,y3,z3]])</span></span><br><span class="line">distances = np.linalg.norm(points, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><code>np.linalg.norm(x, ord=None, axis=None, keepdims=False)</code>â€‹æ±‚èŒƒæ•°</p><p>xï¼šæ˜¯è¾“å…¥çš„çŸ©é˜µorå‘é‡</p><p>ordï¼šè®¡ç®—çš„èŒƒæ•°ç±»å‹ã€‚ord=2è®¡ç®—L2èŒƒæ•°ï¼Œå³æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œord=1è®¡ç®—L1èŒƒæ•°ã€‚</p><p>axisï¼šè½´ï¼Œaxis=0æŒ‰åˆ—è®¡ç®—ï¼Œaxis=1æŒ‰è¡Œè®¡ç®—</p><h2 id="é€‰æ‹©æ¬§å‡ é‡Œå¾—è·ç¦»ç¬¦åˆä¸€å®šèŒƒå›´å†…çš„ç‚¹"><a href="#é€‰æ‹©æ¬§å‡ é‡Œå¾—è·ç¦»ç¬¦åˆä¸€å®šèŒƒå›´å†…çš„ç‚¹" class="headerlink" title="é€‰æ‹©æ¬§å‡ é‡Œå¾—è·ç¦»ç¬¦åˆä¸€å®šèŒƒå›´å†…çš„ç‚¹"></a>é€‰æ‹©æ¬§å‡ é‡Œå¾—è·ç¦»ç¬¦åˆä¸€å®šèŒƒå›´å†…çš„ç‚¹</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·å¾—ç‚¹è·ç¦»åŸç‚¹çš„æ¬§å‡ é‡Œå¾—è·ç¦»å¤§äº0.1å°äº70çš„ç‚¹ç´¢å¼•</span></span><br><span class="line">np.where((distances &gt;= <span class="number">0.01</span>) &amp; (distances &lt;= <span class="number">70</span>))[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç­›é€‰è¿™äº›ç‚¹</span></span><br><span class="line">points[np.where((distances &gt;= <span class="number">0.01</span>) &amp; (distances &lt;= <span class="number">70</span>))]</span><br></pre></td></tr></table></figure><p><a href="https://www.delftstack.com/zh/howto/numpy/python-numpy.where-multiple-conditions/#%e5%9c%a8-python-%e4%b8%ad%e4%bd%bf%e7%94%a8-numpylogical_or-%e5%87%bd%e6%95%b0%e5%ae%9e%e7%8e%b0-numpywhere-%e5%a4%9a%e4%b8%aa%e6%9d%a1%e4%bb%b6">https://www.delftstack.com/zh/howto/numpy/python-numpy.where-multiple-conditions/#%e5%9c%a8-python-%e4%b8%ad%e4%bd%bf%e7%94%a8-numpylogical_or-%e5%87%bd%e6%95%b0%e5%ae%9e%e7%8e%b0-numpywhere-%e5%a4%9a%e4%b8%aa%e6%9d%a1%e4%bb%b6</a></p><h2 id="å¯¹ç‚¹è¿›è¡Œæ—‹è½¬"><a href="#å¯¹ç‚¹è¿›è¡Œæ—‹è½¬" class="headerlink" title="å¯¹ç‚¹è¿›è¡Œæ—‹è½¬"></a>å¯¹ç‚¹è¿›è¡Œæ—‹è½¬</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç»™å®šä¸€ä¸ª3*3çš„æ—‹è½¬çŸ©é˜µ rotation_matrixï¼Œ å¯¹ç‚¹pointsè¿›è¡Œæ—‹è½¬ï¼Œè·å¾—æ—‹è½¬åçš„ç‚¹åæ ‡ã€‚</span></span><br><span class="line">np.dot(points, rotation_matrix.T)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œéœ€è¦å¯¹æ—‹è½¬çŸ©é˜µåšäº†è½¬ç½®ï¼Œ<strong><em>æ¨å¯¼ä¸€ä¸‹</em></strong>â€‹<strong>ã€‚</strong></p><p>np.dotçŸ©é˜µä¹˜æ³•ï¼Œä»–çš„ç”¨æ³•æ˜¯ï¼Ÿå’Œnp.<code>matmul</code>â€‹çš„åŒºåˆ«ï¼Ÿ</p><h2 id="å¯¹ç‚¹è¿›è¡Œå¹³ç§»"><a href="#å¯¹ç‚¹è¿›è¡Œå¹³ç§»" class="headerlink" title="å¯¹ç‚¹è¿›è¡Œå¹³ç§»"></a>å¯¹ç‚¹è¿›è¡Œå¹³ç§»</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç»™å®šä¸€ä¸ªå¹³ç§»å‘é‡translation_vectorï¼Œ å¯¹ç‚¹pointsè¿›è¡Œå¹³ç§»ï¼Œè·å¾—æ—‹è½¬åçš„ç‚¹åæ ‡ã€‚</span></span><br><span class="line">points + translation_vector</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Prerequisite&quot;&gt;&lt;a href=&quot;#Prerequisite&quot; class=&quot;headerlink&quot; title=&quot;Prerequisite&quot;&gt;&lt;/a&gt;Prerequisite&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;</summary>
      
    
    
    
    <category term="Python" scheme="https://guoyujian.github.io/categories/Python/"/>
    
    
    <category term="Python" scheme="https://guoyujian.github.io/tags/Python/"/>
    
    <category term="numpy" scheme="https://guoyujian.github.io/tags/numpy/"/>
    
  </entry>
  
  <entry>
    <title>ä½ çš„é¡¹ç›®ä¸­æœ‰ä»€ä¹ˆäº®ç‚¹ï¼Ÿå¦‚ä½•å›ç­”æ‰èƒ½å¾—åˆ°é¢è¯•å®˜çš„å¥½æ„Ÿ</title>
    <link href="https://guoyujian.github.io/2023/09/04/%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9C%89%E4%BB%80%E4%B9%88%E4%BA%AE%E7%82%B9%EF%BC%9F%E5%A6%82%E4%BD%95%E5%9B%9E%E7%AD%94%E6%89%8D%E8%83%BD%E5%BE%97%E5%88%B0%E9%9D%A2%E8%AF%95%E5%AE%98%E7%9A%84%E5%A5%BD%E6%84%9F/"/>
    <id>https://guoyujian.github.io/2023/09/04/%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9C%89%E4%BB%80%E4%B9%88%E4%BA%AE%E7%82%B9%EF%BC%9F%E5%A6%82%E4%BD%95%E5%9B%9E%E7%AD%94%E6%89%8D%E8%83%BD%E5%BE%97%E5%88%B0%E9%9D%A2%E8%AF%95%E5%AE%98%E7%9A%84%E5%A5%BD%E6%84%9F/</id>
    <published>2023-09-04T15:17:53.000Z</published>
    <updated>2023-09-04T15:22:09.604Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>é’ˆå¯¹æœ¬<a href="https://www.bilibili.com/video/BV1DM4y1L7cL/?buvid=9aa5bffff7ad0aee7573c7ed265b7b41&amp;is_story_h5=false&amp;mid=KneIq6dZPkIx5y%2FvWilBwA%3D%3D&amp;p=1&amp;plat_id=116&amp;share_from=ugc&amp;share_medium=iphone&amp;share_plat=ios&amp;share_session_id=B0B2A8E9-DA79-44E5-ADF6-4ECC9B19D812&amp;share_source=WEIXIN&amp;share_tag=s_i&amp;timestamp=1693623913&amp;unique_k=A5vAgCl&amp;up_id=1031543543&amp;vd_source=53d8e50bea64fe70bc50c86af86d28e1">è§†é¢‘</a>åšçš„ç¬”è®°</p></blockquote><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>è¯·ä½ è¯´ä¸€ä¸‹ä½ é¡¹ç›®ä¸­çš„äº®ç‚¹ã€‚å‡ ä¹æ¯ä¸ªå‡†å¤‡å»é¢è¯•çš„åŒå­¦éƒ½ä¼šè¢«è¿™ä¸ªé—®é¢˜å›°æ‰°ï¼Œæˆ‘ç¾¡æ…•ã€‚</p><p>å¾ˆç®€å•ï¼Œå°±æ˜¯ CRUD æ²¡æœ‰äº®ç‚¹æ€ä¹ˆåŠï¼Ÿæ²¡æœ‰åšè¿‡åˆ†å¸ƒå¼çš„é¡¹ç›®ï¼Œå“ªæœ‰ä»€ä¹ˆäº®ç‚¹ï¼Œæˆ‘ä¹‹å‰åšçš„éƒ½æ˜¯å•ä½“é¡¹ç›®ï¼Œå®åœ¨æƒ³ä¸å‡ºæœ‰ä»€ä¹ˆäº®ç‚¹ï¼Œå¤§å®¶å¯¹äºè¿™ä¸ªé—®é¢˜çš„<strong>è¯¯è§£</strong>åœ¨äºï¼Œä¸€å®šè¦é¡¹ç›®è¶³å¤Ÿå¥½æ‰æœ‰äº®ç‚¹ã€‚å…¶å®é¢è¯•å®˜åœ¨é—®è¿™ä¸ªé—®é¢˜çš„æ—¶å€™æ˜¯æƒ³äº†è§£ä½ åœ¨é¡¹ç›®ä¸­çš„æˆæœå’Œèƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥ä»å‡ ä¸ªç»´åº¦å»å‡†å¤‡ã€‚</p><ol><li>è§£å†³å¤æ‚é—®é¢˜çš„èƒ½åŠ›ã€‚ä½ å¯ä»¥æè¿°ä½ åœ¨é¡¹ç›®ä¸­è§£å†³è¿‡å“ªä¸€äº›ç‰¹åˆ«å¤æ‚æˆ–è€…æœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ï¼Œå¯ä»¥æ˜¯æŠ€æœ¯é—®é¢˜ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸šåŠ¡é—®é¢˜ã€‚æ¯”å¦‚è¯´é€šè¿‡å¼•å…¥ Kafka è¿™ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¼˜åŒ–äº†ç¨‹åºçš„æ•ˆç‡ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿåœ¨é«˜å³°æœŸå¤„ç†ç™¾ä¸‡çº§çš„æ¶ˆæ¯ã€‚</li><li>åšäº†ä¸€äº›æé«˜æ•ˆç‡çš„å·¥ä½œï¼Œæ¯”å¦‚è¯´é‡æ„ä»£ç ï¼Œä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ•ˆç‡ã€‚å¼•å…¥å¼‚æ­¥çº¿ç¨‹ï¼Œä¼˜åŒ–äº†ä»£ç çš„æ•ˆç‡ã€‚å¼€å‘äº†ä¸€ä¸ªå…¬å…±ç»„ä»¶ï¼Œæå‡äº†å›¢é˜Ÿçš„å¼€å‘æ•ˆç‡ã€‚æ¯”å¦‚ä¼˜åŒ–äº†ä¸€ä¸ªå¤æ‚çš„ MySQL è¯­å¥ï¼Œæé«˜äº†æ•°æ®åº“çš„æŸ¥è¯¢æ•ˆç‡ï¼Œä½¿å¾—æŸ¥è¯¢æ•ˆç‡æ•´ä½“æå‡äº† 10 å€ã€‚</li><li>çªå‡ºå›¢é˜Ÿåä½œå’Œæ²Ÿé€šæ–¹é¢çš„èƒ½åŠ›ã€‚æ¯”å¦‚è¯´åœ¨é¡¹ç›®ä¸­æ‰¿æ‹…çš„æ ¸å¿ƒå¼€å‘æˆ–è€…å›¢é˜Ÿå°ç»„é•¿çš„è§’è‰²ï¼Œé€šè¿‡ä¸€ç³»åˆ—çš„ç®¡ç†æ‰‹æ®µï¼ŒæŒ‰æ—¶å®Œæˆäº†é¡¹ç›®äº¤ä»˜å’Œæé«˜äº†è´¨é‡ä¿éšœç­‰ç­‰ã€‚æ¯”å¦‚æˆ‘å¸¦é¢†æˆ‘çš„å›¢é˜Ÿå®Œæˆäº†è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘è´Ÿè´£åˆ†é…ä»»åŠ¡ï¼Œåè°ƒå›¢é˜Ÿçš„æˆå‘˜å·¥ä½œä»¥åŠè§£å†³å›¢é˜Ÿä¸­å‡ºç°çš„é—®é¢˜ã€‚åœ¨æˆ‘çš„ç®¡ç†ä¸‹ï¼Œæˆ‘ä»¬æˆåŠŸçš„æŒ‰æ—¶å®Œæˆäº†é¡¹ç›®ï¼Œå¾—åˆ°äº†å®¢æˆ·çš„é«˜åº¦è¯„ä»·ã€‚</li><li>æœ€åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çªå‡ºå­¦ä¹ èƒ½åŠ›ï¼Œæ¯”å¦‚é¡¹ç›®é‡Œé¢è¦ç”¨åˆ°ä¸€ä¸ªæ–°çš„æŠ€æœ¯ï¼Œè¿™ä¸ªæŠ€æœ¯ä¹‹å‰æ²¡æœ‰ç”¨è¿‡ï¼Œä½†æ˜¯é¡¹ç›®äº¤ä»˜çš„æ—¶é—´æ¯”è¾ƒç´§ï¼Œæ‰€ä»¥æˆ‘å¤§æ¦‚èŠ±äº† 3 å¤©æ—¶é—´åœ¨ç½‘ä¸Šæ‰¾äº†å„ç§èµ„æ–™å­¦ä¹ ï¼Œåœ¨å®é™…è½åœ°çš„æ—¶å€™è¿˜é‡åˆ°äº†ä¸€äº›è‡ªå·±è§£å†³ä¸äº†çš„é—®é¢˜ï¼Œåé¢åœ¨ GitHub çš„ issue ä¸Šæ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œæœ€åæŒ‰æœŸå®Œæˆäº†é¡¹ç›®çš„äº¤ä»˜ã€‚</li></ol><p>å› æ­¤ï¼Œå¯¹äºé¡¹ç›®ä¸­çš„äº®ç‚¹ï¼Œä½ ä»¬å¯ä»¥ä»å¯¹ä¸šåŠ¡è®¾è®¡çš„æ·±åº¦æ€è€ƒï¼Œé—®é¢˜è§£å†³çš„èƒ½åŠ›ï¼Œæˆ–è€…å¯¹æŸä¸ªç‰¹å®šæŠ€æœ¯çš„æ·±åº¦ç†è§£ï¼Œå›¢é˜Ÿåä½œæ²Ÿé€šç­‰æ–¹é¢å»å‡†å¤‡ï¼Œä»è€Œè®©é¢è¯•å®˜çœ‹åˆ°ä½ åœ¨é¡¹ç›®ä¸­çš„æ€è€ƒå’Œæ€»ç»“ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåªä¼š CRUDçš„å·¥å…·äººã€‚ä»¥ä¸Šå°±æ˜¯æˆ‘çš„ç†è§£ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;é’ˆå¯¹æœ¬&lt;a href=&quot;https://www.bilibili.com/video/BV1DM4y1L7cL/?buvid=9aa5bffff7ad0aee7573c7ed265b7b41&amp;amp;is_story_h5=false&amp;amp;mi</summary>
      
    
    
    
    
    <category term="é¢è¯•æŠ€å·§" scheme="https://guoyujian.github.io/tags/%E9%9D%A2%E8%AF%95%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>Python asyncioå¼‚æ­¥ç¼–ç¨‹å…¥é—¨</title>
    <link href="https://guoyujian.github.io/2023/09/03/Python-asyncio%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8/"/>
    <id>https://guoyujian.github.io/2023/09/03/Python-asyncio%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8/</id>
    <published>2023-09-03T09:36:21.000Z</published>
    <updated>2023-09-03T09:40:56.212Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>é’ˆå¯¹<a href="https://www.bilibili.com/video/BV1oa411b7c9/?spm_id_from=333.337.search-card.all.click&amp;vd_source=53d8e50bea64fe70bc50c86af86d28e1">è¯¥è§†é¢‘</a>çš„ä¸€ç¯‡ç¬”è®°</p><p>å…ˆå†³æ¡ä»¶ï¼šåç¨‹ã€å¹¶å‘</p></blockquote><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>è¿™æ¬¡è®²çš„æ˜¯asyncioæœ€æ–°çš„ç”¨æ³•ï¼Œç„¶åæ˜¯Python 3. 7 ä»¥ä¸Šæ‰æ”¯æŒçš„ï¼Œä¹Ÿæ˜¯æ¨èå¤§å®¶å­¦æ–°ä¸å­¦æ—§ã€‚</p><p>asyncioå¹¶ä¸èƒ½æå‡ä½ çš„è¿ç®—é€Ÿåº¦ï¼Œå®ƒæ¯”è¾ƒé€‚åˆå¤„ç†é‚£äº›éœ€è¦ç­‰å¾…çš„ä»»åŠ¡^ï¼ˆåº”ç”¨åœºæ™¯ï¼‰^ï¼Œæœ€å…¸å‹çš„å°±æ˜¯ç½‘ç»œçš„é€šè®¯</p><p>é‚£ asyncioçš„<strong>è¿ç®—æ ¸å¿ƒ</strong>å…¶å®å°±æ˜¯ä¸€ä¸ªevent loopï¼Œå®ƒå°±åƒä¸€ä¸ªå¤§è„‘ï¼Œå®ƒé¢å¯¹ç€å¾ˆå¤šå¯ä»¥æ‰§è¡Œçš„ä»»åŠ¡ï¼Œç„¶åå†³å®šæ‰§è¡Œå“ªä¸ªä»»åŠ¡ã€‚é‚£åœ¨ Python çš„asyncioé‡Œï¼ŒåŒæ—¶æ‰§è¡Œçš„ä»»åŠ¡åªèƒ½æœ‰ä¸€ä¸ªï¼Œå®ƒä¸å­˜åœ¨ç³»ç»Ÿçº§çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå®ƒè·Ÿçº¿ç¨‹ä¸ä¸€æ ·ï¼Œå®ƒéœ€è¦æ¯ä¸€ä¸ªä»»åŠ¡ä¸»åŠ¨å‘Šè¯‰event loopï¼Œæˆ‘è¿™è¾¹ç»“æŸäº†ï¼Œä½ å¯ä»¥è®©åˆ«çš„ä»»åŠ¡å¼€å§‹äº†ã€‚å› æ­¤å®ƒæœ‰ä¸€ä¸ª<strong>å¥½å¤„</strong>ï¼Œå°±æ˜¯ä¸å­˜åœ¨ç«äº‰å†’é™©è¿™æ ·çš„é—®é¢˜ï¼Œä½ å¯ä»¥æ˜ç¡®çš„çŸ¥é“æˆ‘æ¯ä¸€ä¸ªä»»åŠ¡ä»€ä¹ˆæ—¶å€™åœæ­¢è¿ç®—äº†ã€‚</p><p>é‚£æƒ³è¦ä½¿ç”¨asyncioç¬¬ä¸€ä»¶äº‹å°±æ˜¯ç†è§£ä»€ä¹ˆå«coroutineï¼Œä»€ä¹ˆå«taskã€‚</p><p>coroutineåœ¨ Python çš„è¯­å¢ƒé‡Œï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæŒ‡ä¸¤ç§ä¸œè¥¿ï¼Œä¸€ä¸ªæ˜¯coroutine functionï¼Œä¸€ä¸ªæ˜¯coroutine objectã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>( <span class="string">&#x27;world&#x27;</span>)</span><br><span class="line"></span><br><span class="line">coro = main()</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª async def main å°±æ˜¯ä¸€ä¸ªcoroutine functionã€‚Python é‡Œé¢æ‰€æœ‰async def mainå¼€å¤´çš„ä¸œè¥¿éƒ½å«coroutine functionï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ª coroutine çš„è¿‡ç¨‹ã€‚é‚£ Python ä¸€èˆ¬çš„å‡½æ•°ï¼Œå½“æˆ‘ä»¬è°ƒç”¨å®ƒçš„æ—¶å€™ï¼Œå®ƒè¿”å›çš„æ˜¯è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼ï¼Œå¯¹ä¸å¯¹ï¼Ÿä½†æ˜¯æ‰€æœ‰çš„ coroutine functionï¼Œå½“ä½ è°ƒç”¨çš„æ—¶å€™ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªcoroutine objectï¼Œå®ƒçš„æœ¬è´¨è·Ÿç”Ÿæˆå™¨å‡½æ•°æœ‰äº›åƒã€‚</p><p>å°±æ˜¯å½“ä½ åœ¨è°ƒç”¨mainçš„æ—¶å€™ï¼Œå®ƒå¹¶ä¸ä¼šè¿è¡Œ main é‡Œé¢çš„ç¨‹åºï¼Œå®ƒåªä¼šè¿”å›ä¸€ä¸ªcoroutine objectã€‚</p><p>å¥½ï¼Œé‚£æ€ä¹ˆè¿è¡Œcoroutineçš„ä»£ç ï¼Ÿæˆ‘ä»¬éœ€è¦<strong>ä¸¤ä»¶äº‹</strong>ï¼Œç¬¬ä¸€æ˜¯è¿›å…¥asyncçš„æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯è¿›å…¥è¿™ä¸ª event loopï¼Œå¼€å§‹æ§åˆ¶æ•´ä¸ªç¨‹åºçš„çŠ¶æ€ã€‚ç¬¬äºŒå°±æ˜¯æŠŠcoroutineå˜æˆtaskã€‚</p><p>æˆ‘ä»¬å…ˆè¯´å¦‚ä½•è¿›å…¥ async æ¨¡å¼ï¼Œé‚£æˆ‘ä»¬æ­£å¸¸å†™Pythonä»£ç è¿è¡Œçš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬ç®¡å®ƒå« synchronized æ¨¡å¼çš„è¯ï¼Œé‚£ä¹ˆåœ¨ synchronize æ¨¡å¼ä¸‹åˆ‡æ¢åˆ° asynchronized æ¨¡å¼ï¼Œåˆ‡æ¢åˆ°è®©è¿™ä¸ª event loop å¼€å§‹æ§åˆ¶ä¸€åˆ‡ã€‚åŸºæœ¬ä¸Šæˆ‘ä»¬åªç”¨ä¸€ä¸ªå…¥å£å‡½æ•°å«åšasyncio.runï¼Œé‚£ asyncio.runï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªcoroutineï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹å„¿ï¼Œç¬¬ä¸€å®ƒä¼šå»ºç«‹èµ·è¿™ä¸ª event loopï¼Œç¬¬äºŒå®ƒä¼šæŠŠè¿™ä¸ª coroutine å˜æˆè¿™ä¸ª event loop é‡Œé¢çš„ä¸€ä¸ªtaskï¼Œé‚£ event loop å»ºç«‹ä¹‹åï¼Œä»–å°±ä¼šå»æ‰¾å“ªä¸ª task å¯ä»¥æ‰§è¡Œï¼Œé‚£å½“ç„¶åªæœ‰ä¸€ä¸ªtaskï¼Œæ‰€ä»¥å®ƒå°±ä¼šå¼€å§‹è¿è¡Œ run ç»™è¿›æ¥çš„è¿™ä¸ªcoroutineã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>( <span class="string">&#x27;world&#x27;</span>)</span><br><span class="line"></span><br><span class="line">asyncio.run(main())</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¯•ä¸€ä¸‹ï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°å®ƒå…ˆ print äº†helloï¼Œç„¶åç­‰äº† 1 ç§’é’Ÿï¼Œç„¶å print äº†worldï¼Œé‚£è¿™ä¸ªasyncio.runå°±æ˜¯æˆ‘ä»¬ä» synchronize æ¨¡å¼å˜åˆ° asynchronize æ¨¡å¼çš„å…¥å£ï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªcoroutineã€‚</p><p>é‚£åªæœ‰ä¸€ä¸ª task æ˜¯æ²¡æœ‰ä»€ä¹ˆæ„æ€çš„ï¼Œå¯¹ä¸å¯¹ï¼Ÿæˆ‘ä»¬åˆšæ‰ä¹Ÿè¯´è¿‡ï¼Œ event loop çš„æ ¸å¿ƒæ˜¯å®ƒæœ‰å¾ˆå¤šå¾ˆå¤šä¸ªtaskï¼Œç„¶åå®ƒæ¥å†³å®šå“ªä¸ª task è¦è¿è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬å¾ˆé‡è¦çš„ä¸€ä»¶äº‹æƒ…æ˜¯ï¼Œå½“æˆ‘ä»¬å·²ç»å¤„äº async æ¨¡å¼ä¸‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¦‚ä½•å¢åŠ taskï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬å°±ä»‹ç»å‡ ä¸ªæŠŠcoroutineå˜æˆtaskï¼Œè®©å®ƒå¯ä»¥æ’é˜Ÿæ‰§è¡Œçš„æ–¹æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">say_after</span>(<span class="params">delay, what</span>):</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(delay)</span><br><span class="line">    <span class="built_in">print</span>(what)</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;started at <span class="subst">&#123;time.strftime(<span class="string">&#x27;%x&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> say_after(<span class="number">1</span>, <span class="string">&quot;hello&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> say_after(<span class="number">2</span>,<span class="string">&quot;world&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;finished at <span class="subst">&#123;time.strftime(<span class="string">&#x27;%x&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">asyncio.run(main())</span><br></pre></td></tr></table></figure><p>å¤§å®¶çœ‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª say_after å‡½æ•°ï¼Œå®ƒæ˜¾ç„¶æ˜¯ä¸€ä¸ªcoroutineï¼Œå¯¹ä¸å¯¹ï¼Ÿå®ƒå‰é¢æ˜¯async defï¼Œé‚£å®é™…ä¸Šasyncio.sleepï¼Œå®ƒè¿”å›çš„ä¸œè¥¿ä¹Ÿæ˜¯ä¸€ä¸ª core routineï¼Œé‚£è¿™é‡Œå°±æ¶‰åŠåˆ°äº†<strong>ç¬¬ä¸€ä¸ªæŠŠcoroutineå˜æˆ task çš„æ–¹æ³•</strong>ï¼Œå°±æ˜¯ç”¨awaitã€‚</p><p>é‚£ä¹ˆå½“ä½  await ä¸€ä¸ª<strong>coroutine</strong>çš„æ—¶å€™ï¼ˆä¸Šè¿°ä»£ç ç¬¬8è¡Œï¼‰ï¼Œå‘ç”Ÿäº†å¦‚ä¸‹å‡ ä»¶äº‹ï¼Œç¬¬ä¸€ï¼Œè¿™ä¸ªcoroutineè¢«åŒ…è£…æˆä¸€ä¸ªtaskï¼Œå¹¶ä¸”è¢«å‘Šè¯‰äº† event loopï¼Œè¯´è¿™å—å„¿æœ‰ä¸€ä¸ªæ–°çš„taskã€‚ç¬¬äºŒï¼Œå®ƒä¼šå‘Šè¯‰ event loopï¼Œæˆ‘ç°åœ¨è¿™ä¸ª task ï¼ˆmainï¼‰éœ€è¦ç­‰åˆ°say_after task å®Œæˆä¹‹åï¼Œæˆ‘æ‰èƒ½ç»§ç»­å®ƒï¼Œå»ºç«‹äº†è¿™ä¹ˆä¸€ä¸ªä¾èµ–å…³ç³»ã€‚ç¬¬ä¸‰ï¼Œå®ƒä¼š yield å‡ºå»ï¼Œä¹Ÿå°±æ˜¯å®ƒä¼šå‘Šè¯‰ event loopï¼Œæˆ‘è¿™ä¸ª task ç°åœ¨å¹²ä¸äº†äº†ï¼Œä½ å…ˆè®©åˆ«çš„ task å¹²æ´»å»å§ã€‚æœ€åå½“ event loop å†æ¬¡å®‰æ’å®ƒè¿è¡Œçš„æ—¶å€™ï¼Œå®ƒä¼šæŠŠ say after è¿™ä¸ªsay_after é‡Œé¢çœŸæ­£çš„è¿”å›å€¼æ‹¿å‡ºæ¥ä¿å­˜èµ·æ¥ã€‚å½“ç„¶ç°åœ¨æˆ‘ä»¬è¿™é‡Œawaitå‰é¢æ²¡æœ‰å†™ï¼Œå› ä¸ºæˆ‘ä»¬çš„ say after æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼Œå¥½ï¼Œé‚£æˆ‘ä»¬è¿è¡Œä¸€ä¸‹è¿™æ®µç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å·®ä¸å¤šé—´éš”ä¸€ç§’ print ä¸€ä¸ªhelloï¼Œç„¶ååœ¨ä¸¤ç§’é’Ÿä¹‹å print äº†ä¸€ä¸ªworldã€‚</p><p>æˆ‘ä»¬æ¥è¿˜åŸä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹å‘ç”Ÿäº†ä¸€ä¸ªä»€ä¹ˆäº‹æƒ…ã€‚é¦–å…ˆ asyncio.runæŠŠè¿™ä¸ªmainä½œä¸ºä¸€ä¸ª task ç»™æ”¾åˆ°äº† event loop é‡Œã€‚ event loop å¯»æ‰¾taskï¼Œä»–å‘ç°åªæœ‰ä¸€ä¸ª task mainï¼Œç„¶åä»–å°±å¼€å§‹è®©è¿™ä¸ª task mainè¿è¡Œã€‚may ä½ åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œé¦–å…ˆ print äº†ä¸€ä¸ª start atï¼Œç„¶åå®ƒè¿è¡Œäº† say_after è¿™ä¸ªcoroutine functionï¼Œå¾—åˆ°äº†ä¸€ä¸ªcoroutine objectã€‚await æŠŠè¿™ä¸ªcoroutine objectå˜æˆäº†ä¸€ä¸ªtaskï¼Œæ”¾å›äº† event loop é‡Œï¼ŒåŒæ—¶å‘Šè¯‰ event loop æˆ‘éœ€è¦ç­‰å¾…å®ƒï¼Œç„¶åæŠŠæ§åˆ¶æƒäº¤è¿˜ç»™äº† event loopã€‚</p><p>ç°åœ¨ event loop é‡Œé¢æœ‰ä¸¤ä¸ªtaskï¼Œä¸€ä¸ªæ˜¯mainï¼Œä¸€ä¸ªæ˜¯è¿™ä¸ª say_afterï¼Œä½†æ˜¯mainè¿è¡Œä¸äº†ï¼Œ mainè¯´æˆ‘è¦ç­‰è¿™ä¸ª say afterï¼Œé‚£event loopï¼Œå°±è®©è¿™ä¸ªsay_afterå…ˆè¿è¡Œã€‚</p><p><code>await asyncio.sleep(delay)</code>â€‹ è¿™é‡Œå…¶å®åšäº†ä¸€ä¸ªå¾ˆç›¸ä¼¼çš„äº‹æƒ…ï¼Œä¹Ÿæ˜¯æŠŠå®ƒå˜æˆäº†ä¸€ä¸ªtaskï¼Œç„¶åå‘Šè¯‰ event loop è¯´æˆ‘å¾—ç­‰è¿™ä¸ª sleep å®Œæˆäº†æˆ‘æ‰èƒ½è¿è¡Œã€‚ç„¶å await åˆæŠŠè¿™ä¸ªæ§åˆ¶æƒè½¬å›ç»™äº† event loopã€‚</p><p>event loop ä¸€çœ‹ç°åœ¨æœ‰ä¸‰ä¸ª task å¯¹ä¸å¯¹ï¼Ÿæœ‰ä¸€ä¸ªmainï¼Œæœ‰ä¸€ä¸ª say_afterï¼Œè¿˜æœ‰ä¸€ä¸ªsleepï¼Œé‚£è¿™ä¸ª sleep ä¼šå‘Šè¯‰ event loop è¯´æˆ‘ä¸€ç§’é’Ÿä¹‹åæˆ‘å°±å¥½äº†ï¼Œæ‰€ä»¥è¿™ä¸ª event loop å°±ç­‰äº†ä¸€ç§’é’Ÿã€‚ä¸€ç§’é’Ÿä¹‹åè¿™ä¸ª sleep å°±å®Œæˆäº†ã€‚ç„¶å event loop çœ‹ç°åœ¨æœ‰ä¸¤ä¸ªtaskï¼Œä¸€ä¸ªmainï¼Œä¸€ä¸ª say afterï¼Œè¿™ä¸ª main è¦ç­‰ say_afterï¼Œä½†æ˜¯è¿™ä¸ª say after ç­‰çš„ä¸œè¥¿å·²ç»å®Œæˆäº†ï¼Œäºæ˜¯ event loop å°±è¯´ say_after ä½ æ¥è¿è¡Œå§ï¼Œç„¶å say_after printed ä¸€ä¸ªwhatï¼Œç„¶å say_after ä¹Ÿå®Œæˆäº†ã€‚äºæ˜¯åˆæŠŠæ§åˆ¶æƒäº¤è¿˜ç»™ event loopã€‚</p><p>event loop ä¸€çœ‹ï¼Œå“ï¼Œç°åœ¨åªæœ‰ä¸€ä¸ª task äº†ï¼Œå°±æˆ main äº†ï¼Œç„¶åå†æŠŠæ§åˆ¶æƒç»™mainï¼Œè¿™ä¸ªæ—¶å€™ mainå°±æŠŠç¬¬ä¸€ä¸ª say_after å®Œæˆäº†ï¼Œç„¶åå†åšç¬¬äºŒä¸ª say_after åšåŒæ ·çš„äº‹ï¼Œåˆç­‰äº† 2 ç§’ä¹‹åå®ƒå®Œæˆï¼Œæ‰€ä»¥æ•´ä¸ªè¿‡ç¨‹ç”¨äº† 3 ç§’ã€‚</p><p>é‚£åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰æ§åˆ¶æƒçš„è¿”å›éƒ½æ˜¯æ˜¾å¼çš„ï¼Œå°±æ˜¯<strong>â€‹ event loop å¹¶æ²¡æœ‰åŠæ³•å¼ºè¡Œçš„ä»ä¸€ä¸ª task é‡Œè¾¹æ‹¿å›æ§åˆ¶æƒï¼Œå¿…é¡»è¦è¿™ä¸ª task ä¸»åŠ¨æŠŠæ§åˆ¶æƒäº¤å›å»ã€‚</strong>äº¤å›å»çš„æ–¹å¼æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ä¸ªæ˜¯awaitï¼Œä¼šäº¤å›ï¼Œç¬¬äºŒä¸ªï¼Œå½“è¿™ä¸ªå‡½æ•°è¿è¡Œå®Œæ¯•ä¹‹åï¼Œå®ƒä¼šäº¤å›ã€‚æ‰€ä»¥è¯´å¦‚æœä½ æœ‰ä¸€ä¸ª task é‡Œé¢æœ‰ä¸€ä¸ªæ­»å¾ªç¯ï¼Œä½ çš„æ•´ä¸ª event loop å°±å¡æ­»äº†ã€‚</p><p>å¥½ï¼Œé‚£åˆšæ‰çš„è¿è¡Œè¿‡ç¨‹ä¸­ä½ å¯èƒ½å‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå¯¹ä¸å¯¹ï¼Ÿè¿™ä¸ª hello è¦ç­‰ 1 ç§’ï¼Œè¿™ä¸ª world è¦ç­‰ 2 ç§’ï¼Œå®ƒä¿©ä¸ºå•¥ä¸èƒ½ä¸€èµ·ç­‰å‘¢ï¼Ÿè¿™å°±åº”è¯¥æ˜¯æˆ‘ä»¬åç¨‹çš„æ„ä¹‰ï¼Œå¯¹ä¸å¯¹ï¼Ÿåœ¨ä½ ç¬¬ä¸€ä¸ª hello ç­‰ 1 ç§’çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆè¿™ä¸ª event loop ä¸èƒ½ç›´æ¥è®©è¿™ä¸ª world è¿è¡Œï¼Œç„¶åä½ ä¿©ä¸€èµ·ç­‰ç€ï¼Œ 2 ç§’ä¹‹åä¸å°±ç»“æŸäº†å—ï¼Ÿé‚£è¿™ä¸ªå‘¢ï¼Ÿå°±æ˜¯æˆ‘ä»¬ç›´æ¥ç”¨ await æŠŠä¸€ä¸ª cooutine å˜æˆ task å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼Œå› ä¸º await éœ€è¦åšçš„äº‹å¤ªå¤šäº†ï¼Œå®ƒè¦å˜æˆtaskï¼Œå®ƒå˜æˆ task ä¹‹åä¼šä¸»åŠ¨æŠŠæ§åˆ¶æƒäº¤å‡ºå»ï¼Œè¿˜éœ€è¦ç­‰ï¼Œè¿™æ ·åé¢çš„ä»£ç å¿…é¡»è¦ç­‰åˆ°å®ƒå®Œæˆä¹‹åæ‰èƒ½å˜æˆä¸€ä¸ªtaskã€‚  </p><p>é‚£ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ asyncioç»™æˆ‘ä»¬æä¾›äº† create task å‡½æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">say_after</span>(<span class="params">delay, what</span>):</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(delay)</span><br><span class="line">    <span class="built_in">print</span>(what)</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    task1 = asyncio.create_task(say_after(<span class="number">1</span>,<span class="string">&quot;hello&quot;</span>))</span><br><span class="line">    task2 = asyncio.create_task(say_after(<span class="number">2</span>,<span class="string">&#x27;world&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;started at <span class="subst">&#123;time.strftime( <span class="string">&#x27;%x&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> task1</span><br><span class="line">    <span class="keyword">await</span> task2</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;finished at <span class="subst">&#123;time.strftime(<span class="string">&#x27;%x&#x27;</span>)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹è¿™é‡Œç”¨åˆ°çš„ create_task å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªcoroutineã€‚ä¾ç„¶è®°ä½è¿™ä¸ª say_after è°ƒç”¨ä¹‹åè¿”å›çš„æ˜¯ä¸€ä¸ªcoroutineï¼Œå®ƒä¸ä¼šè¿è¡Œä»»ä½• coroutine é‡Œé¢çš„ä»£ç ï¼Œé‚£è¿™ä¸ª create_task å‡½æ•°ä¼šæŠŠè¿™ä¸ªcoroutineå˜æˆä¸€ä¸ªtaskï¼Œå¹¶ä¸”æŠŠè¿™ä¸ª task æ³¨å†Œåˆ° event loop é‡Œé¢ã€‚ä¹Ÿå°±æ˜¯è¯´å®ƒåˆ†æ‹…äº†åˆšæ‰ await çš„ä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œå®ƒæŠŠå®ƒåŒ…è£…æˆäº†ä¸€ä¸ªtaskï¼Œç„¶åå‘Šè¯‰ event loop è¯´OKï¼Œè¿™ä¸ª task å·²ç»å¯ä»¥å¼€å§‹æ‰§è¡Œäº†ï¼Œä½†æ˜¯ç°åœ¨ event loop å¹¶æ²¡æœ‰åŠæ³•æ‰§è¡Œè¿™ä¸ªtaskï¼Œå› ä¸ºæ§åˆ¶æƒè¿˜åœ¨ main çš„æ‰‹é‡Œï¼Œå¯¹ä¸å¯¹ï¼Ÿé‚£è¿™ä¸ªæ—¶å€™ main è¶ç€è‡ªå·±æœ‰æ§åˆ¶æƒï¼Œä»–å°±åšäº†ç¬¬äºŒä¸ªtaskã€‚</p><p>task 2 ä¹Ÿæ˜¯å‘Šè¯‰ main è¿™è¿˜æœ‰ä¸€ä¸ªæ–°çš„taskï¼Œè¿™å« say_after 2 ä¹Ÿå¯ä»¥è¿è¡Œäº†ï¼Œé‚£åœ¨è¿™å„¿ä¹‹åä»–æ‰å¼€å§‹ await task_1 await task_2 é‚£æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ await åé¢æ˜¯ä¸€ä¸ªcoroutineçš„æ—¶å€™ï¼Œå®ƒæœ‰é‚£ä¹ˆå¤šä¸ªåŠŸèƒ½å¯¹ä¸å¯¹ï¼ŸæŠŠå®ƒå˜æˆä¸€ä¸ªtaskï¼Œç„¶åæŠŠæ§åˆ¶æƒäº¤å‡ºå»ï¼Œç­‰å®ƒæ‹¿è¿”å›å€¼ã€‚é‚£å½“ await åé¢æ˜¯ä¸€ä¸ª task è€Œä¸æ˜¯ä¸€ä¸ªcoroutine çš„æ—¶å€™ï¼Œå®ƒå°±çœç•¥äº†æŠŠ coroutineå˜æˆ task è¿™ä¸€æ­¥ï¼Œå®ƒå°±åªæ˜¯å‘Šè¯‰ event loop æˆ‘éœ€è¦è¿™ä¸ª task å®Œæˆï¼Œæˆ‘æŠŠæ§åˆ¶æƒäº¤è¿˜ç»™ä½ ï¼Œå¹¶ä¸”åœ¨æ§åˆ¶æƒå›æ¥çš„æ—¶å€™ï¼Œä»è¿™ä¸ª task é‡Œé¢æå–æ‰€éœ€è¦çš„è¿”å›å€¼ã€‚</p><p>å¥½ï¼Œæˆ‘ä»¬è·‘ä¸€ä¸‹è¿™ä¸ªç¨‹åºè¯•ä¸€ä¸‹ã€‚æˆ‘ä»¬çœ‹è¿™ä¸€æ¬¡è¿™ä¸ªç¨‹åºå°±åªç”¨äº† 2 ç§’é’Ÿï¼Œå› ä¸ºå½“å®ƒ await task 1çš„æ—¶å€™ï¼Œ event loop é‡Œé¢å®é™…ä¸Šå·²ç»æœ‰äº† 3 ä¸ªtaskï¼Œæ˜¯ mainã€task 1å’Œ task 2ã€‚å½“ task 1è·Ÿ event loop è¯´å®Œè¯´æˆ‘è¦ç­‰ä¸€ç§’é’Ÿæ‰èƒ½å®Œæˆï¼Œä¹‹å event loop é—²æ¥æ— äº‹å°±èƒ½å‘ç°ï¼Œè¿™æœ‰ä¸€ä¸ª task 2 è¿˜å¯ä»¥æ‰§è¡Œï¼Œäºæ˜¯ä»–åˆæ‰§è¡Œäº† task 2ï¼Œå†è·Ÿä»–è¯´æˆ‘è¦ä¸¤ç§’é’Ÿä¹‹åæ‰èƒ½ç»“æŸï¼Œè¿™æ ·ä¸¤ä¸ª task å°±å¯ä»¥åŒæ—¶è¿›è¡Œç­‰å¾…äº†ã€‚</p><p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆasyncioå¾ˆé€‚åˆè§£å†³ä¸€äº›ç½‘ç»œé€šè®¯çš„é—®é¢˜ï¼Œå› ä¸ºç½‘ç»œé€šè®¯å¾ˆå¤šæ—¶é—´æ˜¯åœ¨ç­‰å¾…ä¸Šçš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è°“çš„IO taskï¼Œå°±æ˜¯æˆ‘çœŸæ­£çš„è¿ç®—æŒºå°‘çš„ï¼Œæˆ‘å°±æ˜¯ç­‰ä»–çš„å›å¤ï¼Œé‚£ç­‰å¾…çš„è¿™ä¸ªæ—¶é—´å°±å¯ä»¥å…¶ä»–çš„ä»»åŠ¡å»å¹²æ´»ã€‚é‚£è¿™ä¸ªå‡½æ•°æˆ‘ä»¬æ²¡æœ‰æ¶‰åŠcoroutineçš„returnï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™ä¸ªå‡½æ•°ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">say_after</span>(<span class="params">delay, what</span>):</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(delay)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;(what) - (delay)&quot;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    task1 = asyncio.create_task(say_after(<span class="number">1</span>, <span class="string">&quot;he11o&quot;</span>))</span><br><span class="line">    task2 = asyncio.create_task(say_after(<span class="number">2</span>, <span class="string">&quot;world&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;started at <span class="subst">&#123;time.strftime( <span class="string">&#x27;%x&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">    ret1 = <span class="keyword">await</span> task1</span><br><span class="line">    ret2 = <span class="keyword">await</span> task2</span><br><span class="line">    <span class="built_in">print</span>(ret1)</span><br><span class="line">    <span class="built_in">print</span>(ret2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;finished at <span class="subst">&#123;time.strftime( <span class="string">&#x27;%x&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">asyncio.run(main())</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹æˆ‘ä»¬æŠŠå‡½æ•°ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œä¸»è¦å°±æ˜¯å‘Šè¯‰å¤§å®¶æ€ä¹ˆæ‹¿åˆ°coroutineçš„ returnã€‚é‚£å½“ä½ è¦æ‹¿è¿™ä¸ªè¿”å›å€¼çš„æ—¶å€™ï¼Œä¸€å®šæ˜¯ä¸€ä¸ª variable ç­‰äº await taskï¼Œè€Œä¸æ˜¯ä¸€ä¸ª variable ç­‰äº taskã€‚æˆ‘ä»¬ä¹‹å‰å¼ºè°ƒè¿‡ï¼Œ await æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯æŠŠè¿™ä¸ª task æˆ–è€…coroutineçš„è¿™ä¸ªè¿”å›å€¼æ‹¿å‡ºæ¥ï¼Œå¦‚æœä½ ä¸ç”¨ await æ˜¯æ‹¿ä¸åˆ°è¿™ä¸ªå€¼çš„ã€‚</p><p>é‚£æœ‰çš„äººçœ‹åˆ°è¿™å¯èƒ½è¯´äº†ï¼Œé‚£å¦‚æœæˆ‘æœ‰å¾ˆå¤š task å‘¢ï¼Ÿæˆ‘æœ‰ï¼Œæ¯”å¦‚è¯´ 10 ä¸ªtaskï¼Œæˆ‘å°±å†™ 10 è¡Œ await task å—ï¼Ÿè¿™æ˜¯ä¸æ˜¯å¤ªè ¢äº†ï¼Ÿæ­£å› å¦‚æ­¤ï¼Œ asyncioç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå‡½æ•°å«åšgatherã€‚æˆ‘ä»¬çœ‹ gather è¿™ä¸ªå‡½æ•°ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªcoroutineï¼Œä½†æ˜¯å®ƒä¼šè¿”å›ä¸€ä¸ªå«åš future çš„ä¸œè¥¿ï¼Œè¿™ä¸ª future ä¹Ÿæ˜¯å¯ä»¥ç”¨ await çš„ï¼Œé‚£ gather è¿™ä¸ªå‡½æ•°ä½œç”¨ï¼Œé¦–å…ˆå®ƒçš„å‚æ•°æ˜¯è‹¥å¹²ä¸ª coroutineæˆ–è€…taskï¼Œè¿™ä¿©éƒ½å¯ä»¥ï¼Œç”šè‡³å¯ä»¥æ˜¯futureï¼Œä¹Ÿå°±æ˜¯ gather çš„ return å€¼ã€‚å®ƒè¿˜å¯ä»¥æ¥ç€gatherï¼Œé‚£å¦‚æœæ˜¯coroutineçš„è¯ï¼Œå®ƒé¦–å…ˆä¼šæŠŠå®ƒåŒ…è£…æˆtaskï¼Œå¹¶ä¸”æ³¨å†Œåˆ° event loop é‡Œï¼Œç„¶åå®ƒä¼šè¿”å›ä¸€ä¸ª future å€¼ã€‚å½“ä½  await è¿™ä¸ª future çš„æ—¶å€™ï¼Œä½ å°±ç›¸å½“äºå‘Šè¯‰ event loopï¼Œæˆ‘è¦ç­‰å¾…è¿™é‡Œé¢æ¯ä¸€ä¸ª task éƒ½å®Œæˆï¼Œæˆ‘æ‰å¯ä»¥ç»§ç»­ï¼ŒåŒæ—¶ä¼šæŠŠè¿™äº› task çš„ return å€¼æ”¾åˆ°ä¸€ä¸ª list é‡Œï¼Œç„¶åè¿”å›æ¥ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">say_after</span>(<span class="params">delay, what</span>):</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(delay)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;(what) - <span class="subst">&#123;delay&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;started at <span class="subst">&#123;time.strftime( <span class="string">&#x27;%x&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">    ret = <span class="keyword">await</span> asyncio.gather(say_after(<span class="number">1</span>, <span class="string">&#x27;hello&#x27;</span>),</span><br><span class="line">                               say_after(<span class="number">2</span>, <span class="string">&quot;world&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(ret)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;finished at <span class="subst">&#123;time.strftime( <span class="string">&#x27;%x&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">asyncio.run(main())</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ç¨‹åºçš„ç»“æœï¼Œå¯ä»¥çœ‹åˆ°è¿™æ¬¡çš„è¿™ä¸ª return value æ˜¯ä¸€ä¸ªlistï¼Œé‡Œé¢åˆ†åˆ«æ˜¯ helloå’Œworldï¼Œ<strong>é‚£ä¹ˆè¿™ä¸ª list é¡ºåºå’Œé‡Œé¢ task çš„é¡ºåºæ˜¯ä¸€è‡´çš„</strong>ï¼Œè¿™æ ·å‘¢ï¼Œæˆ‘ä»¬å°±ä¸ç”¨ä¸€ä¸ªä¸ª task await äº†ã€‚</p><p>é‚£ gather è¿˜æœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯å¦‚æœä½ ç»™çš„æ˜¯coroutineçš„è¯ï¼Œå®ƒä¼šæŠŠæ¯ä¸€ä¸ªcoroutineé¦–å…ˆéƒ½å˜æˆtaskï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ä¸ç”¨è‡ªå·±æ‰‹åŠ¨å…ˆå»å»ºç«‹è¿™äº› task äº†ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸Šè¿°ä»£ç ç»“æœï¼Œå¯ä»¥çœ‹åˆ°è¿™ç§æ–¹å¼åœ¨æ‹¿åˆ°äº†æ­£ç¡®çš„è¿”å›å€¼çš„åŒæ—¶ï¼Œå®ƒä¹Ÿåªç”¨äº† 2 ç§’ã€‚å› ä¸º gather é¦–å…ˆæŠŠè¿™ä¸¤ä¸ª coroutine éƒ½å˜æˆäº†taskï¼Œç„¶ååœ¨ main åš await çš„æ—¶å€™æ‰æŠŠæ§åˆ¶æƒäº¤å›ç»™äº† event loopï¼Œè¿™æ · event loop åœ¨åˆ†é…å“ªä¸€ä¸ª task å¯ä»¥å·¥ä½œçš„æ—¶å€™ï¼Œå®ƒå°±æœ‰æ›´å¤šçš„ task å¯ä»¥åˆ†é…äº†ã€‚</p><p>å°½ç®¡asyncioé‡Œé¢è¿˜æœ‰ä¸å°‘çš„åŠŸèƒ½ï¼Œä½†æ˜¯æŒæ¡äº†è¿™å‡ ä¸ªï¼ŒåŸºæœ¬ä¸Šä½ å°±ç†è§£äº†asyncioçš„æ ¸å¿ƒç†å¿µäº†ã€‚é‚£æˆ‘å†å¼ºè°ƒä¸€ä¸‹å‰é¢æåˆ°è¿‡çš„å‡ ä¸ªé‡ç‚¹ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li>è¦å»ºç«‹ä¸€ä¸ª event loop çš„æ¦‚å¿µï¼Œä¸Šé¢å„¿æœ‰ä¸€ä¸ª event loop ä½œä¸ºå¤§è„‘ï¼Œä¸‹é¢æ˜¯è‹¥å¹²å¯æ‰§è¡Œçš„taskã€‚ task æ˜¯æ²¡æœ‰åŠæ³•æ§åˆ¶ event loop å»æ‰§è¡ŒæŸä¸€ä¸ª task çš„ï¼Œå®ƒåªèƒ½å‘Šè¯‰ event loop è¯´æˆ‘åœ¨ç­‰è¿™ä¸ªtaskã€‚æœ€ç»ˆæ˜¯ç”± event loop æ¥å†³å®šä¸‹é¢è¦è¿è¡Œå“ªä¸ªtaskï¼Œè€Œ event loop ä¸€æ—¦å¼€å§‹è¿è¡Œtaskï¼Œå°±å¿…é¡»è¦ task æ˜¾ç¤ºçš„æŠŠæ§åˆ¶æƒäº¤è¿˜ç»™ event loopã€‚äº¤è¿˜æ§åˆ¶æƒçš„æ–¹å¼ç”± await å’Œå‡½æ•°è¿è¡Œå®Œæ¯•ã€‚æ‰€ä»¥å°½ç®¡æˆ‘ä»¬ä¼šè¯´è¿™ç§åç¨‹çš„æ–¹å¼æ˜¯å¹¶å‘çš„ï¼Œä½†æ˜¯åŒæ—¶åˆ»å®é™…ä¸Šåªæœ‰ä¸€æ®µä»£ç åœ¨è·‘ï¼Œå®ƒåªæ˜¯æƒ³åŠæ³•å†åˆ©ç”¨è¿™äº›ä»£ç ä¸­é—´çš„ç­‰å¾…æ—¶é—´ã€‚æ‰€ä»¥å¦‚æœä½ çš„ä»£ç é‡Œé¢å¹¶æ²¡æœ‰ç­‰å¾…è¿™ä»¶äº‹çš„è¯ï¼Œåç¨‹å¯¹ä½ çš„ä»£ç æ˜¯æ²¡æœ‰å¸®åŠ©çš„ã€‚</li><li>åŠ¡å¿…åˆ†æ¸…ä»€ä¹ˆæ˜¯coroutineï¼Œä»€ä¹ˆæ˜¯taskã€‚ coroutine åªæœ‰å˜æˆäº† task æ‰å¼€å§‹è¢«æ‰§è¡Œã€‚è¦èƒ½çŸ¥é“ä»€ä¹ˆæ—¶å€™ coroutine è¢«éšå¼çš„å˜æˆäº†taskï¼Œåœ¨ä½ ç›´æ¥await coroutine çš„æ—¶å€™ï¼Œç»™ä½ æ”¾åˆ° gather é‡Œçš„æ—¶å€™ï¼Œä½ æ”¾è¿›å»çš„éƒ½æ˜¯coroutineï¼Œä½†æ˜¯å®ƒä»¬ä¼šå·å·æŠŠå®ƒå˜æˆ task æ‰§è¡Œcoroutineï¼Œä¸å˜æˆ task æ˜¯æ²¡æœ‰åŠæ³•æ‰§è¡Œçš„ã€‚</li><li>æœ€åæ‹¿åˆ°ä¸€ä¸ª coroutine çš„è¿”å›å€¼æ˜¯éœ€è¦ç”¨ await çš„ã€‚ä¸€ä¸ªå˜é‡ç­‰äº await xxxã€‚</li></ol><p>â€</p><p>â€</p><p>â€</p><p>â€</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;é’ˆå¯¹&lt;a href=&quot;https://www.bilibili.com/video/BV1oa411b7c9/?spm_id_from=333.337.search-card.all.click&amp;amp;vd_source=53d8e50bea64</summary>
      
    
    
    
    <category term="Python" scheme="https://guoyujian.github.io/categories/Python/"/>
    
    <category term="å¼‚æ­¥ç¼–ç¨‹" scheme="https://guoyujian.github.io/categories/Python/%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="Python" scheme="https://guoyujian.github.io/tags/Python/"/>
    
    <category term="asyncio" scheme="https://guoyujian.github.io/tags/asyncio/"/>
    
    <category term="å¼‚æ­¥ç¼–ç¨‹" scheme="https://guoyujian.github.io/tags/%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†å¸ƒå¼ç³»ç»Ÿå­¦ä¹ èµ„æ–™</title>
    <link href="https://guoyujian.github.io/2023/02/28/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/"/>
    <id>https://guoyujian.github.io/2023/02/28/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/</id>
    <published>2023-02-28T14:21:37.000Z</published>
    <updated>2023-02-28T14:23:58.466Z</updated>
    
    <content type="html"><![CDATA[<p>source:<a href="https://gist.github.com/ascrutae/7fbc3681ff6e7f68fc908e196eac980e">https://gist.github.com/ascrutae/7fbc3681ff6e7f68fc908e196eac980e</a></p><script src="https://gist.github.com/ascrutae/7fbc3681ff6e7f68fc908e196eac980e.js"></script><p>source2: <a href="https://zhuanlan.zhihu.com/p/372646991">https://zhuanlan.zhihu.com/p/372646991</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;source:&lt;a href=&quot;https://gist.github.com/ascrutae/7fbc3681ff6e7f68fc908e196eac980e&quot;&gt;https://gist.github.com/ascrutae/7fbc3681ff6e7f68fc908</summary>
      
    
    
    
    <category term="åˆ†å¸ƒå¼" scheme="https://guoyujian.github.io/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
    
    <category term="å­¦ä¹ è·¯çº¿" scheme="https://guoyujian.github.io/tags/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/"/>
    
    <category term="åˆ†å¸ƒå¼" scheme="https://guoyujian.github.io/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>æ€æºç¬”è®°åŸºæœ¬ä½¿ç”¨</title>
    <link href="https://guoyujian.github.io/2023/02/26/%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"/>
    <id>https://guoyujian.github.io/2023/02/26/%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</id>
    <published>2023-02-26T09:49:50.000Z</published>
    <updated>2023-02-26T09:52:22.850Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h1><p>æ€æºç¬”è®°æ˜¯ä¸€æ¬¾å¾ˆå¥½çš„ç®¡ç†çŸ¥è¯†åº“çš„è½¯ä»¶ã€‚æ”¯æŒæœ¬åœ°ï¼ˆå…è´¹ï¼‰å’Œäº‘ç«¯ï¼ˆä»˜è´¹ï¼‰ä¸¤ç§æ¨¡å¼ã€‚</p><p>ä¸ä»…æ”¯æŒmarkdownè¯­æ³•ï¼Œè¿˜æœ‰æ›´å¤šå®ç”¨åŠŸèƒ½ã€‚è¿™é‡Œè¿›è¡ŒåŸºæœ¬çš„ä½¿ç”¨ä»‹ç»ã€‚</p><h1 id="æ”¯æŒmarkdownè¯­æ³•"><a href="#æ”¯æŒmarkdownè¯­æ³•" class="headerlink" title="æ”¯æŒmarkdownè¯­æ³•"></a>æ”¯æŒmarkdownè¯­æ³•</h1><p>ç•¥</p><h1 id="æ”¯æŒæ–°å»ºå¤šçº§æ–‡æ¡£"><a href="#æ”¯æŒæ–°å»ºå¤šçº§æ–‡æ¡£" class="headerlink" title="æ”¯æŒæ–°å»ºå¤šçº§æ–‡æ¡£"></a>æ”¯æŒæ–°å»ºå¤šçº§æ–‡æ¡£</h1><p><img src="image-20230226161146934.png" alt="image-20230226161146934"></p><h1 id="è®¾ç½®æ ‡ç­¾ã€ç¬”è®°å›¾æ ‡å’Œé¢˜å¤´å›¾"><a href="#è®¾ç½®æ ‡ç­¾ã€ç¬”è®°å›¾æ ‡å’Œé¢˜å¤´å›¾" class="headerlink" title="è®¾ç½®æ ‡ç­¾ã€ç¬”è®°å›¾æ ‡å’Œé¢˜å¤´å›¾"></a>è®¾ç½®æ ‡ç­¾ã€ç¬”è®°å›¾æ ‡å’Œé¢˜å¤´å›¾</h1><p>å°†é¼ æ ‡æ”¾ç½®åˆ°ç¬”è®°å¼€å¤´ï¼Œå‡ºç°çš„ä¸‰ä¸ªiconåˆ†åˆ«å¯¹åº”ï¼Œæ·»åŠ æ ‡ç­¾ï¼Œè®¾ç½®å›¾æ ‡å’Œè®¾ç½®é¢˜å¤´å›¾ã€‚</p><p><img src="image-20230226161241016.png" alt="image-20230226161241016"></p><p>è®¾ç½®ä¹‹åçš„æ•ˆæœä¸ºï¼š</p><p><img src="image-20230226161340368.png" alt="image-20230226161340368"></p><h1 id="å†…å®¹å—åˆå¹¶"><a href="#å†…å®¹å—åˆå¹¶" class="headerlink" title="å†…å®¹å—åˆå¹¶"></a>å†…å®¹å—åˆå¹¶</h1><p>å†…å®¹å—æ˜¯æ€æºçš„åŸºç¡€ã€‚å—å’Œå—ä¹‹é—´å¯ä»¥è¿›è¡Œåˆå¹¶ç­‰æ“ä½œã€‚</p><p><img src="1.gif" alt="åŠ¨ç”»"></p><h1 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h1><p>æ€æºç¬”è®°å¯ä»¥åˆ¶ä½œæ¨¡æ¿ï¼Œå¯¼å‡ºå¯¼å…¥æ¨¡æ¿ã€‚è®©ç¬”è®°æ ‡å‡†åŒ–ã€‚</p><h1 id="æŒ‚ä»¶"><a href="#æŒ‚ä»¶" class="headerlink" title="æŒ‚ä»¶"></a>æŒ‚ä»¶</h1><p>åœ¨ã€è®¾ç½®ã€‘-ã€é›†å¸‚ã€‘-ã€æŒ‚ä»¶ã€‘ä¸­è¿›è¡Œä¸‹è½½ã€‚</p><p>ç›®å‰çœ‹åˆ°æ¯”è¾ƒå¥½ç”¨çš„æŒ‚ä»¶æœ‰</p><ul><li>superdrawï¼š å¯ä»¥è®©å®ç°éšæ„æ¶‚å†™çš„æŒ‚ä»¶</li><li>drawioï¼šå®ç°ç”»æµç¨‹å›¾çš„æŒ‚ä»¶</li><li>æ€ç»´å¯¼å›¾ï¼šå¯ä»¥æ’å…¥æ€ç»´å¯¼å›¾çš„æŒ‚ä»¶</li></ul><p>å…¶ä»–çš„è‡ªè¡Œç ”ç©¶ã€‚è¿™é‡Œä»¥drawioä¸ºä¾‹ã€‚ä»–çš„æ•ˆæœæ˜¯è¿™æ ·çš„ã€‚</p><p><img src="image-20230226163445070.png" alt="image-20230226163445070"></p><h1 id="å¯¼å…¥pdfå¹¶è¿›è¡Œé˜…è§ˆ"><a href="#å¯¼å…¥pdfå¹¶è¿›è¡Œé˜…è§ˆ" class="headerlink" title="å¯¼å…¥pdfå¹¶è¿›è¡Œé˜…è§ˆ"></a>å¯¼å…¥pdfå¹¶è¿›è¡Œé˜…è§ˆ</h1><p>é€šè¿‡æ‹–æ‹½å¯¼å…¥pdfï¼Œç‚¹å‡»è¿›è¡Œé˜…è§ˆ</p><p><img src="image-20230226163828335.png" alt="image-20230226163828335"></p><p>ä¸ä»…å¦‚æ­¤ï¼Œåœ¨pdfä¸­å¯ä»¥è¿›è¡Œé€‰ä¸­å’Œæ ‡æ³¨ã€‚å°†æ ‡æ³¨ä½œä¸ºâ€œå¼•ç”¨é“¾æ¥â€å¤åˆ¶å›ç¬”è®°ã€‚ç‚¹å‡»â€œå¼•ç”¨é“¾æ¥â€å¯ä»¥ç›´æ¥æ‰“å¼€pdfï¼Œå¹¶è·³è½¬åˆ°æ ‡æ³¨çš„ä½ç½®ã€‚</p><p><img src="image-20230226164254104.png" alt="image-20230226164254104"></p><h1 id="å¯¼å‡º"><a href="#å¯¼å‡º" class="headerlink" title="å¯¼å‡º"></a>å¯¼å‡º</h1><p>ç›´æ¥å¤åˆ¶ç²˜è´´å¯¼å‡ºçš„æ˜¯markdownæ ¼å¼çš„å†…å®¹</p><p>ä¹Ÿå¯ä»¥ç›´æ¥é€‰æ‹©å¯¼å‡ºæ¨¡å¼ï¼Œå¯¼å‡ºä¸åŒå¹³å°çš„æ ¼å¼ã€‚ç›®å‰æ”¯æŒçŸ¥ä¹ã€å¾®ä¿¡å…¬ä¼—å·ç­‰ã€‚</p><p><img src="2.gif" alt="åŠ¨ç”»"></p><h1 id="å‰ªè—"><a href="#å‰ªè—" class="headerlink" title="å‰ªè—"></a>å‰ªè—</h1><p>é€šè¿‡chromeæ’ä»¶è¿›è¡Œwebé¡µé¢çš„ç¬”è®°å‰ªè—</p><p>ç±»ä¼¼æœ‰é“äº‘ç¬”è®°çš„åŠŸèƒ½ã€‚</p><p>è¿™é‡Œéœ€è¦å¯¹tokenè¿›è¡Œé…ç½®ã€‚tokenåœ¨ã€è®¾ç½®ã€‘ã€å…³äºã€‘ä¸­æŸ¥çœ‹</p><h1 id="ç½‘ç»œå›¾ç‰‡è½¬åˆ°æœ¬åœ°"><a href="#ç½‘ç»œå›¾ç‰‡è½¬åˆ°æœ¬åœ°" class="headerlink" title="ç½‘ç»œå›¾ç‰‡è½¬åˆ°æœ¬åœ°"></a>ç½‘ç»œå›¾ç‰‡è½¬åˆ°æœ¬åœ°</h1><p><img src="image-20230226164816361.png" alt="image-20230226164816361"></p><h1 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h1><p>å½“å‰å—å¯ä»¥å¼•ç”¨å…¶ä»–ç¬”è®°çš„å†…å®¹ï¼Œè¾“å…¥ä¸¤ä¸ªå·¦æ‹¬å·è§¦å‘ã€‚</p><p>ç»§ç»­è¾“å…¥å…³é”®è¯ï¼Œé€‰ä¸­å¼•ç”¨çš„å†…å®¹å³å¯ã€‚</p><p>é¼ æ ‡æ‚¬æµ®åœ¨å¼•ç”¨é“¾æ¥ä¸Šï¼Œå¯ä»¥å¯¹å¼•ç”¨çš„å†…å®¹è¿›è¡Œé¢„è§ˆã€‚</p><p>å…·ä½“æ•ˆæœå¦‚ä¸‹ã€‚</p><p><img src="3.gif" alt="åŠ¨ç”»"></p><p>é“¾æ¥åˆ†ä¸ºæ­£å‘é“¾æ¥å’Œåå‘è¿æ¥ã€‚</p><p>æ­£å‘é“¾æ¥å°±æ˜¯æŸ¥çœ‹é“¾æ¥å¼•ç”¨äº†å“ªäº›å†…å®¹å—</p><p>åå‘é“¾æ¥å°±æ˜¯æŸ¥çœ‹å“ªäº›å†…å®¹å—è¢«å¼•ç”¨äº†ã€‚</p><p>ç‚¹å‡»å³ä¸‹è§’çš„ã€åå‘é“¾æ¥ã€‘å›¾æ ‡æŸ¥çœ‹</p><p><img src="image-20230226165621640.png" alt="image-20230226165621640"></p><p>åœ¨è¿æ¥ä¸­ä½ å¯ä»¥å³é”®è¾“å…¥é”šæ–‡æœ¬ä¿®æ”¹å¼•ç”¨é“¾æ¥çš„æ–‡æœ¬</p><p><img src="image-20230226165718183.png" alt="image-20230226165718183"></p><h1 id="é—ªå¡"><a href="#é—ªå¡" class="headerlink" title="é—ªå¡"></a>é—ªå¡</h1><h2 id="åˆ¶ä½œé—ªå¡"><a href="#åˆ¶ä½œé—ªå¡" class="headerlink" title="åˆ¶ä½œé—ªå¡"></a>åˆ¶ä½œé—ªå¡</h2><p>é—ªå¡ç”¨äºèƒŒè¯µæŸäº›å†…å®¹ã€‚åˆ¶ä½œé—ªå¡çš„æµç¨‹å¦‚ä¸‹ã€‚</p><p>æ ‡è®°éœ€è¦èƒŒè¯µçš„å†…å®¹ï¼Œé€‰æ‹©å—ã€æ·»åŠ åˆ°å¡åŒ…ã€‘ï¼Œåˆ›å»ºå¡åŒ…å¹¶æ·»åŠ ã€‚</p><p><img src="image-20230226170647766.png" alt="image-20230226170647766"></p><p><img src="image-20230226170750105.png" alt="image-20230226170750105"></p><p><img src="image-20230226170852763.png" alt="image-20230226170852763"></p><h2 id="å¤ä¹ é—ªå¡"><a href="#å¤ä¹ é—ªå¡" class="headerlink" title="å¤ä¹ é—ªå¡"></a>å¤ä¹ é—ªå¡</h2><p>é€‰æ‹©ã€é—ªå¡ã€‘</p><p><img src="image-20230226170933812.png" alt="image-20230226170933812"></p><p>é€‰æ‹©å¡åŒ…å°±å¯ä»¥çœ‹åˆ°å¾…å¤ä¹ çš„é—ªå¡äº†ã€‚</p><p><img src="image-20230226171010071.png" alt="image-20230226171010071"></p><h1 id="å›¾è¡¨"><a href="#å›¾è¡¨" class="headerlink" title="å›¾è¡¨"></a>å›¾è¡¨</h1><p>è¾“å…¥<code>/</code>ï¼Œé€‰æ‹©æ’å…¥Chart</p><p><img src="image-20230226171217053.png" alt="image-20230226171217053"></p><p>è¿™é‡Œè¾“å…¥ä»£ç å³å¯æ’å…¥chartï¼Œå…¶æ ¼å¼ä¸ºechartsçš„jsonæ ¼å¼ä»£ç ã€‚</p><p>è¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼</p><ol><li>ä½¿ç”¨JSç¼–å†™å›¾è¡¨</li><li>ä½¿ç”¨<a href="https://tushuo.baidu.com/">ç™¾åº¦å›¾è¯´</a>ï¼Œå¯è§†åŒ–åˆ¶ä½œå›¾è¡¨ï¼Œç„¶åå¤åˆ¶å›¾è¡¨ä»£ç ã€‚</li></ol><p>è¿™é‡Œä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ã€‚</p><p>è¿›å…¥ç™¾åº¦å›¾è¯´ï¼Œåˆ›å»ºå›¾è¡¨ï¼Œä¿®æ”¹æ•°æ®ï¼Œç‚¹å‡»ã€æ˜¾ç¤ºä»£ç ã€‘</p><p><img src="image-20230226171700714.png" alt="image-20230226171700714"></p><p>å¤åˆ¶ä»£ç åç²˜è´´åˆ°æ€æºçš„å›¾æ ‡ä»£ç ä¸­ï¼Œå°±å¯ä»¥çœ‹åˆ°å›¾è¡¨å•¦</p><p><img src="image-20230226171753886.png" alt="image-20230226171753886"></p><h1 id="æµç¨‹å›¾"><a href="#æµç¨‹å›¾" class="headerlink" title="æµç¨‹å›¾"></a>æµç¨‹å›¾</h1><p>è¾“å…¥<code>/</code>ï¼Œé€‰æ‹©æ’å…¥flowchart</p><p>è¿™é‡Œæ”¯æŒä¸¤ç§è¯­æ³•æ ¼å¼ï¼š</p><ol><li>flowchart.js</li><li>plantUML</li></ol><h1 id="Graphviz"><a href="#Graphviz" class="headerlink" title="Graphviz"></a>Graphviz</h1><p>è¾“å…¥<code>/</code>ï¼Œé€‰æ‹©æ’å…¥Graphviz</p><p>æ”¯æŒçš„è¯­æ³•æ ¼å¼ä¸ºdotè¯­æ³•ã€‚å…·ä½“å¯ä»¥å‚è€ƒ<a href="">ç½‘ç«™</a>è¿›è¡Œç»˜åˆ¶ã€‚åœ¨è½¯ä»¶å·¥ç¨‹ã€æ•°æ®åº“å’Œæœºå™¨å­¦ä¹ æ–¹é¢ç”¨çš„å¤šï¼Œæ•ˆæœå¦‚ä¸‹ã€‚</p><p><img src="image-20230226172409698.png" alt="image-20230226172409698"></p><h1 id="Mermaid"><a href="#Mermaid" class="headerlink" title="Mermaid"></a>Mermaid</h1><p>è¾“å…¥<code>/</code>ï¼Œé€‰æ‹©æ’å…¥Mermaid</p><p>Mermaidå’ŒGraphviz ç±»ä¼¼ã€‚Mermaidå¯ä»¥ç»˜åˆ¶æµç¨‹å›¾ç­‰æ•°åç§å›¾ã€‚</p><p>æ‰“å¼€<a href="https://mermaid.js.org/">å®˜ç½‘</a>ï¼Œé€‰æ‹©å³ä¸Šè§’çš„ã€live editorã€‘è¿›è¡Œå®æ—¶ç¼–è¾‘ã€‚</p><p><img src="image-20230226172909167.png" alt="image-20230226172909167"></p><p>å¤åˆ¶ä»£ç å³å¯åœ¨æ€æºç¬”è®°ä¸­çœ‹åˆ°æ•ˆæœ</p><p><img src="image-20230226172955029.png" alt="image-20230226172955029"></p><h1 id="MindMap"><a href="#MindMap" class="headerlink" title="MindMap"></a>MindMap</h1><p>mindmapæ˜¯è„‘å›¾ã€‚</p><p>è¾“å…¥<code>/</code>ï¼Œé€‰æ‹©æ’å…¥MindMap</p><p>ä¹‹åè¿›è¡Œç¼–è¾‘</p><p><img src="image-20230226173129422.png" alt="image-20230226173129422"></p><h1 id="å¤šåª’ä½“"><a href="#å¤šåª’ä½“" class="headerlink" title="å¤šåª’ä½“"></a>å¤šåª’ä½“</h1><p>æ€æºæ”¯æŒå¤šåª’ä½“æ•°æ®çš„æ’å…¥ï¼ŒåŒ…æ‹¬è§†é¢‘ã€é“¾æ¥ã€iframe</p><p>è¿™é‡Œæ’å…¥ä¸€ä¸ªè§†é¢‘ä¸ºä¾‹ï¼š</p><p>è¾“å…¥<code>/</code>ï¼Œé€‰æ‹©æ’å…¥iframeé“¾æ¥ï¼Œå¤åˆ¶è§†é¢‘urlé“¾æ¥ã€‚æ•ˆæœå¦‚ä¸‹</p><p><img src="image-20230226173429042.png" alt="image-20230226173429042"></p><h1 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h1><ol><li><a href="https://www.bilibili.com/video/BV1bv4y1r7tA/?spm_id_from=333.788&amp;vd_source=53d8e50bea64fe70bc50c86af86d28e1">https://www.bilibili.com/video/BV1bv4y1r7tA/?spm_id_from=333.788&amp;vd_source=53d8e50bea64fe70bc50c86af86d28e1</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; title=&quot;å¼•è¨€&quot;&gt;&lt;/a&gt;å¼•è¨€&lt;/h1&gt;&lt;p&gt;æ€æºç¬”è®°æ˜¯ä¸€æ¬¾å¾ˆå¥½çš„ç®¡ç†çŸ¥è¯†åº“çš„è½¯ä»¶ã€‚æ”¯æŒæœ¬åœ°ï¼ˆå…è´¹ï¼‰å’Œäº‘ç«¯ï¼ˆä»˜è´¹ï¼‰ä¸¤ç§æ¨¡å¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ä»…æ”¯æŒmarkdownè¯­æ³•ï¼Œè¿˜æœ‰æ›´å¤šå®ç”¨åŠŸèƒ½</summary>
      
    
    
    
    <category term="å·¥å…·ç®±" scheme="https://guoyujian.github.io/categories/%E5%B7%A5%E5%85%B7%E7%AE%B1/"/>
    
    
    <category term="siyuan" scheme="https://guoyujian.github.io/tags/siyuan/"/>
    
    <category term="æ€æº" scheme="https://guoyujian.github.io/tags/%E6%80%9D%E6%BA%90/"/>
    
    <category term="æ•™ç¨‹" scheme="https://guoyujian.github.io/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="çŸ¥è¯†åº“å·¥å…·" scheme="https://guoyujian.github.io/tags/%E7%9F%A5%E8%AF%86%E5%BA%93%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>è½¯ä»¶è¡Œä¸šå°±ä¸šæ–¹å‘è°ƒç ”</title>
    <link href="https://guoyujian.github.io/2023/02/25/%E8%BD%AF%E4%BB%B6%E8%A1%8C%E4%B8%9A%E5%B0%B1%E4%B8%9A%E6%96%B9%E5%90%91%E8%B0%83%E7%A0%94/"/>
    <id>https://guoyujian.github.io/2023/02/25/%E8%BD%AF%E4%BB%B6%E8%A1%8C%E4%B8%9A%E5%B0%B1%E4%B8%9A%E6%96%B9%E5%90%91%E8%B0%83%E7%A0%94/</id>
    <published>2023-02-25T06:44:32.000Z</published>
    <updated>2023-02-25T06:44:32.469Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h1><p>æœ¬æ–‡è°ƒç ”äº†ç›®å‰è½¯ä»¶è¡Œä¸šçš„å°±ä¸šæ–¹å‘ã€‚ç”¨äºä¸ªäººé€‰æ‹©åˆé€‚çš„å°±ä¸šå²—ä½ä½¿ç”¨ã€‚ä¸»è¦è°ƒç ”äº†è½¯ä»¶è¡Œä¸šæœ‰å“ªäº›å°±ä¸šæ–¹å‘ï¼Œé’ˆå¯¹è¿™äº›æ–¹å‘åˆè°ƒç ”äº†</p><ol><li>èŒä½å²—ä½</li><li>ç›®å‰éœ€æ±‚ï¼šå¤šè¿˜æ˜¯å°‘ï¼Œä¸ºä»€ä¹ˆ</li><li>å‰æ™¯å¦‚ä½•ï¼šå¥½è¿˜æ˜¯åï¼Œè¿˜æ˜¯ä¸æ˜ï¼›ä»å›½å†…å’Œå›½å¤–ä¸¤ä¸ªè§’åº¦ï¼›æœªæ¥å‘å±•è¯„ä¼°</li><li>ä¼ä¸šï¼šæœ‰å“ªäº›ä¼ä¸šåœ¨åšï¼Œé¾™å¤´ä¼ä¸šæœ‰å“ªäº›ï¼Œä»å›½å†…å¤–ä¸¤æ–¹é¢</li><li>ç»†åˆ†é¢†åŸŸï¼šæ¯”å¦‚è‡ªç„¶è¯­è¨€å¤„ç†æœ‰å¯¹è¯é¢†åŸŸblabla</li><li>ç‰¹ç‚¹ï¼šéš¾åº¦ï¼Œç‰¹ç‚¹</li><li>æŠ€æœ¯è·¯çº¿ï¼šæ•´ç†è¯¥æ–¹å‘çš„æŠ€æœ¯è·¯çº¿å›¾ï¼Œå¯¹è¯¥æ–¹å‘çš„æŠ€æœ¯æ ˆè¿›è¡Œç®€å•ä»‹ç»</li><li>èŒä¸šè§„åˆ’ï¼šæ–¹å‘èŒä¸šçš„å‰è¿›è·¯çº¿ï¼Œåˆçº§-ä¸­çº§ï¼Œblabla</li><li>æ˜¯å¦åˆ©äºå‡ºå›½ï¼šå›½å¤–çš„éœ€æ±‚æ˜¯å¦æ›´æ—ºç››ï¼Œæ˜¯å¦æ›´å®¹æ˜“å‡ºå›½</li></ol><h1 id="è°ƒç ”æ–¹å¼"><a href="#è°ƒç ”æ–¹å¼" class="headerlink" title="è°ƒç ”æ–¹å¼"></a>è°ƒç ”æ–¹å¼</h1><p>æœ¬æ–‡æ±‡æ€»çš„è½¯ä»¶è¡Œä¸šå°±ä¸šæ–¹å‘çš„è°ƒç ”æ–¹å¼æ˜¯ï¼Œé€šè¿‡çŸ¥ä¹ã€bilibiliã€è°·æ­Œã€YouTubeã€å¾®ä¿¡å…¬ä¼—å·ã€GitHubç­‰å¹³å°ï¼Œä½¿ç”¨ä»¥ä¸‹å‡ ç»„å…³é”®è¯ï¼šã€å°±ä¸šã€èŒä¸šã€‘ã€ç¨‹åºå‘˜ã€ç å†œã€è½¯ä»¶è¡Œä¸šã€‘ã€æ–¹å‘ã€å‰æ™¯ã€è§„åˆ’ã€èµ›é“ã€‘ï¼Œæ—¶é—´é€‰å–è¿‘ä¸¤å¹´ï¼Œè¿›è¡Œæœç´¢ï¼Œæ€»ç»“ç›¸å…³è§†é¢‘ã€æ–‡ç« ã€è¯„è®ºç­‰å†…å®¹ã€‚</p><p>å…ˆæœé›†æ•´ç†å¯èƒ½çš„è½¯ä»¶è¡Œä¸šæ–¹å‘ï¼Œå†æ ¹æ®å°†è¿™äº›è½¯ä»¶è¡Œä¸šæ–¹å‘ä½œä¸ºå…³é”®è¯ï¼ŒäºŒæ¬¡æœç´¢ã€‚</p><p>PSç”±äºå›½å†…å¹¿å‘Šå¤ªå¤šï¼Œå¾ˆå¤šè¯éƒ½ä¸å¤ªå¯ä¿¡ã€‚ã€‚</p><h1 id="å¼€å‘æ–¹å‘-å‰ç«¯"><a href="#å¼€å‘æ–¹å‘-å‰ç«¯" class="headerlink" title="å¼€å‘æ–¹å‘-å‰ç«¯"></a>å¼€å‘æ–¹å‘-å‰ç«¯</h1><h2 id="èŒä½å²—ä½"><a href="#èŒä½å²—ä½" class="headerlink" title="èŒä½å²—ä½"></a>èŒä½å²—ä½</h2><p>æ— </p><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>å’Œåç«¯å·®ä¸å¤šã€‚</p><h2 id="å‰æ™¯"><a href="#å‰æ™¯" class="headerlink" title="å‰æ™¯"></a>å‰æ™¯</h2><blockquote><p>Webè¿™ç§è¿˜æ˜¯æŒºæœ‰ç”Ÿå‘½åŠ›çš„ï¼Œä½†æ˜¯ï¼Œä¸€åˆ‡éƒ½æ˜¯åœ¨å˜åŒ–ï¼Œæœ‰å¯èƒ½è‹¥å¹²å¹´åä¸€ä¸ªæŠ€æœ¯å˜é©ï¼ŒWebå°±ä¸§å¤±ä¼˜åŠ¿å˜å¾—é—¨å¯ç½—é›€äº†ï¼Œæ‰€ä»¥å‘¢ï¼Œå„ä½åŒä»ï¼Œè¦æœ‰å¿ƒç†å‡†å¤‡ã€‚</p></blockquote><p>åŒè´¨åŒ–</p><h2 id="ä¼ä¸š"><a href="#ä¼ä¸š" class="headerlink" title="ä¼ä¸š"></a>ä¼ä¸š</h2><p>ä¸å±€é™äºäº’è”ç½‘ï¼Œä½†æ˜¯äº’è”ç½‘çš„æŠ€æœ¯æ›´æ–°ï¼Œæ›´æœ‰ç«äº‰åŠ›ã€‚</p><h2 id="åº”ç”¨é¢†åŸŸ"><a href="#åº”ç”¨é¢†åŸŸ" class="headerlink" title="åº”ç”¨é¢†åŸŸ"></a>åº”ç”¨é¢†åŸŸ</h2><p>ä¸»è¦æ˜¯ç§»åŠ¨ç«¯ã€PCç«¯çš„å‰ç«¯å¼€å‘ï¼Œè¿˜æœ‰æ¸¸æˆï¼Œåç«¯ï¼ˆNodeJSï¼‰ä»¥åŠå…¶ä»–ï¼ˆæ¡Œé¢ç«¯ï¼‰</p><h2 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li>è¶Šæ¥è¶Šå·¥å…·åŒ–ã€å·¥ç¨‹åŒ–</li><li>çŸ¥è¯†çç¢ï¼Œé—¨æ§›ä½</li><li>å‡ºæ•ˆæœå¿«ã€æ¿€åŠ±å‘¨æœŸçŸ­</li></ol><h2 id="æŠ€æœ¯è·¯çº¿"><a href="#æŠ€æœ¯è·¯çº¿" class="headerlink" title="æŠ€æœ¯è·¯çº¿"></a>æŠ€æœ¯è·¯çº¿</h2><p><img src="png-FrontEnd-by-StuQ.png" alt="png-FrontEnd-by-StuQ.png"></p><p>å‰ç«¯å‘å±•ç»å†äº†ä¸‰ä¸ªé˜¶æ®µ:</p><ol><li>åŸç”Ÿhtmlã€jsã€css</li><li>å°è£…åº“ã€jquery</li><li>ç»„ä»¶åŒ–å¼€å‘ï¼šnode</li></ol><h2 id="èŒä¸šè§„åˆ’"><a href="#èŒä¸šè§„åˆ’" class="headerlink" title="èŒä¸šè§„åˆ’"></a>èŒä¸šè§„åˆ’</h2><div class="table-container"><table><thead><tr><th>èŒç§°</th><th>èŒè´£</th><th>å¹´é™(ä»…ä¾›å‚è€ƒ)</th></tr></thead><tbody><tr><td>åˆçº§å·¥ç¨‹å¸ˆ</td><td>èƒ½åœ¨å¯¼å¸ˆçš„å¸®åŠ©(è¯¦ç»†è®¾è®¡, å…³é”®ç‚¹å®ç°)ä¸‹å®Œæˆç®€å•ä»»åŠ¡</td><td>0</td></tr><tr><td>ä¸­çº§å·¥ç¨‹å¸ˆ(å¼€å‘)</td><td>èƒ½åœ¨å¯¼å¸ˆçš„ååŠ©(æ¦‚è¦è®¾è®¡, å…³é”®ç‚¹è¯´æ˜)ä¸‹<strong>ç‹¬ç«‹å®Œæˆ</strong>å¤æ‚ä»»åŠ¡</td><td>1+</td></tr><tr><td>é«˜çº§å·¥ç¨‹å¸ˆ(ç ”å‘)</td><td><strong>èƒ½é«˜è´¨é‡é«˜æ•ˆç‡åœ°ç‹¬ç«‹å®Œæˆä»»åŠ¡</strong></td><td>5+</td></tr><tr><td>èµ„æ·±/é¦–å¸­/ä¸“å®¶/æ¶æ„</td><td>å…¨å±€è§‚, æ—¢æœ‰å¹¿åº¦åˆæœ‰æ·±åº¦, åœ¨æŸä¸ªä¸“ä¸šé¢†åŸŸæœ‰ä¸€å¸­ä¹‹åœ°</td><td>8+</td></tr></tbody></table></div><h2 id="å‡ºå›½"><a href="#å‡ºå›½" class="headerlink" title="å‡ºå›½"></a>å‡ºå›½</h2><p>æ— </p><h1 id="å¼€å‘æ–¹å‘-åç«¯"><a href="#å¼€å‘æ–¹å‘-åç«¯" class="headerlink" title="å¼€å‘æ–¹å‘-åç«¯"></a>å¼€å‘æ–¹å‘-åç«¯</h1><h2 id="èŒä½å²—ä½-1"><a href="#èŒä½å²—ä½-1" class="headerlink" title="èŒä½å²—ä½"></a>èŒä½å²—ä½</h2><p>æ ¹æ®è¯­è¨€ä¸åŒåˆ†ä¸ºå¾ˆå¤šï¼Œä¾‹å¦‚ï¼ŒJavaã€Goç­‰ã€‚</p><p>å»æŸå…¬å¸åšåç«¯å¼€å‘ï¼Œä¸ä¸€å®šå¯¹ä»–ä»¬ç”¨åˆ°çš„è¯­è¨€å’Œæ¡†æ¶å¾ˆç†Ÿç»ƒï¼Œä¼šå…¶ä¸­ä¸€éƒ¨åˆ†å°±å¤Ÿäº†ï¼Œå¾ˆå¤šéƒ½æ˜¯åœ¨å·¥ä½œä¸­å­¦çš„ã€‚</p><h2 id="éœ€æ±‚-1"><a href="#éœ€æ±‚-1" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>å‰åç«¯å·®ä¸å¤šã€‚</p><h2 id="å‰æ™¯-1"><a href="#å‰æ™¯-1" class="headerlink" title="å‰æ™¯"></a>å‰æ™¯</h2><p>éšæ—¶é—´å˜åŒ–å¾ˆå¤§ã€‚ç›®å‰ä¸æ˜ã€‚</p><h2 id="ä¼ä¸š-1"><a href="#ä¼ä¸š-1" class="headerlink" title="ä¼ä¸š"></a>ä¼ä¸š</h2><p>ä¸å±€é™äºäº’è”ç½‘ï¼Œä½†æ˜¯äº’è”ç½‘çš„æŠ€æœ¯æ›´æ–°ï¼Œæ›´æœ‰ç«äº‰åŠ›ã€‚</p><h2 id="åº”ç”¨é¢†åŸŸ-1"><a href="#åº”ç”¨é¢†åŸŸ-1" class="headerlink" title="åº”ç”¨é¢†åŸŸ"></a>åº”ç”¨é¢†åŸŸ</h2><p>é¢†åŸŸå¹¿æ³›ã€‚</p><h2 id="ç‰¹ç‚¹-1"><a href="#ç‰¹ç‚¹-1" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li>æ³¨é‡åŠŸèƒ½æ€§å’Œç¨³å®šæ€§</li><li>é—¨ç±»åˆ†æ”¯å¤šï¼šä¸šåŠ¡ã€ç®—æ³•ã€æ¶æ„ã€‚ã€‚ã€‚</li><li>éš¾ä»¥å­¦æ·±ï¼Œå®¹æ˜“ç“¶é¢ˆã€‚è¿™ä¸»è¦æ˜¯å°å…¬å¸ä¸šåŠ¡é‡ä¸å¤Ÿ&amp;å¤§å…¬å¸æ„å»ºæŠ€æœ¯å£å’ï¼Œå°å…¬å¸çš„åç«¯å¼€å‘å®¹æ˜“å’Œå¤§å…¬å¸æ‹‰å¼€å·®è·</li><li>åç«¯çš„å·¥ä½œèŒƒç•´å¾ˆå¹¿ï¼šè®¾è®¡apiã€æ¶æ„ã€æ•°æ®åº“ã€ä¸šåŠ¡é€»è¾‘ã€é«˜å¯ç”¨ç­‰</li><li>éå¸¸è€ƒéªŒã€Šç³»ç»Ÿè®¾è®¡ã€‹çš„èƒ½åŠ›</li></ol><h2 id="RoadMap"><a href="#RoadMap" class="headerlink" title="RoadMap"></a>RoadMap</h2><p>ä»¥Javaä¸ºä¾‹</p><p>å›¾ç‰‡æ¥æºï¼š<a href="https://github.com/s4kibs4mi/java-developer-roadmap/blob/master/i18n/zh-CN/ReadMe-zh-CN.md">https://github.com/s4kibs4mi/java-developer-roadmap/blob/master/i18n/zh-CN/ReadMe-zh-CN.md</a></p><p><img src="java-developer-roadmap-zh-CN.png" alt="Roadmap"></p><h2 id="å‡ºå›½-1"><a href="#å‡ºå›½-1" class="headerlink" title="å‡ºå›½"></a>å‡ºå›½</h2><p>æ— </p><h1 id="å°ç»“ï¼šå‰ç«¯åç«¯å¯¹æ¯”"><a href="#å°ç»“ï¼šå‰ç«¯åç«¯å¯¹æ¯”" class="headerlink" title="å°ç»“ï¼šå‰ç«¯åç«¯å¯¹æ¯”"></a>å°ç»“ï¼šå‰ç«¯åç«¯å¯¹æ¯”</h1><h2 id="ç›¸åŒç‚¹"><a href="#ç›¸åŒç‚¹" class="headerlink" title="ç›¸åŒç‚¹"></a>ç›¸åŒç‚¹</h2><p>éœ€æ±‚ã€å·¥èµ„ã€å‰æ™¯éƒ½å·®ä¸å¤š</p><p>èŒä¸šå‘å±•è§„åˆ’å·®ä¸å¤š</p><div class="table-container"><table><thead><tr><th>èŒç§°</th><th>èŒè´£</th><th>å¹´é™(ä»…ä¾›å‚è€ƒ)</th></tr></thead><tbody><tr><td>åˆçº§å·¥ç¨‹å¸ˆ</td><td>èƒ½åœ¨å¯¼å¸ˆçš„å¸®åŠ©(è¯¦ç»†è®¾è®¡, å…³é”®ç‚¹å®ç°)ä¸‹å®Œæˆç®€å•ä»»åŠ¡</td><td>0</td></tr><tr><td>ä¸­çº§å·¥ç¨‹å¸ˆ(å¼€å‘)</td><td>èƒ½åœ¨å¯¼å¸ˆçš„ååŠ©(æ¦‚è¦è®¾è®¡, å…³é”®ç‚¹è¯´æ˜)ä¸‹<strong>ç‹¬ç«‹å®Œæˆ</strong>å¤æ‚ä»»åŠ¡</td><td>1+</td></tr><tr><td>é«˜çº§å·¥ç¨‹å¸ˆ(ç ”å‘)</td><td><strong>èƒ½é«˜è´¨é‡é«˜æ•ˆç‡åœ°ç‹¬ç«‹å®Œæˆä»»åŠ¡</strong></td><td>5+</td></tr><tr><td>èµ„æ·±/é¦–å¸­/ä¸“å®¶/æ¶æ„</td><td>å…¨å±€è§‚, æ—¢æœ‰å¹¿åº¦åˆæœ‰æ·±åº¦, åœ¨æŸä¸ªä¸“ä¸šé¢†åŸŸæœ‰ä¸€å¸­ä¹‹åœ°</td><td>8+</td></tr></tbody></table></div><h2 id="ä¸åŒç‚¹"><a href="#ä¸åŒç‚¹" class="headerlink" title="ä¸åŒç‚¹"></a>ä¸åŒç‚¹</h2><blockquote><p><strong>åç«¯è¦å­¦çš„æŠ€æœ¯å¤ªå¤šäº†</strong>ï¼Œè€Œå‰ç«¯ç›¸å¯¹æ¥è¯´å°±å°‘å¤šäº†ï¼Œå‹åŠ›è‡ªç„¶å°‘å¾ˆå¤šï¼Œè€Œä¸”åç«¯ä¹Ÿéœ€è¦å­¦ä¸€äº›å‰ç«¯æŠ€æœ¯ï¼Œæœ‰çš„å…¬å¸å°±æœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œè€ƒè™‘åˆ°åœ°ä¸­æµ·å¹²æ¶¸é—®é¢˜ï¼Œè‚¯å®šé€‰å‰ç«¯ï¼Œè€Œä¸”å¯¹äºåé¢çš„å‘å±•ï¼Œæ¯”å¦‚<strong>è½¬å‹èµ°ç®¡ç†æ¶æ„ä»€ä¹ˆçš„ï¼Œå‰ç«¯åŸºæœ¬æ²¡æœ‰ä¼˜åŠ¿</strong>ã€‚ä½†æ˜¯ç”±äº<strong>å‰ç«¯æŠ€æœ¯éš¾åº¦å’Œå­¦ä¹ æˆæœ¬ä¸æ˜¯å¤ªå¤§</strong>ï¼Œè€Œä¸”éšç€ç»éªŒç§¯ç´¯ï¼Œå³ä¾¿åˆ°äº†å››åå¤šå²ä¹Ÿå¯ä»¥ç»§ç»­å¼€å‘ï¼Œè€Œåç«¯å†ç»§ç»­æ’¸ä»£ç å°±éš¾å¤šäº†ï¼Œå› ä¸ºæœ¬æ¥å‰ç«¯é€»è¾‘ä»£ç ä¸æ˜¯å¤ªå¤šï¼Œå³ä¾¿æ˜¯ä½¿ç”¨nodeåšå‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯å¤æ‚é€»è¾‘ä¹Ÿä¸æ˜¯å¤ªå¤šï¼Œè€Œä¸”å‰ç«¯ç°åœ¨æœ‰å¾ˆå¤šè„šæ‰‹æ¶å’Œæ’ä»¶ï¼Œéƒ½å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨ã€‚è€Œåç«¯å°±ä¸ä¸€æ ·äº†ï¼Œæ€§èƒ½ï¼Œå¹¶å‘ï¼Œç®—æ³•ï¼Œå„ç§ä¼˜åŒ–ï¼ŒæœåŠ¡å™¨é—®é¢˜ç­‰ç­‰ï¼Œéƒ½æ˜¯åç«¯è€ƒè™‘çš„ï¼Œè™½ç„¶éšç€å„ç§æŠ€æœ¯çš„å‡ºç°ï¼Œç°åœ¨åç«¯ä¹Ÿå¼€å‘æ²¡æœ‰ä»¥å‰è´¹åŠ²äº†ï¼Œä½†æ˜¯è¦çŸ¥é“åº•å±‚åŸç†å’Œæºç ä½ è¿˜æ˜¯è¦å»ç¿»ï¼Œå„ç§é—®é¢˜è¿˜æ˜¯ä¸»è¦åœ¨åç«¯è¿™è§£å†³çš„ã€‚</p></blockquote><p>è¯„è®ºï¼š</p><p>å‰ç«¯å››åå¤šå²ä¹Ÿå¯ä»¥ç»§ç»­å¼€å‘ï¼Œå­˜ç–‘ã€‚éšç€å‰ç«¯æŠ€æœ¯çš„å‘å±•ï¼Œä¹Ÿå¯èƒ½æŠ€æœ¯éš¾åº¦upï¼Œå››åå¤šå²ä¸èƒ½ç»§ç»­å¼€å‘ã€‚</p><h2 id="æ€ä¹ˆé€‰"><a href="#æ€ä¹ˆé€‰" class="headerlink" title="æ€ä¹ˆé€‰"></a>æ€ä¹ˆé€‰</h2><ul><li>å…´è¶£ã€ç°çŠ¶ï¼šä½ äº†è§£å“ªä¸ªå¤šä¸€ç‚¹å°±é€‰å“ªä¸ª</li><li>èŒä¸šèƒŒæ™¯</li><li>å¹´é¾„</li></ul><h1 id="å¼€å‘æ–¹å‘-å…¨æ ˆ"><a href="#å¼€å‘æ–¹å‘-å…¨æ ˆ" class="headerlink" title="å¼€å‘æ–¹å‘-å…¨æ ˆ"></a>å¼€å‘æ–¹å‘-å…¨æ ˆ</h1><h2 id="RoadMap-1"><a href="#RoadMap-1" class="headerlink" title="RoadMap"></a>RoadMap</h2><p>æ¥æºï¼š<a href="https://github.com/easychen/stack-roadmap">https://github.com/easychen/stack-roadmap</a></p><p><img src="æ–¹ç³–å…¨æ ˆè·¯çº¿å›¾.jpg" alt="img"></p><h2 id="ç‰¹ç‚¹-2"><a href="#ç‰¹ç‚¹-2" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><p>æœ€å¤§ç‰¹ç‚¹å°±æ˜¯ï¼Œ<strong>éš¾åº¦é«˜</strong></p><p>ç‰¹ç‚¹ä¹‹äºŒæ˜¯ï¼Œç¾å›½å…¨æ ˆå²—ä½å¤šï¼Œåé¢å†æ ¹æ®ä¸ªäººç»†åˆ†é¢†åŸŸã€‚<strong>å¯èƒ½åˆ©äºå‡ºå›½</strong>ã€‚</p><p><strong>ä¸é€‚åˆåº”å±Šç”Ÿ</strong></p><p>ä¾æ®æ˜¯2019å¹´stack-overflowçš„è°ƒæŸ¥é—®å·ï¼Œç¨‹åºå‘˜å²—ä½åˆ†å¸ƒï¼š</p><p><img src="image-20230223000029-erjot3z.png" alt="image"></p><h1 id="QA"><a href="#QA" class="headerlink" title="QA"></a>QA</h1><p>ç¿»è¯‘è¿‡æ¥å«è´¨é‡ä¿è¯ï¼Œåœ¨å›½å¤–ä¸»è¦æŒ‡çš„æ˜¯æµ‹è¯•ï¼Œtesterã€‚åœ¨å›½å†…è¿˜æœ‰å¦ä¸€ç§ä¸åŒäºæµ‹è¯•çš„è´¨é‡ä¿è¯ã€‚è¿™ç‚¹éœ€è¦æ³¨æ„ï¼Œæ‹›è˜æ—¶çš„QAç©¶ç«ŸæŒ‡çš„æ˜¯è´¨é‡ä¿è¯è¿˜æ˜¯æµ‹è¯•å·¥ç¨‹å¸ˆã€‚</p><h2 id="ç‰¹ç‚¹-3"><a href="#ç‰¹ç‚¹-3" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li>åˆ†æˆä¸¤ç§ï¼Œæ‰‹å·¥æµ‹è¯•å’Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚</li><li>è‡ªåŠ¨åŒ–æµ‹è¯•éœ€è¦å†™ä»£ç ï¼Œéœ€è¦æ‡‚ä¸€ä¸¤é—¨è‡ªåŠ¨åŒ–æµ‹è¯•è¯­è¨€å’Œæ¡†æ¶ã€‚</li><li>æ‰‹å·¥æµ‹è¯•ï¼Œå¯¹å¼€å‘èƒ½åŠ›å’Œå†™ä»£ç èƒ½åŠ›æ²¡æœ‰è¦æ±‚ï¼Œä½†æ˜¯éœ€è¦æœ‰å¼€å‘çš„ç»éªŒã€‚è¿™ç±»å²—ä½åŸºæœ¬è¢«æ·˜æ±°æ‰äº†ã€‚</li></ol><h2 id="RoadMap-2"><a href="#RoadMap-2" class="headerlink" title="RoadMap"></a>RoadMap</h2><p><a href="https://github.com/yangzige/qa-roadmap/blob/main/roadmap/%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF.md">https://github.com/yangzige/qa-roadmap/blob/main/roadmap/%E6%B5%8B%E8%AF%95%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF.md</a></p><h1 id="äººå·¥æ™ºèƒ½-CVæ–¹å‘"><a href="#äººå·¥æ™ºèƒ½-CVæ–¹å‘" class="headerlink" title="äººå·¥æ™ºèƒ½-CVæ–¹å‘"></a>äººå·¥æ™ºèƒ½-CVæ–¹å‘</h1><p>2015-2020æ˜¯é»„é‡‘æœŸï¼Œæ‰¾å·¥ä½œæ¯”è¾ƒå®¹æ˜“ã€‚2020ä»¥åèµšé’±çš„ä¸šåŠ¡æŒ–æ˜çš„å·®ä¸å¤šäº†ï¼Œ<strong>å¯¹å­¦å†å’Œè®ºæ–‡çš„è¦æ±‚é«˜</strong>ã€‚</p><p>CVå²—ä½æ¯”å¼€å‘å²—<strong>å°‘å¾ˆå¤š</strong>ã€‚</p><h2 id="å‰æ™¯-2"><a href="#å‰æ™¯-2" class="headerlink" title="å‰æ™¯"></a>å‰æ™¯</h2><p>ä»Šåä¼šèµ°å‘â€œå¹³è¡¡â€ã€‚äººè¯å°±æ˜¯ä¸æ¸©ä¸ç«</p><h2 id="åº”ç”¨é¢†åŸŸ-2"><a href="#åº”ç”¨é¢†åŸŸ-2" class="headerlink" title="åº”ç”¨é¢†åŸŸ"></a>åº”ç”¨é¢†åŸŸ</h2><p><img src="640.png" alt="å›¾ç‰‡"></p><ul><li>è‡ªåŠ¨é©¾é©¶é¢†åŸŸï¼šæ¯”è¾ƒç«</li><li>å·¥ä¸šè§†è§‰é¢†åŸŸï¼šåº”ç”¨æ½œåŠ›å¤§</li><li>æ™ºæ…§åŒ»ç–—ï¼šæœ‰å‰æ™¯ä½†æ¯”è¾ƒå›°éš¾</li></ul><h2 id="RoadMap-3"><a href="#RoadMap-3" class="headerlink" title="RoadMap"></a>RoadMap</h2><p>æ²¡æ‰¾åˆ°æ¯”è¾ƒå¥½çš„ã€‚åŸºæœ¬å°±æ˜¯Pythonã€PyTorchã€æ•°å­—å›¾è±¡å¤„ç†ï¼Œæ·±åº¦å­¦ä¹ é‚£ä¸€å¥—ã€‚ã€‚</p><h1 id="äººå·¥æ™ºèƒ½-NLPæ–¹å‘"><a href="#äººå·¥æ™ºèƒ½-NLPæ–¹å‘" class="headerlink" title="äººå·¥æ™ºèƒ½-NLPæ–¹å‘"></a>äººå·¥æ™ºèƒ½-NLPæ–¹å‘</h1><blockquote><p>è‡ªç„¶è¯­è¨€å¤„ç†(<em>NLP</em>)æ˜¯äººå·¥æ™ºèƒ½æŠ€æœ¯çš„ç‹å† ï¼Œå®ƒæ¨åŠ¨ç€å½“ä»£ç§‘æŠ€çš„æŒç»­å‘å±•å’Œé‡å¤§çªç ´ï¼Œå¹¶è¶Šæ¥è¶Šå¤šåœ°åº”ç”¨äºå„è¡Œå„ä¸šï¼›å®ƒæœ‰ç€ååˆ†é‡è¦çš„å®ç”¨ä»·å€¼ï¼Œä¹Ÿæœ‰ç€é©å‘½æ€§çš„ç†è®º</p></blockquote><h2 id="å‰æ™¯-3"><a href="#å‰æ™¯-3" class="headerlink" title="å‰æ™¯"></a>å‰æ™¯</h2><p>å‰æ™¯å¹¿é˜”ã€‚ä¹‹å‰æ¯”è¾ƒå·ï¼Œç°åœ¨å› ä¸ºChatGPTçš„å‡ºç°ï¼Œç»­äº†ä¸€å£æ°”</p><h2 id="åº”ç”¨é¢†åŸŸ-3"><a href="#åº”ç”¨é¢†åŸŸ-3" class="headerlink" title="åº”ç”¨é¢†åŸŸ"></a>åº”ç”¨é¢†åŸŸ</h2><p>å¯¹è¯ã€é—®ç­”ã€‚</p><h2 id="RoadMap-4"><a href="#RoadMap-4" class="headerlink" title="RoadMap"></a>RoadMap</h2><p><a href="https://github.com/graykode/nlp-roadmap">https://github.com/graykode/nlp-roadmap</a></p><h1 id="äººå·¥æ™ºèƒ½-å…¶ä»–"><a href="#äººå·¥æ™ºèƒ½-å…¶ä»–" class="headerlink" title="äººå·¥æ™ºèƒ½-å…¶ä»–"></a>äººå·¥æ™ºèƒ½-å…¶ä»–</h1><p>äººå·¥æ™ºèƒ½è¿˜åŒ…æ‹¬å…¶ä»–æ–¹å‘ï¼Œä¾‹å¦‚æ¨èç®—æ³•ã€‚</p><h1 id="å¤§æ•°æ®"><a href="#å¤§æ•°æ®" class="headerlink" title="å¤§æ•°æ®"></a>å¤§æ•°æ®</h1><h2 id="èŒä½å²—ä½-2"><a href="#èŒä½å²—ä½-2" class="headerlink" title="èŒä½å²—ä½"></a>èŒä½å²—ä½</h2><p>å¤§æ•°æ®æ˜¯ä¸€ä¸ªæ¯”è¾ƒç¬¼ç»Ÿçš„æ–¹å‘ï¼Œæ—¢å¯ä»¥åšå¤§æ•°æ®å¼€å‘æ–¹å‘ï¼Œä¹Ÿå¯ä»¥åšæ•°æ®æŒ–æ˜ç­‰ç®—æ³•æ–¹å‘ï¼Œä¹Ÿæœ‰å•†ä¸šæ™ºèƒ½BIã€‚ã€‚ã€‚</p><p>å…·ä½“æ–¹å‘æœ‰ä»¥ä¸‹ï¼š</p><ol><li>ETL/æ•°ä»“å·¥ç¨‹å¸ˆï¼šè´Ÿè´£æ•°ä»“å»ºè®¾ï¼Œåè„šæœ¬å¼€å‘ä»¥åŠSQLå¼€å‘ã€‚</li><li>å¤§æ•°æ®å¼€å‘å·¥ç¨‹å¸ˆï¼šè´Ÿè´£æ•°æ®è®¡ç®—ï¼Œåç¦»çº¿ã€‚å®æ—¶ä»£ç å¼€å‘ã€‚</li><li>å¤§æ•°æ®åˆ†æå¸ˆï¼šè´Ÿè´£æ•°æ®æŒ–æ˜åˆ†æã€åä¸šåŠ¡åˆ†æ/SQL</li><li>å¤§æ•°æ®ç®—æ³•å·¥ç¨‹å¸ˆï¼šç®—æ³•å»ºæ¨¡ã€åŸºäºäººå·¥æ™ºèƒ½å»ºæ¨¡ã€‚å¾€å¾€æ˜¯å’Œæ¨èç®—æ³•ç›¸å…³ã€‚</li><li>å¤§æ•°æ®BIå·¥ç¨‹å¸ˆï¼šåæŠ¥è¡¨å’ŒSQLå¼€å‘ã€‚</li></ol><p>ä¸åŒæ–¹å‘çš„å­¦ä¹ è·¯çº¿å’ŒæŠ€èƒ½éƒ½æœ‰æ‰€ä¸åŒã€‚</p><h2 id="éœ€æ±‚-2"><a href="#éœ€æ±‚-2" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>æ²¡æœ‰Javaé‚£ä¹ˆå·ï¼Œä½†æ˜¯å²—ä½ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå¤šã€‚</p><h2 id="å‰æ™¯-4"><a href="#å‰æ™¯-4" class="headerlink" title="å‰æ™¯"></a>å‰æ™¯</h2><h2 id="ç‰¹ç‚¹-4"><a href="#ç‰¹ç‚¹-4" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ol><li>å¤§æ•°æ®å¼€å‘éœ€è¦å­¦ä¹ çš„ç»„ä»¶éå¸¸å¤šã€‚ä¹Ÿæ¯”è¾ƒéš¾ã€‚</li><li>ETL/æ•°ä»“çš„å·¥ä½œæ¯”è¾ƒåŸºç¡€ã€‚</li><li>å¤§æ•°æ®åˆ†æå’Œç®—æ³•ä¸»è¦åç®—æ³•ç›¸å…³ã€‚</li></ol><h2 id="RoadMap-5"><a href="#RoadMap-5" class="headerlink" title="RoadMap."></a>RoadMap.</h2><p>å­¦ä¹ å¯ä»¥ä»SQLå…¥æ‰‹ã€‚</p><p><a href="https://github.com/TeamStuQ/skill-map/blob/master/data/map-BigDataEngineer.md">https://github.com/TeamStuQ/skill-map/blob/master/data/map-BigDataEngineer.md</a></p><h2 id="ä¸€ç¯‡æœ‰ç”¨çš„æ–‡ç« "><a href="#ä¸€ç¯‡æœ‰ç”¨çš„æ–‡ç« " class="headerlink" title="ä¸€ç¯‡æœ‰ç”¨çš„æ–‡ç« "></a>ä¸€ç¯‡æœ‰ç”¨çš„æ–‡ç« </h2><p>æƒ³å­¦å¤§æ•°æ®ï¼Œå¤§æ•°æ®å¼€å‘ä»¥åçš„å‰æ™¯æ€ä¹ˆæ ·ï¼Œå®¶é‡Œäººå¯¹è¿™æ–¹é¢äº†è§£ä¸æ·±ï¼Œä¸å¤ªåŒæ„è½¬è¡Œï¼Ÿ - äº‘åŸç”Ÿç ”ä¹ ç¤¾çš„å›ç­” - çŸ¥ä¹ <a href="https://www.zhihu.com/question/509912345/answer/2664371834">https://www.zhihu.com/question/509912345/answer/2664371834</a></p><h1 id="UX-UI"><a href="#UX-UI" class="headerlink" title="UX/UI"></a>UX/UI</h1><p>UXæ˜¯User Experienceï¼ˆç”¨æˆ·ä½“éªŒï¼‰çš„ç¼©å†™ï¼ŒæŒ‡çš„æ˜¯å›´ç»•ç”¨æˆ·ï¼Œä»¥ç”¨æˆ·åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­çš„ä¸»è§‚æ„Ÿå—ä¸ºå‡ºå‘ç‚¹ï¼ŒåŠ›æ±‚æ›´ç®€å•é«˜æ•ˆåœ°æ»¡è¶³ç”¨æˆ·éœ€æ±‚ã€‚ UXè®¾è®¡å¸ˆçš„èŒè´£ç®€å•æ¥è¯´å°±æ˜¯ä¸ºç”¨æˆ·è®¾è®¡å‹å¥½çš„äº§å“ä½“éªŒï¼Œä»–æ›´å…³æ³¨äº§å“çš„æ˜“ç”¨æ€§ã€å®ç”¨æ€§ã€é«˜æ•ˆæ€§åŠä»·å€¼ä½“ç°ã€‚</p><p>UIçš„å…¨åæ˜¯User Interfaceï¼Œä¸­æ–‡æ˜¯ã€Œä½¿ç”¨è€…ä»‹é¢ã€çš„æ„æ€ã€‚ä»‹é¢æŒ‡çš„æ˜¯APPã€ç¶²é ç­‰ï¼Œå¯ä»¥èˆ‡ä½¿ç”¨è€…äº’å‹•çš„åª’ä»‹ã€‚å¦‚åŒå­—é¢ä¸Šçš„æ„æ€ï¼ŒUIè‘—é‡çš„æ˜¯ä½¿ç”¨è€…ä»‹é¢çš„å‘ˆç¾ï¼Œå¦‚ï¼šè¦–è¦ºç¾æ„Ÿã€è¨­è¨ˆç¾å­¸ã€ä¾¿åˆ©æ€§ã€é¢¨æ ¼å‘ˆç¾ï¼Œç´°ç¯€æ›´åŒ…å«äº†å­—å‹ã€å­—é«”å¤§å°ã€é¡è‰²ã€æ¨™èªŒã€æŒ‰éµã€å‹•ç•«æ•ˆæœç­‰ã€‚UIçš„å‘ˆç¾ï¼Œæœƒå½±éŸ¿åˆ°ä½¿ç”¨è€…çš„ä½¿ç”¨æ„Ÿå—ï¼Œä»¥åŠé †æš¢æ€§ã€‚</p><p>å…¶ä»–ç•¥ã€‚</p><h1 id="æ•°æ®é‡‡é›†"><a href="#æ•°æ®é‡‡é›†" class="headerlink" title="æ•°æ®é‡‡é›†"></a>æ•°æ®é‡‡é›†</h1><p>çˆ¬è™«æ–¹å‘ã€‚ä¸æƒ³è¯´ã€‚ã€‚</p><h1 id="æ•°æ®æŒ–æ˜"><a href="#æ•°æ®æŒ–æ˜" class="headerlink" title="æ•°æ®æŒ–æ˜"></a>æ•°æ®æŒ–æ˜</h1><blockquote><p>å¹¿ä¹‰ä¸Šè¯´ï¼Œä»»ä½•ä»æ•°æ®åº“ä¸­æŒ–æ˜ä¿¡æ¯çš„è¿‡ç¨‹éƒ½å«åšæ•°æ®æŒ–æ˜ã€‚ä»è¿™ç‚¹çœ‹æ¥ï¼Œæ•°æ®æŒ–æ˜å°±æ˜¯BIï¼ˆå•†ä¸šæ™ºèƒ½ï¼‰ã€‚ä½†ä»æŠ€æœ¯æœ¯è¯­ä¸Šè¯´ï¼Œæ•°æ®æŒ–æ˜(Data Mining)ç‰¹æŒ‡çš„æ˜¯ï¼šæºæ•°æ®ç»è¿‡æ¸…æ´—å’Œè½¬æ¢ç­‰æˆä¸ºé€‚åˆäºæŒ–æ˜çš„æ•°æ®é›†ã€‚æ•°æ®æŒ–æ˜åœ¨è¿™ç§å…·æœ‰å›ºå®šå½¢å¼çš„æ•°æ®é›†ä¸Šå®ŒæˆçŸ¥è¯†çš„æç‚¼ï¼Œæœ€åä»¥åˆé€‚çš„çŸ¥è¯†æ¨¡å¼ç”¨äºè¿›ä¸€æ­¥åˆ†æå†³ç­–å·¥ä½œã€‚ä»è¿™ç§ç‹­ä¹‰çš„è§‚ç‚¹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ï¼šæ•°æ®æŒ–æ˜æ˜¯ä»ç‰¹å®šå½¢å¼çš„æ•°æ®é›†ä¸­æç‚¼çŸ¥è¯†çš„è¿‡ç¨‹ã€‚æ•°æ®æŒ–æ˜å¾€å¾€é’ˆå¯¹ç‰¹å®šçš„æ•°æ®ã€ç‰¹å®šçš„é—®é¢˜ï¼Œé€‰æ‹©ä¸€ç§æˆ–è€…å¤šç§æŒ–æ˜ç®—æ³•ï¼Œæ‰¾åˆ°æ•°æ®ä¸‹é¢éšè—çš„è§„å¾‹ï¼Œè¿™äº›è§„å¾‹å¾€å¾€è¢«ç”¨æ¥é¢„æµ‹ã€æ”¯æŒå†³ç­–ã€‚</p></blockquote><p>å¯ä»¥æ”¾åˆ°å¤§æ•°æ®çš„æ•°æ®æŒ–æ˜çš„ç›¸å…³å²—ä½æ¥çœ‹ã€‚</p><h2 id="åº”ç”¨é¢†åŸŸ-4"><a href="#åº”ç”¨é¢†åŸŸ-4" class="headerlink" title="åº”ç”¨é¢†åŸŸ"></a>åº”ç”¨é¢†åŸŸ</h2><p>æƒ…æŠ¥æ£€ç´¢ã€æ•°æ®åˆ†æã€æ¨¡å¼è¯†åˆ«</p><h1 id="å­˜å‚¨"><a href="#å­˜å‚¨" class="headerlink" title="å­˜å‚¨"></a>å­˜å‚¨</h1><p>å¯ä»¥æ”¾åˆ°å¤§æ•°æ®çš„æ•°æ®å­˜å‚¨çš„ç›¸å…³å²—ä½æ¥çœ‹ã€‚</p><p>ä¸»è¦ç ”ç©¶å„ç§æ•°æ®åº“å­˜å‚¨ã€‚</p><h2 id="æœ‰ç”¨çš„æ–‡ç« "><a href="#æœ‰ç”¨çš„æ–‡ç« " class="headerlink" title="æœ‰ç”¨çš„æ–‡ç« "></a>æœ‰ç”¨çš„æ–‡ç« </h2><p><a href="https://github.com/wx-chevalier/Database-Series">https://github.com/wx-chevalier/Database-Series</a></p><h1 id="åŒºå—é“¾"><a href="#åŒºå—é“¾" class="headerlink" title="åŒºå—é“¾"></a>åŒºå—é“¾</h1><h2 id="å‰æ™¯-5"><a href="#å‰æ™¯-5" class="headerlink" title="å‰æ™¯"></a>å‰æ™¯</h2><p>å‰æ™¯å¾ˆå¥½ã€‚</p><h2 id="æœ‰ç”¨çš„æ–‡ç« -1"><a href="#æœ‰ç”¨çš„æ–‡ç« -1" class="headerlink" title="æœ‰ç”¨çš„æ–‡ç« "></a>æœ‰ç”¨çš„æ–‡ç« </h2><p><a href="https://github.com/LiuBoyu/blockchain">https://github.com/LiuBoyu/blockchain</a></p><p><a href="https://github.com/xianfeng92/Love-Ethereum">https://github.com/xianfeng92/Love-Ethereum</a></p><h2 id="åº”ç”¨é¢†åŸŸ-5"><a href="#åº”ç”¨é¢†åŸŸ-5" class="headerlink" title="åº”ç”¨é¢†åŸŸ"></a>åº”ç”¨é¢†åŸŸ</h2><p>åŒºå—é“¾+ç‰©è”ç½‘</p><h1 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h1><p>ç•¥ï¼Œä¸æ„Ÿå…´è¶£ã€‚ä½†æ˜¯å’ŒåŒºå—é“¾æ¯æ¯ç›¸å…³ã€‚</p><h1 id="æ¸¸æˆå¼€å‘"><a href="#æ¸¸æˆå¼€å‘" class="headerlink" title="æ¸¸æˆå¼€å‘"></a>æ¸¸æˆå¼€å‘</h1><h1 id="VR"><a href="#VR" class="headerlink" title="VR"></a>VR</h1><h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><h2 id="ç´ è´¨è¦æ±‚"><a href="#ç´ è´¨è¦æ±‚" class="headerlink" title="ç´ è´¨è¦æ±‚"></a>ç´ è´¨è¦æ±‚</h2><p>è¿™éƒ¨åˆ†æ˜¯é™¤äº†ç»†åˆ†æ–¹å‘ä¹‹å¤–çš„ï¼Œå¯¹è½¯ä»¶è¡Œä¸šä»ä¸šè€…çš„å…±åŒè¦æ±‚ï¼š</p><ol><li>æ¶‰çŒå…¶å®ƒé¢†åŸŸçš„ä¸“ä¸šçŸ¥è¯†ï¼Œä¸°å¯Œè‡ªå·±çš„çŸ¥è¯†ä½“ç³»ã€æé«˜è‡ªå·±çš„ç»¼åˆç´ è´¨ï¼Œäº‰å–åœ¨è‡ªå·±çš„ä¸“ä¸šé¢†åŸŸæœ‰æ‰€ç§¯ç´¯ï¼Œç„¶åå†åšæ‰©å±•ã€‚<strong>ä¸è¦æŠŠè‡ªå·±çš„çŸ¥è¯†ä½“ç³»å±€é™äºè‡ªå·±çš„å²—ä½ä¸Š</strong></li><li><strong>ç»ˆèº«å­¦ä¹ </strong></li><li>æŠ€æœ¯è§‚ï¼šä¸è¦æ’æ–¥å…¶ä»–æŠ€æœ¯</li><li>äº§å“è§‚ï¼šæœ‰äº§å“å¸¸è¯†</li><li>æ•°æ®è§‚ï¼šå¯¹æ•°æ®æ•æ„Ÿ</li><li>çŸ¥å…¶ç„¶çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œä¼šä½¿ç”¨è½®å­ï¼Œä¹Ÿè¦ç ”ç©¶è½®å­ã€‚</li></ol><h2 id="ç¾å›½ç¡•å£«åšå£«CSä¸“ä¸šåˆ†ç±»"><a href="#ç¾å›½ç¡•å£«åšå£«CSä¸“ä¸šåˆ†ç±»" class="headerlink" title="ç¾å›½ç¡•å£«åšå£«CSä¸“ä¸šåˆ†ç±»"></a>ç¾å›½ç¡•å£«åšå£«CSä¸“ä¸šåˆ†ç±»</h2><p><img src="image-20230223090322289.png" alt="image-20230223090322289"></p><p><img src="image-20230223090346670.png" alt="image-20230223090346670"></p><h2 id="è®¡ç®—æœºç§‘å­¦çš„ä¸»è¦åˆ†æ”¯"><a href="#è®¡ç®—æœºç§‘å­¦çš„ä¸»è¦åˆ†æ”¯" class="headerlink" title="è®¡ç®—æœºç§‘å­¦çš„ä¸»è¦åˆ†æ”¯"></a>è®¡ç®—æœºç§‘å­¦çš„ä¸»è¦åˆ†æ”¯</h2><p><img src="815c0d5aed01530b7cf11d0c9061ec70.png" alt="815c0d5aed01530b7cf11d0c9061ec70.png"></p><h1 id="å¤‡æ³¨"><a href="#å¤‡æ³¨" class="headerlink" title="å¤‡æ³¨"></a>å¤‡æ³¨</h1><p>è¿™ç¯‡æ–‡ç« éå¸¸æµ…è–„ï¼Œæ²¡æœ‰ä»”ç»†åˆ†æå„ä¸ªè¡Œä¸šçš„ç°çŠ¶å’Œæƒ…å†µã€‚åªæ˜¯ç½—åˆ—äº†ä¸€äº›èµ„æ–™ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ‘˜è¦&quot;&gt;&lt;a href=&quot;#æ‘˜è¦&quot; class=&quot;headerlink&quot; title=&quot;æ‘˜è¦&quot;&gt;&lt;/a&gt;æ‘˜è¦&lt;/h1&gt;&lt;p&gt;æœ¬æ–‡è°ƒç ”äº†ç›®å‰è½¯ä»¶è¡Œä¸šçš„å°±ä¸šæ–¹å‘ã€‚ç”¨äºä¸ªäººé€‰æ‹©åˆé€‚çš„å°±ä¸šå²—ä½ä½¿ç”¨ã€‚ä¸»è¦è°ƒç ”äº†è½¯ä»¶è¡Œä¸šæœ‰å“ªäº›å°±ä¸šæ–¹å‘ï¼Œé’ˆå¯¹è¿™äº›æ–¹å‘åˆè°ƒç ”äº†&lt;/p&gt;
&lt;ol&gt;
</summary>
      
    
    
    
    <category term="è½¯ä»¶è¡Œä¸š" scheme="https://guoyujian.github.io/categories/%E8%BD%AF%E4%BB%B6%E8%A1%8C%E4%B8%9A/"/>
    
    
  </entry>
  
  <entry>
    <title>Visual Attention Network</title>
    <link href="https://guoyujian.github.io/2023/02/04/Visual-Attention-Network/"/>
    <id>https://guoyujian.github.io/2023/02/04/Visual-Attention-Network/</id>
    <published>2023-02-04T03:31:37.000Z</published>
    <updated>2023-02-04T03:55:16.229Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡æ˜¯è®ºæ–‡ã€ŠVisual Attention Networkã€‹çš„å­¦ä¹ ç¬”è®°</p><p>æˆ‘åœ¨è¯¥æ¨¡å‹ä¸Šæ‰§è¡Œä¸€ä¸ªåˆ†ç±»ä»»åŠ¡ï¼Œå‘ç°è¯¥æ¨¡å‹çš„æ•ˆæœè¦ä¼˜äºæˆ‘å®éªŒçš„å…¶ä»–æ¨¡å‹ï¼ˆåŒ…æ‹¬resnet50ã€densenet121ã€efficientNet-b0ã€swin-tinyï¼‰</p><p>æ‰€ä»¥åœ¨æ­¤è®°å½•ä¸€ä¸‹ï¼Œç¬”è®°å¤§å¤šæ˜¯æŠ„çš„ï¼Œå‡ºå¤„åœ¨Refsä¸Šè¡¨æ˜ï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»æˆ‘ã€‚</p><p><a href="https://arxiv.org/abs/2202.09741">è®ºæ–‡åœ°å€</a>   <a href="https://github.com/Visual-Attention-Network">ä»£ç åœ°å€</a></p></blockquote><p>â€</p><h1 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h1><h2 id="è‡ªæ³¨æ„åŠ›æœºåˆ¶"><a href="#è‡ªæ³¨æ„åŠ›æœºåˆ¶" class="headerlink" title="è‡ªæ³¨æ„åŠ›æœºåˆ¶"></a>è‡ªæ³¨æ„åŠ›æœºåˆ¶</h2><p><a href="https://zhuanlan.zhihu.com/p/265108616">Attentionæ³¨æ„åŠ›æœºåˆ¶ä¸self-attentionè‡ªæ³¨æ„åŠ›æœºåˆ¶</a></p><p><a href="https://www.jiqizhixin.com/articles/100902">ä»€ä¹ˆæ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Ÿ</a></p><h2 id="ç©ºé—´ç›¸å…³æ€§å’Œé€šé“ç›¸å…³æ€§1"><a href="#ç©ºé—´ç›¸å…³æ€§å’Œé€šé“ç›¸å…³æ€§1" class="headerlink" title="ç©ºé—´ç›¸å…³æ€§å’Œé€šé“ç›¸å…³æ€§1"></a>ç©ºé—´ç›¸å…³æ€§å’Œé€šé“ç›¸å…³æ€§<sup><a href="#fn_1" id="reffn_1">1</a></sup></h2><p>ä»ç»´åº¦çš„è§’åº¦çœ‹ï¼Œå·ç§¯æ ¸å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªç©ºé—´ç»´(å®½å’Œé«˜)å’Œé€šé“ç»´çš„ç»„åˆï¼Œè€Œ<strong>å·ç§¯æ“ä½œåˆ™å¯ä»¥è§†ä¸ºç©ºé—´ç›¸å…³æ€§å’Œé€šé“ç›¸å…³æ€§çš„è”åˆæ˜ å°„</strong>ã€‚ä»inceptionçš„1x1å·ç§¯æ¥çœ‹ï¼Œ<strong>å·ç§¯ä¸­çš„ç©ºé—´ç›¸å…³æ€§å’Œé€šé“ç›¸å…³æ€§æ˜¯å¯ä»¥è§£è€¦çš„ï¼Œå°†å®ƒä»¬åˆ†å¼€è¿›è¡Œæ˜ å°„ï¼Œå¯èƒ½ä¼šè¾¾åˆ°æ›´å¥½çš„æ•ˆæœã€‚</strong></p><p>æ·±åº¦å¯åˆ†ç¦»å·ç§¯æ˜¯åœ¨1x1å·ç§¯åŸºç¡€ä¸Šçš„ä¸€ç§åˆ›æ–°ã€‚ä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼šæ·±åº¦å·ç§¯å’Œ1x1å·ç§¯ã€‚æ·±åº¦å·ç§¯çš„ç›®çš„åœ¨äºå¯¹è¾“å…¥çš„æ¯ä¸€ä¸ªé€šé“éƒ½å•ç‹¬ä½¿ç”¨ä¸€ä¸ªå·ç§¯æ ¸å¯¹å…¶è¿›è¡Œå·ç§¯ï¼Œä¹Ÿå°±æ˜¯é€šé“åˆ†ç¦»åå†ç»„åˆã€‚1x1å·ç§¯çš„ç›®çš„åˆ™åœ¨äºåŠ å¼ºæ·±åº¦ã€‚ä¸‹é¢ä»¥ä¸€ä¸ªä¾‹å­æ¥çœ‹ä¸€ä¸‹æ·±åº¦å¯åˆ†ç¦»å·ç§¯ã€‚</p><p>å‡è®¾æˆ‘ä»¬ç”¨128ä¸ª$3 \times3 \times3$çš„æ»¤æ³¢å™¨å¯¹ä¸€ä¸ª $7 \times7 \times3$çš„è¾“å…¥è¿›è¡Œå·ç§¯ï¼Œå¯å¾—åˆ°$5 \times5 \times128$çš„è¾“å‡º,å…¶è®¡ç®—é‡ä¸º$5 \times5 \times128 \times3 \times3 \times3=86400$ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="image-20230204110644-zz7yeyj.png" alt="image">â€‹</p><p>ç°åœ¨çœ‹å¦‚ä½•ä½¿ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯æ¥å®ç°åŒæ ·çš„ç»“æœã€‚æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„ç¬¬ä¸€æ­¥æ˜¯æ·±åº¦å·ç§¯ã€‚è¿™é‡Œçš„æ·±åº¦å·ç§¯ï¼Œå°±æ˜¯åˆ†åˆ«ç”¨3ä¸ª$3 \times3 \times1$çš„æ»¤æ³¢å™¨å¯¹è¾“å…¥çš„3ä¸ªé€šé“åˆ†åˆ«åšå·ç§¯ï¼Œä¹Ÿå°±æ˜¯è¯´è¦åš3æ¬¡å·ç§¯ï¼Œæ¯æ¬¡å·ç§¯éƒ½æœ‰ä¸€ä¸ª$5 \times5 \times1$çš„è¾“å‡ºï¼Œç»„åˆåœ¨ä¸€èµ·ä¾¿æ˜¯$5 \times5 \times3$çš„è¾“å‡ºã€‚ç°åœ¨ä¸ºäº†æ‹“å±•æ·±åº¦è¾¾åˆ°128ï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œæ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„ç¬¬äºŒæ­¥ï¼š1x1å·ç§¯ã€‚ç°åœ¨æˆ‘ä»¬ç”¨128ä¸ª$1 \times1 \times3$çš„æ»¤æ³¢å™¨å¯¹$5 \times5 \times3$è¿›è¡Œå·ç§¯ï¼Œå°±å¯ä»¥å¾—åˆ°$5 \times5 \times128$çš„è¾“å‡ºã€‚å®Œæ•´è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="image-20230204111234-3ia5cu3.png" alt="image">â€‹</p><p>é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„è®¡ç®—é‡å¦‚ä½•ã€‚ç¬¬ä¸€æ­¥æ·±åº¦å·ç§¯çš„è®¡ç®—é‡ï¼š$5 \times5 \times1 \times3 \times3 \times1 \times3=675$ã€‚ç¬¬äºŒæ­¥1x1å·ç§¯çš„è®¡ç®—é‡ï¼š$5 \times5 \times128 \times1 \times1 \times3=9600$ï¼Œåˆè®¡è®¡ç®—é‡ä¸º10275æ¬¡ã€‚å¯è§ï¼Œç›¸åŒçš„å·ç§¯è®¡ç®—è¾“å‡ºï¼Œæ·±åº¦å¯åˆ†ç¦»å·ç§¯è¦æ¯”å¸¸è§„å·ç§¯èŠ‚çœ12å€çš„è®¡ç®—æˆæœ¬ã€‚</p><blockquote><p>å…¸å‹çš„åº”ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„ç½‘ç»œæ¨¡å‹åŒ…æ‹¬xceptionå’Œmobilenetç­‰ã€‚æœ¬è´¨ä¸Šè€Œè¨€ï¼Œxceptionå°±æ˜¯åº”ç”¨äº†æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„inceptionç½‘ç»œã€‚</p></blockquote><h1 id="æ­£æ–‡2"><a href="#æ­£æ–‡2" class="headerlink" title="æ­£æ–‡2"></a>æ­£æ–‡<sup><a href="#fn_2" id="reffn_2">2</a></sup></h1><h2 id="åŠ¨æœº"><a href="#åŠ¨æœº" class="headerlink" title="åŠ¨æœº"></a>åŠ¨æœº</h2><p>å›¾åƒçš„äºŒç»´æ€§è´¨ç»™åœ¨è®¡ç®—æœºè§†è§‰ä¸­åº”ç”¨è‡ªæ³¨æ„åŠ›å¸¦æ¥äº†ä¸‰ä¸ªæŒ‘æˆ˜ï¼š</p><ol><li>å°†å›¾åƒå¤„ç†ä¸ºä¸€ç»´åºåˆ—ï¼Œå¿½ç•¥äº†å…¶äºŒç»´ç»“æ„ã€‚</li><li>äºŒæ¬¡å¤æ‚åº¦å¯¹äºé«˜åˆ†è¾¨ç‡çš„å›¾åƒæ¥è¯´å¤ªè´µäº†ã€‚</li><li>å®ƒåªæ•æ‰äº†ç©ºé—´é€‚åº”æ€§ï¼Œè€Œå¿½ç•¥äº†é€šé“é€‚åº”æ€§</li></ol><p>åœ¨æœ¬æ–‡ä¸­ï¼Œä½œè€…æå‡ºäº†ä¸€ç§æ–°çš„å¤§æ ¸æ³¨æ„(LKA)æ¨¡å—ï¼Œä»¥ä½¿è‡ªæ³¨æ„çš„è‡ªé€‚åº”å’Œé•¿ç¨‹ç›¸å…³ï¼ŒåŒæ—¶é¿å…äº†ä¸Šè¿°é—®é¢˜ã€‚ä½œè€…è¿›ä¸€æ­¥ä»‹ç»äº†ä¸€ç§åŸºäºLKAçš„æ–°çš„ç¥ç»ç½‘ç»œï¼Œå³è§†è§‰æ³¨æ„ç½‘ç»œ(VAN)ã€‚VANè™½ç„¶éå¸¸ç®€å•å’Œé«˜æ•ˆï¼Œä½†åœ¨åŒ…æ‹¬å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ã€è¯­ä¹‰åˆ†å‰²ã€å®ä¾‹åˆ†å‰²ç­‰å¹¿æ³›çš„å®éªŒä¸­ï¼Œå®ƒä»¥å¾ˆå¤§çš„ä¼˜åŠ¿ä¼˜äºæœ€å…ˆè¿›çš„transfomerå’Œå·ç§¯ç¥ç»ç½‘ç»œã€‚</p><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><h3 id="LCK"><a href="#LCK" class="headerlink" title="LCK"></a>LCK</h3><p>å·ç§¯ç¥ç»ç½‘ç»œ(CNNs)åˆ©ç”¨å±€éƒ¨ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œå¹³ç§»ä¸å˜æ€§ï¼Œå¤§å¤§æé«˜äº†ç¥ç»ç½‘ç»œçš„æ•ˆç‡ã€‚è‡ªAlexNetä»¥æ¥ï¼Œcnnè¿…é€Ÿæˆä¸ºè®¡ç®—æœºè§†è§‰çš„ä¸»è¦ä¸»æµæ¡†æ¶ã€‚ä¸ºäº†è¿›ä¸€æ­¥æé«˜æ•ˆç‡ï¼Œç ”ç©¶äººå‘˜æŠ•å…¥äº†å¤§é‡çš„ç²¾åŠ›ï¼Œä½¿cnnæˆä¸ºæ›´æ·±çš„å’Œæ›´è½»çš„ã€‚ä½œè€…çš„å·¥ä½œä¸MobileNetæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼ŒMobileNetå°†æ ‡å‡†å·ç§¯è§£è€¦ä¸ºä¸¤éƒ¨åˆ†ï¼Œå³æ·±åº¦å·ç§¯å’Œé€ç‚¹å·ç§¯(ä¹Ÿå°±æ˜¯1Ã—1Conv)ã€‚ä½œè€…çš„æ–¹æ³•å°†å·ç§¯åˆ†è§£ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šæ·±åº¦å·ç§¯ã€æ·±åº¦ç©ºæ´å·ç§¯å’Œé€ç‚¹å·ç§¯ã€‚å¾—ç›Šäºè¿™ç§åˆ†è§£ï¼Œä½œè€…çš„æ–¹æ³•æ›´é€‚åˆäºæœ‰æ•ˆåœ°åˆ†è§£å¤§çš„æ ¸å·ç§¯ã€‚ä½œè€…è¿˜åœ¨è¯¥æ–¹æ³•ä¸­å¼•å…¥äº†æ³¨æ„æœºåˆ¶æ¥è·å¾—è‡ªé€‚åº”ç‰¹æ€§ã€‚</p><p><img src="v2-467f001629900492069a79a14d2dc757_720w.webp" alt="img"></p><p>å½©è‰²ç½‘æ ¼è¡¨ç¤ºå·ç§¯æ ¸çš„ä½ç½®ï¼Œé»„è‰²ç½‘æ ¼è¡¨ç¤ºä¸­å¿ƒç‚¹ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œ13Ã—13å·ç§¯åˆ†è§£ä¸º5Ã—5æ·±åº¦å·ç§¯ï¼Œ5Ã—5æ·±åº¦ç©ºæ´å·ç§¯ï¼Œè†¨èƒ€é€Ÿç‡3å’Œ1Ã—1å·ç§¯</p><p><img src="v2-d22b7728ed41dd3491530ad8a94fbe19_720w.webp" alt="img"></p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">class AttentionModule(nn.Module):</span><br><span class="line">    def __init__(self, dim):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.conv0 = nn.Conv2d(dim, dim, 5, padding=2, groups=dim)#æ·±åº¦å·ç§¯</span><br><span class="line">        self.conv_spatial = nn.Conv2d(dim, dim, 7, stride=1, padding=9, groups=dim, dilation=3)#æ·±åº¦ç©ºæ´å·ç§¯</span><br><span class="line">        self.conv1 = nn.Conv2d(dim, dim, 1)#é€ç‚¹å·ç§¯</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def forward(self, x):</span><br><span class="line">        u = x.clone()        </span><br><span class="line">        attn = self.conv0(x)</span><br><span class="line">        attn = self.conv_spatial(attn)</span><br><span class="line">        attn = self.conv1(attn)</span><br><span class="line"></span><br><span class="line">        return u * attn   #æ³¨æ„åŠ›æ“ä½œ</span><br><span class="line">     </span><br><span class="line">class SpatialAttention(nn.Module):</span><br><span class="line">    def __init__(self, d_model):</span><br><span class="line">        super().__init__()</span><br><span class="line"></span><br><span class="line">        self.proj_1 = nn.Conv2d(d_model, d_model, 1)</span><br><span class="line">        self.activation = nn.GELU()</span><br><span class="line">        self.spatial_gating_unit = AttentionModule(d_model)  #æ³¨æ„åŠ›æ“ä½œ</span><br><span class="line">        self.proj_2 = nn.Conv2d(d_model, d_model, 1)</span><br><span class="line"></span><br><span class="line">    def forward(self, x):</span><br><span class="line">        shorcut = x.clone()</span><br><span class="line">        x = self.proj_1(x)</span><br><span class="line">        x = self.activation(x)</span><br><span class="line">        x = self.spatial_gating_unit(x)  #æ³¨æ„åŠ›æ“ä½œ</span><br><span class="line">        x = self.proj_2(x)</span><br><span class="line">        x = x + shorcut   #æ®‹å·®è¿æ¥</span><br><span class="line">        return x</span><br><span class="line"></span><br><span class="line">class Block(nn.Module):</span><br><span class="line">    def __init__(self, dim, mlp_ratio=4., drop=0.,drop_path=0., act_layer=nn.GELU):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.norm1 = nn.BatchNorm2d(dim)</span><br><span class="line">        self.attn = SpatialAttention(dim)</span><br><span class="line">        self.drop_path = DropPath(drop_path) if drop_path &gt; 0. else nn.Identity()</span><br><span class="line"></span><br><span class="line">        self.norm2 = nn.BatchNorm2d(dim)</span><br><span class="line">        mlp_hidden_dim = int(dim * mlp_ratio)</span><br><span class="line">        self.mlp = Mlp(in_features=dim, hidden_features=mlp_hidden_dim, act_layer=act_layer, drop=drop)</span><br><span class="line">        layer_scale_init_value = 1e-2            </span><br><span class="line">        self.layer_scale_1 = nn.Parameter(</span><br><span class="line">            layer_scale_init_value * torch.ones((dim)), requires_grad=True)</span><br><span class="line">        self.layer_scale_2 = nn.Parameter(</span><br><span class="line">            layer_scale_init_value * torch.ones((dim)), requires_grad=True)</span><br><span class="line"></span><br><span class="line">        self.apply(self._init_weights)</span><br><span class="line"></span><br><span class="line">    def _init_weights(self, m):</span><br><span class="line">        if isinstance(m, nn.Linear):</span><br><span class="line">            trunc_normal_(m.weight, std=.02)</span><br><span class="line">            if isinstance(m, nn.Linear) and m.bias is not None:</span><br><span class="line">                nn.init.constant_(m.bias, 0)</span><br><span class="line">        elif isinstance(m, nn.LayerNorm):</span><br><span class="line">            nn.init.constant_(m.bias, 0)</span><br><span class="line">            nn.init.constant_(m.weight, 1.0)</span><br><span class="line">        elif isinstance(m, nn.Conv2d):</span><br><span class="line">            fan_out = m.kernel_size[0] * m.kernel_size[1] * m.out_channels</span><br><span class="line">            fan_out //= m.groups</span><br><span class="line">            m.weight.data.normal_(0, math.sqrt(2.0 / fan_out))</span><br><span class="line">            if m.bias is not None:</span><br><span class="line">                m.bias.data.zero_()</span><br><span class="line"></span><br><span class="line">    def forward(self, x):</span><br><span class="line">        x = x + self.drop_path(self.layer_scale_1.unsqueeze(-1).unsqueeze(-1) * self.attn(self.norm1(x)))#drop_pathåˆ†æ”¯ä¸­ï¼Œæ¯ä¸ªbatchæœ‰æ¦‚ç‡ä½¿æ ·æœ¬åœ¨self.attnæˆ–è€…mlpä¸ä¼šâ€æ‰§è¡Œâ€œï¼Œä¼šä»¥0ç›´æ¥ä¼ é€’ã€‚</span><br><span class="line">        x = x + self.drop_path(self.layer_scale_2.unsqueeze(-1).unsqueeze(-1) * self.mlp(self.norm2(x)))</span><br><span class="line">        return </span><br></pre></td></tr></table></figure><p>ä½œè€…æå‡ºå¯¹å¤§æ ¸å·ç§¯æ“ä½œè¿›è¡Œåˆ†è§£æ¥æ•è·é•¿ç¨‹å…³ç³»ã€‚å¤§æ ¸å·ç§¯å¯åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šç©ºé—´å±€éƒ¨å·ç§¯ï¼ˆæ·±åº¦å·ç§¯ï¼‰ã€ç©ºé—´è¿œç¨‹å·ç§¯ï¼ˆæ·±åº¦ç©ºæ´å·ç§¯ï¼‰å’Œé€šé“å·ç§¯ï¼ˆ1Ã—1å·ç§¯ï¼‰ã€‚æ‰€ä»¥ï¼Œå¯ä»¥å°†KÃ—Kå·ç§¯åˆ†è§£ä¸ºK/dÃ—K/dçš„æ·±åº¦ç©ºæ´å·ç§¯ï¼Œ(2dâˆ’1)Ã—(2dâˆ’1)çš„æ·±åº¦å·ç§¯å’Œ1Ã—1å·ç§¯ã€‚é€šè¿‡ä¸Šè¿°åˆ†è§£ï¼Œå¯ä»¥ç”¨è½»å¾®çš„è®¡ç®—ä»£ä»·å’Œå‚æ•°æ¥æ•è·é•¿ç¨‹å…³ç³»ã€‚åœ¨å¾—åˆ°é•¿ç¨‹å…³ç³»åï¼Œå¯ä»¥ä¼°è®¡ä¸€ä¸ªç‚¹çš„é‡è¦æ€§å¹¶ç”Ÿæˆæ³¨æ„åŠ›å›¾ã€‚</p><p><img src="v2-f2a083b057051de4ae3a87fd77138a8e_720w.webp" alt="img"></p><p><img src="v2-6109ccc0466efee70bf7ac2324513a09_720w.webp" alt="img"></p><p>ä½œè€…æå‡ºçš„LKAç»“åˆäº†å·ç§¯å’Œè‡ªæ³¨æ„åŠ›çš„ä¼˜ç‚¹ã€‚å®ƒè€ƒè™‘äº†å±€éƒ¨ä¸Šä¸‹æ–‡ä¿¡æ¯ã€å¤§çš„æ„Ÿå—é‡å’ŒåŠ¨æ€è¿‡ç¨‹ã€‚æ­¤å¤–ï¼ŒLKAä¸ä»…å®ç°äº†ç©ºé—´ç»´åº¦çš„è‡ªé€‚åº”æ€§ï¼Œè€Œä¸”è¿˜å®ç°äº†é€šé“ç»´åº¦çš„è‡ªé€‚åº”æ€§ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ·±åº¦ç¥ç»ç½‘ç»œä¸­ï¼Œä¸åŒçš„é€šé“å¾€å¾€ä»£è¡¨ä¸åŒçš„å¯¹è±¡ï¼Œè€Œé€šé“ç»´åº¦çš„é€‚åº”æ€§å¯¹è§†è§‰ä»»åŠ¡ä¹Ÿå¾ˆé‡è¦ã€‚</p><h3 id="VAN"><a href="#VAN" class="headerlink" title="VAN"></a>VAN</h3><p>VANå…·æœ‰ç®€å•çš„å±‚æ¬¡ç»“æ„ï¼Œå³è¾“å‡ºç©ºé—´åˆ†è¾¨ç‡é™ä½çš„å››ä¸ªé˜¶æ®µåºåˆ—ï¼Œåˆ†åˆ«ä¸ºH/4Ã—W/4ã€H/8Ã—W/8ã€H/16Ã—W/16å’ŒH/32Ã—W/32ã€‚Hå’ŒWæ˜¯è¾“å…¥å›¾åƒçš„é«˜åº¦å’Œå®½åº¦ã€‚éšç€åˆ†è¾¨ç‡çš„é™ä½ï¼Œè¾“å‡ºé€šé“çš„æ•°é‡ä¹Ÿåœ¨ä¸æ–­å¢åŠ ã€‚è¾“å‡ºé€šé“Ciçš„å˜åŒ–å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚ é¦–å…ˆå¯¹è¾“å…¥å€¼è¿›è¡Œä¸‹é‡‡æ ·ï¼Œå¹¶ä½¿ç”¨æ­¥å¹…æ•°æ¥æ§åˆ¶ä¸‹é‡‡æ ·ç‡ã€‚ä¸‹é‡‡æ ·åï¼Œä¸€ä¸ªstageä¸­çš„æ‰€æœ‰å±‚ä¿æŒç›¸åŒçš„è¾“å‡ºå¤§å°ï¼Œå³ç©ºé—´åˆ†è¾¨ç‡å’Œé€šé“æ•°é‡ã€‚ç„¶åï¼Œæ‰¹é‡å½’ä¸€åŒ–ã€GELUæ¿€æ´»å‡½æ•°ã€å¤§æ ¸æ³¨æ„å’Œå·ç§¯å‰é¦ˆç½‘ç»œä¾æ¬¡å †å ï¼Œæå–ç‰¹å¾ã€‚æœ€åï¼Œåœ¨æ¯ä¸ªé˜¶æ®µç»“æŸæ—¶åº”ç”¨ä¸€ä¸ªå±‚å½’ä¸€åŒ–ã€‚æ ¹æ®å‚æ•°å’Œè®¡ç®—æˆæœ¬ï¼Œè®¾è®¡äº† VAN-Tiny, VAN-Small, VAN-Base and VAN-Largeå››ç§ç»“æ„ã€‚</p><p><img src="v2-9c29743630133af223ffb0b9d3c592f0_720w.webp" alt="img"></p><p><img src="v2-f3d5e05ccc5b5d1691c26fc3d8daafcd_720w.webp" alt="img"></p><p>å¯¹21Ã—21å·ç§¯çš„ä¸åŒæ–¹å¼å‚æ•°çš„æ¯”è¾ƒã€‚Xï¼ŒYå’Œouråˆ†åˆ«æä¾›äº†æ ‡å‡†å·ç§¯ï¼Œmobilenet]å’Œvançš„åˆ†è§£ã€‚è¾“å…¥å’Œè¾“å‡ºå…·æœ‰ç›¸åŒå¤§å°çš„HÃ—WÃ—C</p><p><img src="v2-f39da3202b78c90cd02669ff5039e8a9_720w.webp" alt="img"></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ¬æ–‡çš„LKAé‡‡ç”¨5Ã—5æ·±åº¦å·ç§¯ï¼Œ7Ã—7æ·±åº¦å·ç§¯ä¸è†¨èƒ€ç‡ä¸º3çš„ç©ºæ´å·ç§¯å’Œ1Ã—1å·ç§¯æ¥è¿‘ä¼¼21Ã—21å·ç§¯ã€‚åœ¨è¿™ç§è®¾ç½®ä¸‹ï¼ŒVANå¯ä»¥æœ‰æ•ˆåœ°è·å–å±€éƒ¨ä¿¡æ¯å’Œé•¿ç¨‹è”ç³»ã€‚ä½œè€…åˆ†åˆ«ä½¿ç”¨7Ã—7å’Œ3Ã—3æ­¥å¹…å·ç§¯è¿›è¡Œ4Ã—å’Œ2Ã—çš„é™é‡‡æ ·ã€‚</p><h2 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h2><p>ä½œè€…åœ¨ImageNet-1Kå›¾åƒåˆ†ç±»æ•°æ®é›†ã€COCOç›®æ ‡æ£€æµ‹æ•°æ®é›†å’ŒADE20Kè¯­ä¹‰åˆ†å‰²æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®šé‡å®éªŒã€‚æ­¤å¤–ï¼Œä½œè€…é€šè¿‡åœ¨ImageNetéªŒè¯é›†ä¸Šä½¿ç”¨Grad-CAMæ¥å¯è§†åŒ–ç±»æ¿€æ´»æ˜ å°„(CAM)ã€‚</p><h3 id="å›¾åƒåˆ†ç±»"><a href="#å›¾åƒåˆ†ç±»" class="headerlink" title="å›¾åƒåˆ†ç±»"></a>å›¾åƒåˆ†ç±»</h3><p><img src="https://pic2.zhimg.com/80/v2-2fefbe89e8e7da997c3683528fbb2535_720w.webp" alt="img"></p><p>VANä¸å…¶ä»–mlpã€cnnå’ŒViTsçš„æ¯”è¾ƒã€‚VANä¼˜äºå…¶ä»–å‚æ•°ç›¸ä¼¼ï¼Œè®¡ç®—æˆæœ¬ç›¸ä¼¼çš„cnn(ResNet[29]ï¼ŒResNeXt[90]ï¼ŒConvNeXt[53]ç­‰)ï¼ŒViTs(DeiT[74]ã€PVT[83]ã€Swin-Transformer[52]ç­‰)å’ŒMLPs(MLP-Mixer[72]ï¼ŒResMLP[73]ï¼ŒgMLP[46]ç­‰)ã€‚ä½œè€…åœ¨æ¯ä¸ªç±»åˆ«ä¸­é€‰æ‹©äº†ä¸€ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„ç½‘ç»œè¿›è¡Œè®¨è®ºã€‚ConvNeXt[53]æ˜¯ä¸€ç§ç‰¹æ®Šçš„CNNï¼Œå®ƒå¸æ”¶äº†vitçš„ä¸€äº›ä¼˜åŠ¿ï¼Œå¦‚å¤§çš„æ„Ÿå—é‡ï¼ˆ7Ã—7å·ç§¯ï¼‰å’Œå…ˆè¿›çš„è®­ç»ƒç­–ç•¥(300ä¸ªepochã€æ•°æ®å¢å¼ºç­‰)ã€‚VANå’ŒConvNeXt[53]ç›¸æ¯”ï¼ŒVAN-baseæ¯”CoNvNeXt-tå¤šå‡º0.7%(82.8%vs.82.1%)ï¼Œå› ä¸ºVANå…·æœ‰æ›´å¤§çš„æ„Ÿå—åŸŸå’Œè‡ªé€‚åº”èƒ½åŠ›ã€‚Swin-Transformeræ˜¯ä¸€ç§è‘—åçš„ViTå˜ä½“ï¼Œé‡‡ç”¨å±€éƒ¨æ³¨æ„åŠ›å’Œç§»åŠ¨çª—å£çš„æ–¹å¼ã€‚ç”±äºVANå¯¹äºŒç»´ç»“æ„ä¿¡æ¯éå¸¸å‹å¥½ï¼Œå…·æœ‰è¾ƒå¤§çš„æ„Ÿå—é‡ï¼Œå¹¶åœ¨é€šé“ç»´åº¦ä¸Šå®ç°äº†è‡ªé€‚åº”æ€§ï¼ŒVAN-Baseè¶…è¿‡Swin-T1.5%(82.8%vs.81.3%)ã€‚å¯¹äºMLPsï¼Œé€‰æ‹©gMLP[46]ã€‚VAN-Baseè¶…è¿‡gMLP-S[46]3.2%(82.8%vs.79.6%)ã€‚ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œåœ¨å°å‹æ¨¡å‹ä¸Šé¢VANçš„è¡¨ç°æ›´åŠ å‡ºè‰²ã€‚</p><h3 id="ç›®æ ‡æ£€æµ‹"><a href="#ç›®æ ‡æ£€æµ‹" class="headerlink" title="ç›®æ ‡æ£€æµ‹"></a>ç›®æ ‡æ£€æµ‹</h3><p><img src="v2-c04b7aef7af9212da50e947198ea0179_720w.webp" alt="img"></p><p><img src="v2-ac6fd9136c34fa6ebfce940f20b6a318_720w.webp" alt="img"></p><p><img src="v2-f0a76550ee33afe78ff4d4458f544c25_720w.webp" alt="img"></p><h3 id="è¯­ä¹‰åˆ†å‰²"><a href="#è¯­ä¹‰åˆ†å‰²" class="headerlink" title="è¯­ä¹‰åˆ†å‰²"></a>è¯­ä¹‰åˆ†å‰²</h3><p><img src="v2-5675289d453da40b8f33f28c1966aa44_720w.webp" alt="img"></p><h3 id="æ¶ˆèå®éªŒ"><a href="#æ¶ˆèå®éªŒ" class="headerlink" title="æ¶ˆèå®éªŒ"></a>æ¶ˆèå®éªŒ</h3><p><img src="v2-1f9970a60d196d053e6433e7bbcca814_720w.webp" alt="img"></p><p>DW-D-Convæä¾›äº†æ·±åº¦ç©ºæ´å·ç§¯ï¼Œè¿™åœ¨æ•è·LKAä¸­çš„é•¿ç¨‹ä¾èµ–æ€§ä¸­å‘æŒ¥äº†ä½œç”¨ã€‚</p><p>DW-Convå¯ä»¥åˆ©ç”¨å›¾åƒçš„å±€éƒ¨ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p><p>æ³¨æ„åŠ›æœºåˆ¶çš„å¼•å…¥å¯ä»¥çœ‹ä½œæ˜¯ä½¿ç½‘ç»œå®ç°äº†è‡ªé€‚åº”ç‰¹æ€§ã€‚å—ç›Šäºæ­¤ï¼ŒVAN-Tinyå®ç°äº†çº¦1.1%ï¼ˆ74.3%å¯¹75.4%ï¼‰çš„æ”¹å–„ã€‚</p><p>1Ã—1Convæ•è·äº†é€šé“ç»´åº¦ä¸­çš„å…³ç³»ã€‚ç»“åˆæ³¨æ„æœºåˆ¶ï¼Œå¼•å…¥äº†é€šé“ç»´åº¦çš„è‡ªé€‚åº”æ€§ã€‚æé«˜äº†0.8%(74.1%vs.75.4%)ï¼Œè¯æ˜äº†é€šé“ç»´åº¦è‡ªé€‚åº”æ€§çš„å¿…è¦æ€§ã€‚</p><h3 id="å¯è§†åŒ–"><a href="#å¯è§†åŒ–" class="headerlink" title="å¯è§†åŒ–"></a>å¯è§†åŒ–</h3><p><img src="v2-84a72be357178fade018043de0213190_720w.webp" alt="img"></p><p>å¯è§†åŒ–ç»“æœã€‚æ‰€æœ‰çš„å›¾åƒéƒ½æ¥è‡ªäºImageNetéªŒè¯é›†ä¸­çš„ä¸åŒç±»åˆ«ã€‚CAMé‡‡ç”¨VAN-Baseæ¨¡å‹å’ŒGrad-CAMäº§ç”Ÿã€‚å·¦ï¼šåŸå§‹å›¾åƒï¼Œå³ï¼šç±»æ¿€æ´»å›¾</p><p>ç»“æœæ˜¾ç¤ºï¼ŒVAN-Baseå¯ä»¥æ¸…æ™°åœ°èšç„¦äºç›®æ ‡å¯¹è±¡ã€‚å› æ­¤ï¼Œå¯è§†åŒ–ç›´è§‚åœ°è¯æ˜äº†VANçš„æœ‰æ•ˆæ€§ã€‚</p><p>â€</p><h1 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h1><blockquote id="fn_1"><sup>1</sup>. <a href="https://baidinghub.github.io/2020/04/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9F%A5%E8%AF%86%E7%B3%BB%E5%88%97%28%E4%BA%8C%29%20%E5%90%84%E7%A7%8D%E5%8D%B7%E7%A7%AF%E5%BD%A2%E5%BC%8F/">æ·±åº¦å­¦ä¹ çŸ¥è¯†ç³»åˆ—(äºŒ) å„ç§å·ç§¯å½¢å¼</a><a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a></blockquote><blockquote id="fn_2 "><sup>2 </sup>. <a href="https://zhuanlan.zhihu.com/p/474526444">ã€ARXIV2202ã€‘Visual Attention Network</a><a href="#reffn_2 " title="Jump back to footnote [2 ] in the text."> &#8617;</a></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡æ˜¯è®ºæ–‡ã€ŠVisual Attention Networkã€‹çš„å­¦ä¹ ç¬”è®°&lt;/p&gt;
&lt;p&gt;æˆ‘åœ¨è¯¥æ¨¡å‹ä¸Šæ‰§è¡Œä¸€ä¸ªåˆ†ç±»ä»»åŠ¡ï¼Œå‘ç°è¯¥æ¨¡å‹çš„æ•ˆæœè¦ä¼˜äºæˆ‘å®éªŒçš„å…¶ä»–æ¨¡å‹ï¼ˆåŒ…æ‹¬resnet50ã€densenet121ã€efficientNet-b0ã€swin-t</summary>
      
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://guoyujian.github.io/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="https://guoyujian.github.io/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="è®¡ç®—æœºè§†è§‰" scheme="https://guoyujian.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/"/>
    
  </entry>
  
  <entry>
    <title>Spring AOP Demo</title>
    <link href="https://guoyujian.github.io/2022/12/04/Spring-AOP-Demo/"/>
    <id>https://guoyujian.github.io/2022/12/04/Spring-AOP-Demo/</id>
    <published>2022-12-04T07:17:15.000Z</published>
    <updated>2022-12-04T07:21:08.814Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡ä¸æ¶‰åŠSpring AOPåŸç†</p></blockquote><h1 id="Spring-AOP-ç®€ä»‹"><a href="#Spring-AOP-ç®€ä»‹" class="headerlink" title="Spring AOP ç®€ä»‹"></a>Spring AOP ç®€ä»‹</h1><p>é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰æ˜¯ Spring æœ€ä¸ºé‡è¦çš„åŠŸèƒ½ä¹‹ä¸€äº†ï¼Œåœ¨æ•°æ®åº“äº‹åŠ¡ä¸­åˆ‡é¢ç¼–ç¨‹è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p><h2 id="AOP-å³-Aspect-Oriented-Program-é¢å‘åˆ‡é¢ç¼–ç¨‹"><a href="#AOP-å³-Aspect-Oriented-Program-é¢å‘åˆ‡é¢ç¼–ç¨‹" class="headerlink" title="AOP å³ Aspect Oriented Program é¢å‘åˆ‡é¢ç¼–ç¨‹"></a>AOP å³ Aspect Oriented Program é¢å‘åˆ‡é¢ç¼–ç¨‹</h2><p>é¦–å…ˆï¼Œåœ¨é¢å‘åˆ‡é¢ç¼–ç¨‹çš„æ€æƒ³é‡Œé¢ï¼ŒæŠŠåŠŸèƒ½åˆ†ä¸ºæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ï¼Œå’Œå‘¨è¾¹åŠŸèƒ½ã€‚</p><ul><li><strong>æ‰€è°“çš„æ ¸å¿ƒä¸šåŠ¡</strong>â€‹ï¼Œæ¯”å¦‚ç™»é™†ï¼Œå¢åŠ æ•°æ®ï¼Œåˆ é™¤æ•°æ®éƒ½å«æ ¸å¿ƒä¸šåŠ¡</li><li><strong>æ‰€è°“çš„å‘¨è¾¹åŠŸèƒ½</strong>â€‹ï¼Œæ¯”å¦‚æ€§èƒ½ç»Ÿè®¡ï¼Œæ—¥å¿—ï¼Œäº‹åŠ¡ç®¡ç†ç­‰ç­‰</li></ul><p>å‘¨è¾¹åŠŸèƒ½åœ¨ Spring çš„é¢å‘åˆ‡é¢ç¼–ç¨‹AOPæ€æƒ³é‡Œï¼Œå³è¢«å®šä¹‰ä¸ºåˆ‡é¢</p><p>åœ¨é¢å‘åˆ‡é¢ç¼–ç¨‹AOPçš„æ€æƒ³é‡Œé¢ï¼Œæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½å’Œåˆ‡é¢åŠŸèƒ½åˆ†åˆ«ç‹¬ç«‹è¿›è¡Œå¼€å‘ï¼Œç„¶åæŠŠåˆ‡é¢åŠŸèƒ½å’Œæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ â€œç¼–ç»‡â€ åœ¨ä¸€èµ·ï¼Œè¿™å°±å«AOP</p><h2 id="AOP-çš„ç›®çš„"><a href="#AOP-çš„ç›®çš„" class="headerlink" title="AOP çš„ç›®çš„"></a>AOP çš„ç›®çš„</h2><p>AOPèƒ½å¤Ÿå°†é‚£äº›ä¸ä¸šåŠ¡æ— å…³ï¼Œâ€‹<strong>å´ä¸ºä¸šåŠ¡æ¨¡å—æ‰€å…±åŒè°ƒç”¨çš„é€»è¾‘æˆ–è´£ä»»ï¼ˆä¾‹å¦‚äº‹åŠ¡å¤„ç†ã€æ—¥å¿—ç®¡ç†ã€æƒé™æ§åˆ¶ç­‰ï¼‰å°è£…èµ·æ¥</strong>â€‹ï¼Œä¾¿äºâ€‹<strong>å‡å°‘ç³»ç»Ÿçš„é‡å¤ä»£ç </strong>â€‹ï¼Œâ€‹<strong>é™ä½æ¨¡å—é—´çš„è€¦åˆåº¦</strong>â€‹ï¼Œå¹¶â€‹<strong>æœ‰åˆ©äºæœªæ¥çš„å¯æ‹“å±•æ€§å’Œå¯ç»´æŠ¤æ€§</strong>â€‹ã€‚</p><h2 id="AOP-å½“ä¸­çš„æ¦‚å¿µï¼š"><a href="#AOP-å½“ä¸­çš„æ¦‚å¿µï¼š" class="headerlink" title="AOP å½“ä¸­çš„æ¦‚å¿µï¼š"></a>AOP å½“ä¸­çš„æ¦‚å¿µï¼š</h2><ul><li>åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰<br>åœ¨å“ªäº›ç±»ï¼Œå“ªäº›æ–¹æ³•ä¸Šåˆ‡å…¥ï¼ˆâ€‹<strong>where</strong>â€‹ï¼‰</li><li>é€šçŸ¥ï¼ˆAdviceï¼‰<br>åœ¨æ–¹æ³•æ‰§è¡Œçš„ä»€ä¹ˆå®é™…ï¼ˆ<strong>when:</strong>æ–¹æ³•å‰/æ–¹æ³•å/æ–¹æ³•å‰åï¼‰åšä»€ä¹ˆï¼ˆ<strong>what:</strong>å¢å¼ºçš„åŠŸèƒ½ï¼‰</li><li>åˆ‡é¢ï¼ˆAspectï¼‰<br>åˆ‡é¢ = åˆ‡å…¥ç‚¹ + é€šçŸ¥ï¼Œé€šä¿—ç‚¹å°±æ˜¯ï¼š<strong>åœ¨ä»€ä¹ˆæ—¶æœºï¼Œä»€ä¹ˆåœ°æ–¹ï¼Œåšä»€ä¹ˆå¢å¼ºï¼</strong></li><li>ç»‡å…¥ï¼ˆWeavingï¼‰<br>æŠŠåˆ‡é¢åŠ å…¥åˆ°å¯¹è±¡ï¼Œå¹¶åˆ›å»ºå‡ºä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚ï¼ˆç”± Spring æ¥å®Œæˆï¼‰</li></ul><h1 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h1><h2 id="éœ€æ±‚è¯´æ˜"><a href="#éœ€æ±‚è¯´æ˜" class="headerlink" title="éœ€æ±‚è¯´æ˜"></a>éœ€æ±‚è¯´æ˜</h2><p>ä¸ºäº†æ›´å¥½çš„è¯´æ˜ AOP çš„æ¦‚å¿µï¼Œæˆ‘ä»¬æ¥ä¸¾ä¸€ä¸ªå®é™…ä¸­çš„ä¾‹å­æ¥è¯´æ˜ï¼š</p><p><img src="image-20221204123653-p1e00ow.png" alt="image">â€‹</p><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒåŒ…ç§Ÿå©†çš„æ ¸å¿ƒä¸šåŠ¡å°±æ˜¯ç­¾åˆåŒï¼Œæ”¶æˆ¿ç§Ÿï¼Œé‚£ä¹ˆè¿™å°±å¤Ÿäº†ï¼Œç°è‰²æ¡†èµ·æ¥çš„éƒ¨åˆ†éƒ½æ˜¯é‡å¤ä¸”è¾¹ç¼˜çš„äº‹ï¼Œäº¤ç»™ä¸­ä»‹å•†å°±å¥½äº†ï¼Œè¿™å°±æ˜¯ <strong>AOP çš„ä¸€ä¸ªæ€æƒ³ï¼šè®©å…³æ³¨ç‚¹ä»£ç ä¸ä¸šåŠ¡ä»£ç åˆ†ç¦»ï¼</strong></p><h2 id="ä»£ç å®ç°ï¼ˆä½¿ç”¨æ³¨è§£ï¼‰"><a href="#ä»£ç å®ç°ï¼ˆä½¿ç”¨æ³¨è§£ï¼‰" class="headerlink" title="ä»£ç å®ç°ï¼ˆä½¿ç”¨æ³¨è§£ï¼‰"></a>ä»£ç å®ç°ï¼ˆä½¿ç”¨æ³¨è§£ï¼‰</h2><h3 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h3><p>Spring Bootä½¿ç”¨AOPéœ€è¦æ·»åŠ spring-boot-starter-aopä¾èµ–ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸éœ€è¦å†æ·»åŠ aspectjweaverçš„ä¾èµ–äº†ï¼Œå› ä¸ºspring-boot-starter-aopåŒ…å«äº†aspectjweaverï¼Œå¹¶ä¸”ç‰ˆæœ¬æ˜¯è¾ƒæ–°çš„ç‰ˆæœ¬ï¼Œå¦‚æœåœ¨æ·»åŠ è€ç‰ˆæœ¬ï¼ˆå¦‚1.5.4ï¼‰å¯åŠ¨ä¼šæŠ¥é”™ã€‚</p><h3 id="ç¼–å†™æ ¸å¿ƒä¸šåŠ¡Bean"><a href="#ç¼–å†™æ ¸å¿ƒä¸šåŠ¡Bean" class="headerlink" title="ç¼–å†™æ ¸å¿ƒä¸šåŠ¡Bean"></a>ç¼–å†™æ ¸å¿ƒä¸šåŠ¡Bean</h3><p>ä¹Ÿå°±æ˜¯è¿æ¥ç‚¹</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.test_spring.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LandlordService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ¿ä¸œï¼šè°ˆåˆåŒ&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ¿ä¸œï¼šæ”¶æˆ¿ç§Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºåˆ‡é¢"><a href="#åˆ›å»ºåˆ‡é¢" class="headerlink" title="åˆ›å»ºåˆ‡é¢"></a>åˆ›å»ºåˆ‡é¢</h3><p>Springé‡‡ç”¨@AspectJæ³¨è§£å¯¹POJOè¿›è¡Œæ ‡æ³¨ï¼Œè¯¥æ³¨è§£è¡¨æ˜è¯¥ç±»ä¸ä»…ä»…æ˜¯ä¸€ä¸ªPOJOï¼Œè¿˜æ˜¯ä¸€ä¸ªåˆ‡é¢ã€‚åˆ‡é¢æ˜¯åˆ‡ç‚¹å’Œé€šçŸ¥çš„ç»“åˆï¼Œé‚£ä¹ˆå®šä¹‰ä¸€ä¸ªåˆ‡é¢å°±éœ€è¦ç¼–å†™åˆ‡ç‚¹å’Œé€šçŸ¥ã€‚åœ¨ä»£ç ä¸­ï¼Œåªéœ€è¦æ·»åŠ @Aspectæ³¨è§£å³å¯ã€‚</p><h3 id="å®šä¹‰åˆ‡ç‚¹"><a href="#å®šä¹‰åˆ‡ç‚¹" class="headerlink" title="å®šä¹‰åˆ‡ç‚¹"></a>å®šä¹‰åˆ‡ç‚¹</h3><p>åˆ‡ç‚¹æ˜¯é€šè¿‡<strong>@Pointcut</strong>æ³¨è§£å’Œåˆ‡ç‚¹è¡¨è¾¾å¼å®šä¹‰çš„ã€‚</p><p>@Pointcutæ³¨è§£å¯ä»¥åœ¨ä¸€ä¸ªåˆ‡é¢å†…å®šä¹‰<strong>å¯é‡ç”¨</strong>çš„åˆ‡ç‚¹ã€‚</p><p>ç”±äºSpringåˆ‡é¢ç²’åº¦æœ€å°æ˜¯è¾¾åˆ°æ–¹æ³•çº§åˆ«ï¼Œè€Œexecutionè¡¨è¾¾å¼å¯ä»¥ç”¨äºæ˜ç¡®æŒ‡å®šæ–¹æ³•è¿”å›ç±»å‹ï¼Œç±»åï¼Œæ–¹æ³•åå’Œå‚æ•°åç­‰ä¸æ–¹æ³•ç›¸å…³çš„éƒ¨ä»¶ï¼Œå¹¶ä¸”å®é™…ä¸­ï¼Œå¤§éƒ¨åˆ†éœ€è¦ä½¿ç”¨AOPçš„ä¸šåŠ¡åœºæ™¯ä¹Ÿåªéœ€è¦è¾¾åˆ°æ–¹æ³•çº§åˆ«å³å¯ï¼Œå› è€Œexecutionè¡¨è¾¾å¼çš„ä½¿ç”¨æ˜¯æœ€ä¸ºå¹¿æ³›çš„ã€‚å¦‚å›¾æ˜¯executionè¡¨è¾¾å¼çš„è¯­æ³•ï¼š</p><p>executionè¡¨ç¤ºåœ¨æ–¹æ³•æ‰§è¡Œçš„æ—¶å€™è§¦å‘ã€‚ä»¥â€œâ€‹<em>â€å¼€å¤´ï¼Œè¡¨æ˜æ–¹æ³•è¿”å›å€¼ç±»å‹ä¸ºä»»æ„ç±»å‹ã€‚ç„¶åæ˜¯å…¨é™å®šçš„ç±»åå’Œæ–¹æ³•åï¼Œâ€œ</em>â€‹â€å¯ä»¥è¡¨ç¤ºä»»æ„ç±»å’Œä»»æ„æ–¹æ³•ã€‚å¯¹äºæ–¹æ³•å‚æ•°åˆ—è¡¨ï¼Œå¯ä»¥ä½¿ç”¨â€œ..â€è¡¨ç¤ºå‚æ•°ä¸ºä»»æ„ç±»å‹ã€‚å¦‚æœéœ€è¦å¤šä¸ªè¡¨è¾¾å¼ï¼Œå¯ä»¥ä½¿ç”¨â€œ&amp;&amp;â€ã€â€œ||â€å’Œâ€œ!â€å®Œæˆä¸ã€æˆ–ã€éçš„æ“ä½œã€‚</p><p><img src="image-20221204150048-bd0mj1f.png" alt="image">â€‹</p><h3 id="å®šä¹‰é€šçŸ¥"><a href="#å®šä¹‰é€šçŸ¥" class="headerlink" title="å®šä¹‰é€šçŸ¥"></a>å®šä¹‰é€šçŸ¥</h3><blockquote><p>é€šçŸ¥æœ‰äº”ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><p>å‰ç½®é€šçŸ¥ï¼ˆ@Beforeï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•è°ƒç”¨ä¹‹å‰è°ƒç”¨é€šçŸ¥</p><p>åç½®é€šçŸ¥ï¼ˆ@Afterï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•å®Œæˆä¹‹åè°ƒç”¨é€šçŸ¥</p><p>ç¯ç»•é€šçŸ¥ï¼ˆ@Aroundï¼‰ï¼šåœ¨è¢«é€šçŸ¥çš„æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åæ‰§è¡Œè‡ªå®šä¹‰çš„æ–¹æ³•</p><p>è¿”å›é€šçŸ¥ï¼ˆ@AfterReturningï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åè°ƒç”¨é€šçŸ¥</p><p>å¼‚å¸¸é€šçŸ¥ï¼ˆ@AfterThrowingï¼‰ï¼šåœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ä¹‹åè°ƒç”¨é€šçŸ¥</p></blockquote><p>æœ¬ä¾‹ä¸­ï¼Œåˆ†åˆ«ä½¿ç”¨å‰ç½®é€šçŸ¥å®ç°â€œçœ‹æˆ¿â€å’Œâ€œè°ˆä»·æ ¼â€åŠŸèƒ½ï¼Œä½¿ç”¨åç½®é€šçŸ¥å®ç°â€œäº¤é’¥åŒ™â€åŠŸèƒ½ã€‚è¿™æ ·ä¸€ä¸ªåˆ‡é¢å°±å®šä¹‰å®Œæˆï¼Œä¸‹é¢æ˜¯ä»£ç </p><h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.test_spring.aspect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Broker</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.example.test_spring.service.LandlordService.rent())&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointCut</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;pointCut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeRent</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸­é—´å•†ï¼šå¸¦ç§Ÿå®¢çœ‹æˆ¿&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸­é—´å•†ï¼šè°ˆä»·æ ¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;pointCut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterRent</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸­é—´å•†ï¼šäº¤é’¥åŒ™&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSpringApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(TestSpringApplication.class, args);</span><br><span class="line">        <span class="type">LandlordService</span> <span class="variable">bean</span> <span class="operator">=</span> context.getBean(LandlordService.class);</span><br><span class="line">        bean.rent();</span><br><span class="line">        System.exit(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="image-20221204150759-y1b4f1u.png" alt="image">â€‹</p><h2 id="ç¯ç»•é€šçŸ¥"><a href="#ç¯ç»•é€šçŸ¥" class="headerlink" title="ç¯ç»•é€šçŸ¥"></a>ç¯ç»•é€šçŸ¥</h2><p>çœ‹åˆ°ä¸Šè¿°çš„éœ€æ±‚ä¹Ÿå¯ä»¥ä½¿ç”¨ç¯ç»•é€šçŸ¥ï¼Œä»–ä¼šåœ¨æ–¹æ³•æ‰§è¡Œå‰åæ‰§è¡Œã€‚</p><p>æ”¹å†™<code>Broker.java</code>â€‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.test_spring.aspect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Broker</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.example.test_spring.service.LandlordService.rent())&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointCut</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Before(&quot;pointCut()&quot;)</span></span><br><span class="line"><span class="comment">//    public void beforeRent() &#123;</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;ä¸­é—´å•†ï¼šå¸¦ç§Ÿå®¢çœ‹æˆ¿&quot;);</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;ä¸­é—´å•†ï¼šè°ˆä»·æ ¼&quot;);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    @After(&quot;pointCut()&quot;)</span></span><br><span class="line"><span class="comment">//    public void afterRent() &#123;</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;ä¸­é—´å•†ï¼šäº¤é’¥åŒ™&quot;);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;pointCut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundRent</span><span class="params">(ProceedingJoinPoint point)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸­é—´å•†ï¼šå¸¦ç§Ÿå®¢çœ‹æˆ¿&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸­é—´å•†ï¼šè°ˆä»·æ ¼&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            point.proceed();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            throwable.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸­é—´å•†ï¼šäº¤é’¥åŒ™&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œæµ‹è¯•ä»£ç ï¼Œç»“æœä¾ç„¶æ­£ç¡®</p><h1 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h1><ol><li><a href="https://www.jianshu.com/p/994027425b44">Spring(4)â€”â€”é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPæ¨¡å—ï¼‰</a></li><li><a href="https://www.cnblogs.com/sgh1023/p/13363679.html">Spring Bootä½¿ç”¨AOPçš„æ­£ç¡®å§¿åŠ¿</a>â€‹</li></ol><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡ä¸æ¶‰åŠSpring AOPåŸç†&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;Spring-AOP-ç®€ä»‹&quot;&gt;&lt;a href=&quot;#Spring-AOP-ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;Spring AOP ç®€ä»‹&quot;</summary>
      
    
    
    
    <category term="Java" scheme="https://guoyujian.github.io/categories/Java/"/>
    
    <category term="Spring" scheme="https://guoyujian.github.io/categories/Java/Spring/"/>
    
    
    <category term="Java" scheme="https://guoyujian.github.io/tags/Java/"/>
    
    <category term="Spring" scheme="https://guoyujian.github.io/tags/Spring/"/>
    
    <category term="é¢å‘åˆ‡é¢ç¼–ç¨‹" scheme="https://guoyujian.github.io/tags/%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/"/>
    
    <category term="AOP" scheme="https://guoyujian.github.io/tags/AOP/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨dockeréƒ¨ç½²rediså¹¶å®ç°å¤–éƒ¨è®¿é—®</title>
    <link href="https://guoyujian.github.io/2022/11/23/%E4%BD%BF%E7%94%A8docker%E9%83%A8%E7%BD%B2redis%E5%B9%B6%E5%AE%9E%E7%8E%B0%E5%A4%96%E9%83%A8%E8%AE%BF%E9%97%AE/"/>
    <id>https://guoyujian.github.io/2022/11/23/%E4%BD%BF%E7%94%A8docker%E9%83%A8%E7%BD%B2redis%E5%B9%B6%E5%AE%9E%E7%8E%B0%E5%A4%96%E9%83%A8%E8%AE%BF%E9%97%AE/</id>
    <published>2022-11-23T14:13:11.000Z</published>
    <updated>2022-11-23T14:26:33.656Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å®‰è£…ä¹‹å‰ç¯å¢ƒéƒ¨ç½²"><a href="#å®‰è£…ä¹‹å‰ç¯å¢ƒéƒ¨ç½²" class="headerlink" title="å®‰è£…ä¹‹å‰ç¯å¢ƒéƒ¨ç½²"></a>å®‰è£…ä¹‹å‰ç¯å¢ƒéƒ¨ç½²</h1><p>å…³é—­linuxé˜²ç«å¢™</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">systemctl stop firewalld</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯äº‘æœåŠ¡å™¨ï¼ŒåŠ¡å¿…è¿›å…¥äº‘æœåŠ¡å™¨,ç»™6379ç«¯å£æ”¾è¡Œ</p><h1 id="å®‰è£…éƒ¨ç½²"><a href="#å®‰è£…éƒ¨ç½²" class="headerlink" title="å®‰è£…éƒ¨ç½²"></a>å®‰è£…éƒ¨ç½²</h1><h2 id="æ‹‰å–é•œåƒ"><a href="#æ‹‰å–é•œåƒ" class="headerlink" title="æ‹‰å–é•œåƒ"></a>æ‹‰å–é•œåƒ</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker pull redis:latest</span><br></pre></td></tr></table></figure><h2 id="ä»å®˜ç½‘ä¸‹è½½redisé…ç½®æ–‡ä»¶"><a href="#ä»å®˜ç½‘ä¸‹è½½redisé…ç½®æ–‡ä»¶" class="headerlink" title="ä»å®˜ç½‘ä¸‹è½½redisé…ç½®æ–‡ä»¶"></a>ä»å®˜ç½‘ä¸‹è½½redisé…ç½®æ–‡ä»¶</h2><p><code>wget http://download.redis.io/redis-stable/redis.conf</code></p><h2 id="åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨äºä¿å­˜æ­¤æ–‡ä»¶"><a href="#åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨äºä¿å­˜æ­¤æ–‡ä»¶" class="headerlink" title="åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨äºä¿å­˜æ­¤æ–‡ä»¶"></a>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨äºä¿å­˜æ­¤æ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /root/redis</span><br><span class="line"><span class="built_in">mv</span> /root/redis.conf  /root/redis</span><br></pre></td></tr></table></figure><h2 id="æ›´æ”¹redis-confçš„é…ç½®"><a href="#æ›´æ”¹redis-confçš„é…ç½®" class="headerlink" title="æ›´æ”¹redis.confçš„é…ç½®"></a>æ›´æ”¹redis.confçš„é…ç½®</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /root/redis/redis.conf</span><br></pre></td></tr></table></figure><p>å°†redis.confæ–‡ä»¶ä¸‹åˆ—å‚æ•°æ›´æ”¹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#bind 127.0.0.1 #å…è®¸è¿œç¨‹è¿æ¥(æ³¨é‡Šæˆ–è€…æ”¹ä¸ºbind 0.0.0.0) </span></span><br><span class="line">protected-mode no    <span class="comment">#ä¿æŠ¤æ¨¡å¼</span></span><br><span class="line">appendonly <span class="built_in">yes</span> <span class="comment">#æŒä¹…åŒ–</span></span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨å®¹å™¨"><a href="#å¯åŠ¨å®¹å™¨" class="headerlink" title="å¯åŠ¨å®¹å™¨"></a>å¯åŠ¨å®¹å™¨</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -p 6379:6379 --name redis -v /root/redis/redis.conf:/etc/redis/redis.conf -v /root/redis/data:/data -d redis redis-server /etc/redis/redis.conf </span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜:</p><ul><li>-p 6379:6379ï¼šæŠŠå®¹å™¨å†…çš„6379ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœº6379ç«¯å£</li><li>â€“name redisï¼šè®¾ç½®å®¹å™¨åç§°ä¸ºredis</li><li>-v /root/redis/redis.conf:/etc/redis/redis.confï¼šæŠŠä¸»æœºé…ç½®å¥½çš„redis.confæ”¾åˆ°å®¹å™¨å†…çš„è¿™ä¸ªä½ç½®ä¸­</li><li>-v /root/redis/data:/dataï¼šæŠŠredisæŒä¹…åŒ–çš„æ•°æ®åœ¨å®¿ä¸»æœºå†…æ˜¾ç¤ºï¼Œåšæ•°æ®å¤‡ä»½</li><li>-dï¼šredisåå°è¿è¡Œ</li><li>redis-server /etc/redis/redis.confï¼šè¿™ä¸ªæ˜¯å…³é”®é…ç½®ï¼Œè®©redisä¸æ˜¯æ— é…ç½®å¯åŠ¨ï¼Œè€Œæ˜¯æŒ‰ç…§è¿™ä¸ªredis.confçš„é…ç½®å¯åŠ¨</li></ul><h2 id="å®Œæˆæµ‹è¯•"><a href="#å®Œæˆæµ‹è¯•" class="headerlink" title="å®Œæˆæµ‹è¯•"></a>å®Œæˆæµ‹è¯•</h2><p>æŸ¥çœ‹å®¹å™¨æ˜¯å¦å¯åŠ¨ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><p>è¿›å…¥å®¹å™¨ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥å¯åŠ¨redis-cli</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@Met-Guo:~<span class="comment"># docker exec -it 56 bash # 56ä¸ºå®¹å™¨id</span></span><br><span class="line">root@5601af5f1f67:/data<span class="comment"># redis-cli</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name 50</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line"><span class="string">&quot;50&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exit</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨å®¿ä¸»æœºå®‰è£…Redis Desktop Managerå®¢æˆ·ç«¯ï¼Œå¹¶é…ç½®</p><p><img src="image-20221123222544338.png" alt="æˆªå›¾"></p><p>æˆåŠŸã€‚</p><h1 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h1><ol><li><a href="https://blog.csdn.net/weixin_46186045/article/details/117387772">docker éƒ¨ç½²rediså¤–éƒ¨è®¿é—®è¯¥æ³¨æ„çš„åœ°æ–¹ä½ éƒ½çŸ¥é“å—</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å®‰è£…ä¹‹å‰ç¯å¢ƒéƒ¨ç½²&quot;&gt;&lt;a href=&quot;#å®‰è£…ä¹‹å‰ç¯å¢ƒéƒ¨ç½²&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£…ä¹‹å‰ç¯å¢ƒéƒ¨ç½²&quot;&gt;&lt;/a&gt;å®‰è£…ä¹‹å‰ç¯å¢ƒéƒ¨ç½²&lt;/h1&gt;&lt;p&gt;å…³é—­linuxé˜²ç«å¢™&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;</summary>
      
    
    
    
    <category term="redis" scheme="https://guoyujian.github.io/categories/redis/"/>
    
    
    <category term="rediså®‰è£…" scheme="https://guoyujian.github.io/tags/redis%E5%AE%89%E8%A3%85/"/>
    
    <category term="docker" scheme="https://guoyujian.github.io/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>SSHä¸‰æ­¥è§£å†³å…å¯†ç™»å½•</title>
    <link href="https://guoyujian.github.io/2022/11/07/SSH%E4%B8%89%E6%AD%A5%E8%A7%A3%E5%86%B3%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95/"/>
    <id>https://guoyujian.github.io/2022/11/07/SSH%E4%B8%89%E6%AD%A5%E8%A7%A3%E5%86%B3%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95/</id>
    <published>2022-11-07T14:29:07.000Z</published>
    <updated>2022-11-07T14:33:39.446Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h1><ol><li><a href="https://blog.csdn.net/jeikerxiao/article/details/84105529">SSH ä¸‰æ­¥è§£å†³å…å¯†ç™»å½•</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Refs&quot;&gt;&lt;a href=&quot;#Refs&quot; class=&quot;headerlink&quot; title=&quot;Refs&quot;&gt;&lt;/a&gt;Refs&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/jeikerxiao/article/detail</summary>
      
    
    
    
    <category term="Linux" scheme="https://guoyujian.github.io/categories/Linux/"/>
    
    <category term="å¼€å‘å·¥å…·" scheme="https://guoyujian.github.io/categories/Linux/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="å¼€å‘å·¥å…·" scheme="https://guoyujian.github.io/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>FATEä½¿ç”¨é‡åˆ°çš„é—®é¢˜æ±‡æ€»</title>
    <link href="https://guoyujian.github.io/2022/11/04/FATE%E4%BD%BF%E7%94%A8%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/"/>
    <id>https://guoyujian.github.io/2022/11/04/FATE%E4%BD%BF%E7%94%A8%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/</id>
    <published>2022-11-03T16:11:41.000Z</published>
    <updated>2022-11-03T16:13:55.018Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡æ±‡æ€»åœ¨ä½¿ç”¨å’Œå¼€å‘FATEæ—¶é‡åˆ°çš„å„ç±»é—®é¢˜ï¼Œä»¥åŠç»™å‡ºå¯èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚</p><h1 id="flow-init"><a href="#flow-init" class="headerlink" title="flow init"></a>flow init</h1><h2 id="é—®é¢˜çŠ¶æ€"><a href="#é—®é¢˜çŠ¶æ€" class="headerlink" title="é—®é¢˜çŠ¶æ€"></a>é—®é¢˜çŠ¶æ€</h2><p>å·²è§£å†³</p><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>é¦–æ¬¡è¿›å…¥fate-clientæ—¶ï¼Œæç¤ºéœ€è¦æ‰§è¡Œflow initï¼Œå¦åˆ™æœ‰å…³flowçš„å‘½ä»¤éƒ½æ‰§è¡Œä¸äº†ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p><code>flow init --ip &lt;dockerå®¹å™¨å®¿ä¸»æœºip&gt; --port 9380</code></p><p>â€</p><h1 id="ModuleNotFoundError-No-module-named-â€˜-lzmaâ€™"><a href="#ModuleNotFoundError-No-module-named-â€˜-lzmaâ€™" class="headerlink" title="ModuleNotFoundError: No module named â€˜_lzmaâ€™"></a>ModuleNotFoundError: No module named â€˜_lzmaâ€™</h1><h2 id="é—®é¢˜æè¿°-1"><a href="#é—®é¢˜æè¿°-1" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œnnæ¨¡å—æŠ¥é”™ï¼šModuleNotFoundError: No module named â€˜_lzmaâ€™</p><p><img src="image-20220927210914-c8pbaiz.png" alt="image.png"></p><h2 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>åœ¨fate-flow containerå®‰è£…ç›¸å…³çš„åŒ…å³å¯ï¼ˆguestã€hostå’Œarbiteréƒ½è¦å®‰è£…ï¼‰ã€‚å®‰è£…æ•™ç¨‹ï¼š<a href="https://github.com/ultralytics/yolov5/issues/1298">https://github.com/ultralytics/yolov5/issues/1298</a></p><p>è¿™é‡Œéœ€è¦ä¿®æ”¹è·¯å¾„</p><p><img src="image-20220928115429-n9l4hgw.png" alt="image.png"></p><h1 id="æ‰¾ä¸åˆ°æ–‡ä»¶ï¼šNo-such-file-or-directory-â€˜-data-projects-fate-work-mnist-fed-mnist-train-part2-config-yamlâ€™"><a href="#æ‰¾ä¸åˆ°æ–‡ä»¶ï¼šNo-such-file-or-directory-â€˜-data-projects-fate-work-mnist-fed-mnist-train-part2-config-yamlâ€™" class="headerlink" title="æ‰¾ä¸åˆ°æ–‡ä»¶ï¼šNo such file or directory: â€˜/data/projects/fate/work/mnist_fed/mnist_train_part2/config.yamlâ€™"></a>æ‰¾ä¸åˆ°æ–‡ä»¶ï¼š<strong>No such file or directory: â€˜/data/projects/fate/work/mnist_fed/mnist_train_part2/config.yamlâ€™</strong></h1><h2 id="é—®é¢˜çŠ¶æ€-1"><a href="#é—®é¢˜çŠ¶æ€-1" class="headerlink" title="é—®é¢˜çŠ¶æ€"></a>é—®é¢˜çŠ¶æ€</h2><p>å·²è§£å†³</p><h2 id="é—®é¢˜æè¿°-2"><a href="#é—®é¢˜æè¿°-2" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>åœ¨æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œreaderç»„ä»¶æŠ¥é”™ï¼š</p><p><img src="image-20220927205925-34fvaot.png" alt="image.png"></p><p>è¿™æ˜¯ç”±äºæˆ‘æŠŠæ•°æ®ä¿å­˜åœ¨äº†fate-clientï¼Œè€Œfateè¯»å–æ•°æ®æ˜¯åœ¨fate-flow containerå¯¼è‡´çš„ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ-2"><a href="#è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>ç”±äºfate-clientå’Œfate-flowä¸¤ä¸ªå®¹å™¨ä¸­çš„examplesæ–‡ä»¶å¤¹æŒ‚è½½åˆ°dockeråº•å±‚åŒä¸€å¤„å­˜å‚¨ã€‚æ‰€ä»¥æŠŠæ•°æ®æ”¾åˆ°examplesä¸‹ï¼ŒæŠŠé…ç½®ä¿®æ”¹ä¸ºæ–°çš„æ–‡ä»¶è·¯å¾„å³å¯ã€‚</p><h1 id="å¼€å‘æ–°çš„FATE-FLOW-API"><a href="#å¼€å‘æ–°çš„FATE-FLOW-API" class="headerlink" title="å¼€å‘æ–°çš„FATE-FLOW API"></a>å¼€å‘æ–°çš„FATE-FLOW API</h1><p>è¿™é‡Œæ˜¯å·²æœ‰çš„APIï¼š<a href="https://federatedai.github.io/FATE-Flow/latest/zh/swagger/">https://federatedai.github.io/FATE-Flow/latest/zh/swagger/</a></p><p>FATEçš„HTTPæ¥å£éƒ½æ˜¯åŸºäºflaskæ¡†æ¶ç¼–å†™çš„ã€‚</p><p>å¼€å‘æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>è¿›å…¥FATE-FLOWå®¹å™¨</li><li>cd /data/projects/fate/fateflow/python/fate_flow/apps</li><li>æ–°å»ºpythonæ–‡ä»¶ï¼Œå‘½åä¸ºxxx_app.pyï¼Œç¼–å†™æ–°çš„æ¥å£ã€‚</li><li>é‡å¯FLOWå®¹å™¨</li></ol><h1 id="ä¿®æ”¹ä»£ç å¯¼è‡´docker-containeræ²¡èµ·æ¥"><a href="#ä¿®æ”¹ä»£ç å¯¼è‡´docker-containeræ²¡èµ·æ¥" class="headerlink" title="ä¿®æ”¹ä»£ç å¯¼è‡´docker containeræ²¡èµ·æ¥"></a>ä¿®æ”¹ä»£ç å¯¼è‡´docker containeræ²¡èµ·æ¥</h1><p>ä¿®æ”¹FATE-FLOWçš„ä»£ç åï¼Œç”±äºä»£ç æœ‰bugï¼Œå¯¼è‡´å®¹å™¨èµ·ä¸æ¥ï¼Œåˆå¯¼è‡´ä¸èƒ½è¿›å…¥å®¹å™¨ä¿®æ”¹ä»£ç çš„æ­»å¾ªç¯ï¼Œæ€ä¹ˆåŠï¼Ÿ</p><p>æŸ¥çœ‹dockerå®¹å™¨çš„å¯åŠ¨æ—¥å¿—ï¼Œç¡®å®šå‡ºé”™çš„ä»£ç ï¼Œdocker cpæ‹·è´å‡ºæ¥éœ€è¦ä¿®æ”¹çš„ä»£ç ï¼Œå†æ‹·è´å›å»ã€‚</p><p>â€</p><h1 id="å®é™…è®­ç»ƒçš„epochå°äºé…ç½®çš„max-iter"><a href="#å®é™…è®­ç»ƒçš„epochå°äºé…ç½®çš„max-iter" class="headerlink" title="å®é™…è®­ç»ƒçš„epochå°äºé…ç½®çš„max_iter"></a>å®é™…è®­ç»ƒçš„epochå°äºé…ç½®çš„max_iter</h1><p>æŸ¥çœ‹è‡ªå·±æ˜¯å¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®äº†ï¼š</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;early_stop&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;early_stop&quot;</span><span class="punctuation">:</span> <span class="string">&quot;diff&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eps&quot;</span><span class="punctuation">:</span> <span class="number">0.0001</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„æ„æ€æ˜¯ï¼Œå¦‚æœä¸¤ä¸ªepochå¾—åˆ°çš„lossä¹‹å·®å°äº0.0001æ—¶åˆ™åœæ­¢è®­ç»ƒã€‚</p><h1 id="memory-error"><a href="#memory-error" class="headerlink" title="memory error"></a>memory error</h1><p>æ ¹æ®å®è·µç»éªŒï¼Œmemory error è¿˜æœ‰dataloader worker pidä¹‹ç±»çš„é”™è¯¯ï¼Œå‡æ˜¯ç”±äºå†…å­˜ä¸å¤Ÿå¼•èµ·çš„ã€‚è°ƒå°batch sizeï¼Œæˆ–è€…å¢åŠ ç¡¬ä»¶é…ç½®</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬æ–‡æ±‡æ€»åœ¨ä½¿ç”¨å’Œå¼€å‘FATEæ—¶é‡åˆ°çš„å„ç±»é—®é¢˜ï¼Œä»¥åŠç»™å‡ºå¯èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h1 id=&quot;flow-init&quot;&gt;&lt;a href=&quot;#flow-init&quot; class=&quot;headerlink&quot; title=&quot;flow init&quot;&gt;&lt;/a&gt;flow init&lt;/h1&gt;&lt;h</summary>
      
    
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/categories/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/tags/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>FATEæ¨ªå‘è”é‚¦å­¦ä¹ ï¼šè‚ºç‚çš„å¤šæ¨¡æ€ä»»åŠ¡çš„è”é‚¦å­¦ä¹ </title>
    <link href="https://guoyujian.github.io/2022/11/04/FATE%E6%A8%AA%E5%90%91%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%EF%BC%9A%E8%82%BA%E7%82%8E%E7%9A%84%E5%A4%9A%E6%A8%A1%E6%80%81%E4%BB%BB%E5%8A%A1%E7%9A%84%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    <id>https://guoyujian.github.io/2022/11/04/FATE%E6%A8%AA%E5%90%91%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%EF%BC%9A%E8%82%BA%E7%82%8E%E7%9A%84%E5%A4%9A%E6%A8%A1%E6%80%81%E4%BB%BB%E5%8A%A1%E7%9A%84%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/</id>
    <published>2022-11-03T16:10:23.000Z</published>
    <updated>2022-11-03T16:11:17.397Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å¤šæ¨¡æ€æœ€è¿‘æ¯”è¾ƒç«</p><p>å¤šæ¨¡æ€ä»»åŠ¡çš„inputå’Œç®—æ³•FATEä¸æ”¯æŒï¼Œå› æ­¤éœ€è¦å¼€å‘æ–°çš„dataloaderå’Œç®—æ³•ç»„ä»¶ã€‚</p><p>æœ¬ç¯‡å°±ä»¥è‚ºç‚å¤šæ¨¡æ€ä»»åŠ¡ä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•å¼€å‘æ–°çš„FATEæœºå™¨å­¦ä¹ ç»„ä»¶</p><p>å®˜æ–¹æ–‡æ¡£åœ¨è¿™é‡Œï¼š<a href="https://fate.readthedocs.io/en/latest/develop/develop_guide/#develop-an-algorithm-component-of-fate">https://fate.readthedocs.io/en/latest/develop/develop_guide/#develop-an-algorithm-component-of-fate</a></p></blockquote><h1 id="baseline"><a href="#baseline" class="headerlink" title="baseline"></a>baseline</h1><p>æœ¬ä»»åŠ¡å°†å¼€å‘åŸºäºè‚ºéƒ¨Xå…‰å›¾åƒå’Œæè¿°æ–‡å­—æ­£ç¡®åˆ¤æ–­æ˜¯å¦æ‚£æœ‰è‚ºç‚çš„äºŒåˆ†ç±»ç®—æ³•ã€‚</p><p>æ•°æ®é›†è¾“å…¥ç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚ä¸€éƒ¨åˆ†ä¸ºè‚ºéƒ¨Xå…‰æ‰«æå›¾åƒï¼Œå¦ä¸€éƒ¨åˆ†ä¸ºå¯¹å›¾åƒçš„æè¿°æ–‡å­—ã€‚æ•°æ®æ ‡ç­¾åˆ†ä¸º0å’Œ1ï¼Œåˆ†åˆ«å¯¹åº”æ­£å¸¸å’Œæ‚£æœ‰è‚ºç‚ä¸¤ç±»æ ‡ç­¾ã€‚</p><h2 id="æœ¬åœ°ä»£ç å¤ç°"><a href="#æœ¬åœ°ä»£ç å¤ç°" class="headerlink" title="æœ¬åœ°ä»£ç å¤ç°"></a>æœ¬åœ°ä»£ç å¤ç°</h2><ol><li>baseline ä»£ç åœ¨è¿™é‡Œï¼š<a href="https://github.com/AxelAllen/Multimodal-BERT-in-Medical-Image-and-Text-Classification">https://github.com/AxelAllen/Multimodal-BERT-in-Medical-Image-and-Text-Classification</a></li><li>å°†å…¶cloneåˆ°æœ¬åœ°ï¼ŒæŒ‰ç…§README.mdçš„æç¤ºï¼Œå°†NLMCXR_png_frontalå›¾åƒæ–‡ä»¶å¤¹æ”¾åˆ°dataç›®å½•ä¸‹ã€‚æ‰§è¡Œdata/preparations.ipynbç”Ÿæˆå…ƒæ•°æ®ã€‚</li><li>æ‰§è¡Œrun_mmbt.ipynb</li><li>æ‰§è¡Œå®Œæ¯•åï¼Œä¼šåœ¨æ ¹ç›®å½•ä¸‹ç”Ÿæˆmmbt_output_findings_10epochs_næ–‡ä»¶å¤¹ï¼Œé‡Œé¢ä¿å­˜æœ‰æ¨¡å‹æ‹Ÿåˆåçš„æ¢¯åº¦å’Œè¯„ä¼°ç»“æœã€‚</li></ol><h2 id="é˜…è¯»ä»£ç "><a href="#é˜…è¯»ä»£ç " class="headerlink" title="é˜…è¯»ä»£ç "></a>é˜…è¯»ä»£ç </h2><p>è¿™é‡Œè¦å¼„æ¸…æ¥šä»£ç çš„æ•´å¥—æµç¨‹ï¼Œä¸»è¦æ˜¯è¶…å‚ã€ä½¿ç”¨çš„ç®—æ³•ã€è®­ç»ƒã€æ•°æ®å¤„ç†å’ŒåŠ è½½ï¼Œæ¨¡å‹å¦‚ä½•è¯„ä¼°è¿™å‡ æ­¥ã€‚è¿™é‡Œåªå±•ç¤ºæ ¸å¿ƒä»£ç </p><h3 id="è¶…å‚"><a href="#è¶…å‚" class="headerlink" title="è¶…å‚"></a>è¶…å‚</h3><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>å€¼</th></tr></thead><tbody><tr><td>Epoch</td><td>10</td></tr><tr><td>Bacth_size</td><td>16/32</td></tr><tr><td>Optimizer</td><td>AdamW</td></tr><tr><td>LR</td><td>5e-5</td></tr><tr><td>Loss</td><td>CrossEntropyLoss</td></tr><tr><td>Metrics</td><td>Accuracy</td></tr></tbody></table></div><blockquote><p>æœ‰è¶£çš„æ˜¯ï¼Œå¦‚æœbatch size = 4ï¼Œæ¨¡å‹æ— æ³•è®­ç»ƒå¤„ä»»ä½•ç»“æœã€‚</p></blockquote><h3 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># éƒ¨åˆ†code</span></span><br><span class="line"></span><br><span class="line">transformer_config = AutoConfig.from_pretrained(args.config_name <span class="keyword">if</span> args.config_name <span class="keyword">else</span> args.model_name, num_labels=num_labels)</span><br><span class="line">tokenizer = AutoTokenizer.from_pretrained(</span><br><span class="line">        args.tokenizer_name <span class="keyword">if</span> args.tokenizer_name <span class="keyword">else</span> args.model_name,</span><br><span class="line">        do_lower_case=<span class="literal">True</span>,</span><br><span class="line">        cache_dir=<span class="literal">None</span>,</span><br><span class="line">    )</span><br><span class="line">transformer = AutoModel.from_pretrained(args.model_name, config=transformer_config, cache_dir=<span class="literal">None</span>)</span><br><span class="line">img_encoder = ImageEncoderDenseNet(num_image_embeds=args.num_image_embeds)</span><br><span class="line">multimodal_config = MMBTConfig(transformer, img_encoder, num_labels=num_labels, modal_hidden_size=<span class="number">1024</span>)</span><br><span class="line">model = MMBTForClassification(transformer_config, multimodal_config)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨MMBTæ¨¡å‹: ç”¨äºå›¾åƒå’Œæ–‡æœ¬åˆ†ç±»çš„æœ‰ç›‘ç£å¤šæ¨¡æ€åŒå‘Transformerã€‚</p><ul><li>å›¾åƒç¼–ç å™¨ä½¿ç”¨çš„ChexNetï¼Œè¿™æ˜¯ä¸€ä¸ªé’ˆå¯¹Xå…‰èƒ¸ç‰‡è‚ºç‚æ£€æµ‹çš„æ¨¡å‹ï¼›</li><li>æ–‡æœ¬ç¼–ç å™¨ä½¿ç”¨çš„é¢„è®­ç»ƒçš„BERTæ¨¡å‹ï¼šbert-base-uncasedã€‚</li></ul><p>æ•´ä½“ç½‘ç»œç»“æ„å¦‚å›¾</p><p><img src="image-20221102150400-2suo5cw.png" alt="image">â€‹</p><p>â€</p><h3 id="data-loader"><a href="#data-loader" class="headerlink" title="data loader"></a>data loader</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># éƒ¨åˆ†code</span></span><br><span class="line">dataset = JsonlDataset(path, img_dir, tokenizer, img_transforms, labels, wandb_config.max_seq_length -</span><br><span class="line">                       wandb_config.num_image_embeds - <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">train_dataloader = DataLoader(</span><br><span class="line">    train_dataset,</span><br><span class="line">    sampler=train_sampler,</span><br><span class="line">    batch_size=args.train_batch_size,</span><br><span class="line">    collate_fn=collate_fn</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="train"><a href="#train" class="headerlink" title="train"></a>train</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># éƒ¨åˆ†code</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> train_iterator:</span><br><span class="line">    epoch_iterator = tqdm(train_dataloader, desc=<span class="string">&quot;Training Batch Iteration&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> step, batch <span class="keyword">in</span> <span class="built_in">enumerate</span>(epoch_iterator):</span><br><span class="line"></span><br><span class="line">        batch = <span class="built_in">tuple</span>(t.to(args.device) <span class="keyword">for</span> t <span class="keyword">in</span> batch)</span><br><span class="line">        labels = batch[<span class="number">5</span>]</span><br><span class="line">        input_ids = batch[<span class="number">0</span>]</span><br><span class="line">        input_modal = batch[<span class="number">2</span>]</span><br><span class="line">        attention_mask = batch[<span class="number">1</span>]</span><br><span class="line">        modal_start_tokens = batch[<span class="number">3</span>]</span><br><span class="line">        modal_end_tokens = batch[<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">        outputs = model(</span><br><span class="line">            input_modal,</span><br><span class="line">            input_ids=input_ids,</span><br><span class="line">            modal_start_tokens=modal_start_tokens,</span><br><span class="line">            modal_end_tokens=modal_end_tokens,</span><br><span class="line">            attention_mask=attention_mask,</span><br><span class="line">            token_type_ids=<span class="literal">None</span>,</span><br><span class="line">            modal_token_type_ids=<span class="literal">None</span>,</span><br><span class="line">            position_ids=<span class="literal">None</span>,</span><br><span class="line">            modal_position_ids=<span class="literal">None</span>,</span><br><span class="line">            head_mask=<span class="literal">None</span>,</span><br><span class="line">            inputs_embeds=<span class="literal">None</span>,</span><br><span class="line">            labels=labels,</span><br><span class="line">            return_dict=<span class="literal">True</span></span><br><span class="line">        )</span><br><span class="line">        logits = outputs.logits</span><br><span class="line">        loss = outputs.loss</span><br><span class="line">        loss.backward()</span><br></pre></td></tr></table></figure><h3 id="è¯„ä¼°"><a href="#è¯„ä¼°" class="headerlink" title="è¯„ä¼°"></a>è¯„ä¼°</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># éƒ¨åˆ†ä»£ç </span></span><br><span class="line">result = evaluate(args, model, tokenizer, evaluate=<span class="literal">True</span>, test=<span class="literal">True</span>, prefix=prefix)</span><br></pre></td></tr></table></figure><h1 id="å¼€å‘æ–°ç»„ä»¶"><a href="#å¼€å‘æ–°ç»„ä»¶" class="headerlink" title="å¼€å‘æ–°ç»„ä»¶"></a>å¼€å‘æ–°ç»„ä»¶</h1><p>å½“æˆ‘ä»¬å·²ç»åœ¨æœ¬åœ°è·‘é€šä»£ç ï¼Œå¹¶æ˜ç¡®ç®—æ³•ä¹‹åï¼Œå°±å¯ä»¥å¼€å‘æ–°çš„ç»„ä»¶ï¼Œå°†ç®—æ³•è”é‚¦åŒ–ã€‚</p><p>è¿™é‡Œå®˜æ–¹æ–‡æ¡£å†™çš„å¾ˆæ¸…æ¥šï¼Œæˆ‘å¤§æ¦‚å¤è¿°ä¸€ä¸‹</p><h3 id="Step-1-Define-the-python-parameter-object-to-be-used-by-this-component"><a href="#Step-1-Define-the-python-parameter-object-to-be-used-by-this-component" class="headerlink" title="Step 1. Define the python parameter object to be used by this component"></a>Step 1. Define the python parameter object to be used by this component</h3><ol><li>Open a new python file called <code>xxx_param.py</code>â€‹, where xxx stands for your componentâ€™s name. Place this file in the folder <code>python/federatedm/param/</code>â€‹. The class object defined in <code>xxx_param.py</code>â€‹ should inherit the <code>BaseParam</code>â€‹ class declared in <code>python/federatedml/param/base_param.py</code>â€‹</li><li>The <code>__init__</code>â€‹ method of your parameter class should specify all parameters that the component uses.</li><li>Override and implement the <code>check</code>â€‹ interface method of BaseParam. The <code>check</code>â€‹ method is used to validate the parameter variables.</li><li><code>python/federatedml/param/__init__.py</code>â€‹åˆ—è¡¨<code>__all__</code>â€‹å¢åŠ ä½ çš„ç»„ä»¶åç§°ï¼Œå¹¶å¯¼å…¥ã€‚</li></ol><p>æˆ‘è¿™é‡Œç»„ä»¶åç§°å«homo_mmï¼Œæ‰€ä»¥åˆ›å»ºçš„pythonæ–‡ä»¶åä¸ºhomo_mm_param.pyã€‚ç”±äºå’Œhomo_nnå¾ˆåƒï¼Œæ‰€ä»¥ç›´æ¥è®²homo_nn_param.pyå¤åˆ¶è¿‡æ¥ï¼Œå°†é‡Œé¢çš„â€œnnâ€æ”¹æˆâ€œmmâ€ã€‚</p><p>ç¬¬å››æ­¥å¢åŠ äº†</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> federatedml.param.homo_mm_param <span class="keyword">import</span> HomoMMParam</span><br><span class="line">...</span><br><span class="line">__all__ = [... <span class="string">&quot;HomoMMParam&quot;</span>, ...]</span><br></pre></td></tr></table></figure><p>python/federatedml/param/<strong>init</strong>.py</p><h3 id="Step-2-Define-the-meta-file-of-the-new-component"><a href="#Step-2-Define-the-meta-file-of-the-new-component" class="headerlink" title="Step 2. Define the meta file of the new component"></a>Step 2. Define the meta file of the new component</h3><ol><li>Define component meta python file under <code>python/federatedml/components/</code>â€‹, name it as <code>xxx.py</code>â€‹, where xxx stands for the algorithm component being developed.</li><li>Implement the meta file.</li></ol><p>æˆ‘è¿™é‡Œç»„ä»¶åç§°å«homo_mmï¼Œæ‰€ä»¥åˆ›å»ºçš„pythonæ–‡ä»¶åä¸ºhomo_mm.pyã€‚ç”±äºå’Œhomo_nnå¾ˆåƒï¼Œæ‰€ä»¥ç›´æ¥è®²homo_nn.pyå¤åˆ¶è¿‡æ¥ï¼Œå°†é‡Œé¢çš„â€œnnâ€æ”¹æˆâ€œmmâ€ã€‚</p><h3 id="Step-3-Define-the-transfer-variable-object-of-this-module-Optional"><a href="#Step-3-Define-the-transfer-variable-object-of-this-module-Optional" class="headerlink" title="Step 3. Define the transfer variable object of this module. (Optional)"></a>Step 3. Define the transfer variable object of this module. (Optional)</h3><p>è¿™é‡Œä¸éœ€è¦</p><h3 id="Step-4-Create-the-component-which-inherits-the-class-model-baseâ€‹"><a href="#Step-4-Create-the-component-which-inherits-the-class-model-baseâ€‹" class="headerlink" title="Step 4. Create the component which inherits the class model_baseâ€‹"></a>Step 4. Create the component which inherits the class <code>model_base</code>â€‹</h3><p>ç°åœ¨å°±å¯ä»¥å°†<code>python/federatedml/nn/homo_nn</code>â€‹å¤åˆ¶ä¸€ä»½ï¼Œä¿®æ”¹ä¸ºhomo_mmï¼Œä¿®æ”¹_torch.pyæ–‡ä»¶</p><p>è¯¦ç•¥ã€‚</p><h3 id="additional"><a href="#additional" class="headerlink" title="additional"></a>additional</h3><p>éœ€è¦æ³¨æ„åœ¨<code>python/federatedml/nn/backend/pytorch/data.py</code>â€‹æ–°å»ºæ–°çš„datasetã€‚å¹¶åœ¨_torchä¸­çš„make_datasetåˆ›å»ºï¼Œè¿™é‡Œå¯ä»¥å‚ç…§VisionDataSet</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MMDataSet</span>(<span class="title class_ inherited__">DatasetMixIn</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_num_labels</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_num_features</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_keys</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._keys</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">as_data_instance</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">from</span> federatedml.feature.instance <span class="keyword">import</span> Instance</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">_as_instance</span>(<span class="params">x</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(x, np.number):</span><br><span class="line">                <span class="keyword">return</span> Instance(label=x.tolist())</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> Instance(label=x)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> computing_session.parallelize(</span><br><span class="line">            data=<span class="built_in">zip</span>(self._keys, <span class="built_in">map</span>(_as_instance, self.targets)),</span><br><span class="line">            include_key=<span class="literal">True</span>,</span><br><span class="line">            partition=<span class="number">1</span>,</span><br><span class="line">        )</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,train_data_path, is_train=<span class="literal">True</span>, expected_label_type=np.float32,**kwargs</span>):</span><br><span class="line"><span class="comment"># è¿™é‡Œå¿…é¡»åŠ ä¸Šï¼Œå¦åˆ™ä¼šå¡åœ¨æ ‡ç­¾å¯¹é½ä¸”ä¸æŠ¥é”™</span></span><br><span class="line">        <span class="keyword">if</span> is_train:</span><br><span class="line">            HomoLabelEncoderClient().label_alignment([<span class="string">&quot;fake&quot;</span>])</span><br><span class="line"></span><br><span class="line">        tokenizer = AutoTokenizer.from_pretrained(</span><br><span class="line">            <span class="string">&quot;bert-base-uncased&quot;</span>,</span><br><span class="line">            do_lower_case=<span class="literal">True</span>,</span><br><span class="line">            cache_dir=<span class="literal">None</span>,</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        labels = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">        labels2id = &#123;<span class="string">&#x27;0&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;1&#x27;</span>: <span class="number">1</span>&#125;</span><br><span class="line">        self.labels2id = labels2id</span><br><span class="line">        self.data = [json.loads(line) <span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(os.path.join(train_data_path, <span class="string">&quot;meta.jsonl&quot;</span>))]</span><br><span class="line"></span><br><span class="line">        self.targets = [ item[<span class="string">&#x27;label&#x27;</span>] <span class="keyword">for</span> item <span class="keyword">in</span> self.data]</span><br><span class="line">        self.img_data_dir = os.path.join(train_data_path, <span class="string">&#x27;images&#x27;</span>)</span><br><span class="line">        self.tokenizer = tokenizer</span><br><span class="line">        self.labels = labels</span><br><span class="line">        self.n_classes = <span class="built_in">len</span>(labels)</span><br><span class="line">        self.max_seq_length = <span class="number">300</span> - <span class="number">3</span> - <span class="number">2</span></span><br><span class="line">        self.transforms = torchvision.transforms.Compose(</span><br><span class="line">            [</span><br><span class="line">                torchvision.transforms.Resize(<span class="number">256</span>),</span><br><span class="line">                torchvision.transforms.CenterCrop(<span class="number">224</span>),</span><br><span class="line">                torchvision.transforms.ToTensor(),</span><br><span class="line">                torchvision.transforms.Normalize(</span><br><span class="line">                    mean=[<span class="number">0.485</span>, <span class="number">0.456</span>, <span class="number">0.406</span>],</span><br><span class="line">                    std=[<span class="number">0.229</span>, <span class="number">0.224</span>, <span class="number">0.225</span>]</span><br><span class="line">                )</span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        key_dic = []</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">id</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(self.data)):</span><br><span class="line">            key_dic.append(<span class="built_in">id</span>)</span><br><span class="line">        self._keys = key_dic</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sentence = torch.LongTensor(self.tokenizer.encode(self.data[index][<span class="string">&quot;text&quot;</span>], add_special_tokens=<span class="literal">True</span>))</span><br><span class="line">        start_token, sentence, end_token = sentence[<span class="number">0</span>], sentence[<span class="number">1</span>:-<span class="number">1</span>], sentence[-<span class="number">1</span>]</span><br><span class="line">        sentence = sentence[:self.max_seq_length]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.n_classes &gt; <span class="number">2</span>:</span><br><span class="line">            <span class="comment"># multiclass</span></span><br><span class="line">            label = torch.zeros(self.n_classes)</span><br><span class="line">            label[self.labels.index(self.data[index][<span class="string">&quot;label&quot;</span>])] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            label = torch.LongTensor([self.labels.index(self.data[index][<span class="string">&quot;label&quot;</span>])])</span><br><span class="line"></span><br><span class="line">        image = Image.<span class="built_in">open</span>(os.path.join(self.img_data_dir, self.data[index][<span class="string">&quot;img&quot;</span>])).convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">        image = self.transforms(image)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&quot;image_start_token&quot;</span>: start_token,</span><br><span class="line">            <span class="string">&quot;image_end_token&quot;</span>: end_token,</span><br><span class="line">            <span class="string">&quot;sentence&quot;</span>: sentence,</span><br><span class="line">            <span class="string">&quot;image&quot;</span>: image,</span><br><span class="line">            <span class="string">&quot;label&quot;</span>: label,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.data)</span><br><span class="line">    <span class="comment"># æ ‡ç­¾åç§°å’Œæ ‡ç­¾indexçš„å¯¹åº”ï¼Œä¾‹å¦‚&#123;&quot;é˜´æ€§&quot;:0, &quot;é˜³æ€§&quot;:1&#125;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_label_align_mapping</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.labels2id</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœJobä»ç„¶è·‘ä¸èµ·æ¥ï¼Œå¯ä»¥é€šè¿‡FATE-BOARDæ—¥å¿—æ’é”™ã€‚</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å¤šæ¨¡æ€æœ€è¿‘æ¯”è¾ƒç«&lt;/p&gt;
&lt;p&gt;å¤šæ¨¡æ€ä»»åŠ¡çš„inputå’Œç®—æ³•FATEä¸æ”¯æŒï¼Œå› æ­¤éœ€è¦å¼€å‘æ–°çš„dataloaderå’Œç®—æ³•ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ç¯‡å°±ä»¥è‚ºç‚å¤šæ¨¡æ€ä»»åŠ¡ä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•å¼€å‘æ–°çš„FATEæœºå™¨å­¦ä¹ ç»„ä»¶&lt;/p&gt;
&lt;p&gt;å®˜æ–¹æ–‡æ¡£åœ¨è¿™é‡Œï¼š&lt;a hre</summary>
      
    
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/categories/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/tags/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>FATEæ¨ªå‘è”é‚¦å­¦ä¹ ï¼šè‚ ç™Œå›¾åƒåˆ†ç±»ä»»åŠ¡ï¼ˆä¸‹ï¼‰â€”â€”è”é‚¦åŒ–</title>
    <link href="https://guoyujian.github.io/2022/11/04/FATE%E6%A8%AA%E5%90%91%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%EF%BC%9A%E8%82%A0%E7%99%8C%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%E4%BB%BB%E5%8A%A1%EF%BC%88%E4%B8%8B%EF%BC%89%E2%80%94%E2%80%94%E8%81%94%E9%82%A6%E5%8C%96/"/>
    <id>https://guoyujian.github.io/2022/11/04/FATE%E6%A8%AA%E5%90%91%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%EF%BC%9A%E8%82%A0%E7%99%8C%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%E4%BB%BB%E5%8A%A1%EF%BC%88%E4%B8%8B%EF%BC%89%E2%80%94%E2%80%94%E8%81%94%E9%82%A6%E5%8C%96/</id>
    <published>2022-11-03T16:08:29.000Z</published>
    <updated>2022-11-03T16:10:04.862Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åœ¨ä¸Šä¸€ç¯‡å·²ç»åœ¨æœ¬åœ°è·‘é€šäº†è‚ ç™Œå›¾åƒåˆ†ç±»çš„æ•´ä¸ªæµç¨‹ï¼Œç°åœ¨æˆ‘ä»¬å°†å®ƒç§»æ¤åˆ°FATEä¸Šï¼Œå®ç°è”é‚¦å­¦ä¹ ã€‚</p></blockquote><h1 id="æ•°æ®é¢„å¤„ç†"><a href="#æ•°æ®é¢„å¤„ç†" class="headerlink" title="æ•°æ®é¢„å¤„ç†"></a>æ•°æ®é¢„å¤„ç†</h1><p>ä»¿ç…§â€œæ‰‹å†™æ•°å­—è¯†åˆ«â€ä»»åŠ¡ï¼Œå°†ä¸‰ä»½è®­ç»ƒæ•°æ®è¿›è¡Œé¢„å¤„ç†ã€‚å¹¶æ–°å»ºé…ç½®æ–‡ä»¶ï¼Œå¤„ç†åçš„æ ¼å¼å¦‚å›¾ã€‚</p><p><img src="image-20221101234910-nivm8sx.png" alt="image.png"></p><ul><li>code/ï¼š bindå¼€å¤´çš„æ–‡ä»¶æ˜¯ç”¨äºæ•°æ®ç»‘å®šï¼›colon_confæ˜¯confæ–‡ä»¶ï¼Œcolon_dslæ˜¯dslæ–‡ä»¶</li><li>test/ï¼š500å¼ æµ‹è¯•æ•°æ®</li><li>val/ï¼š500å¼ éªŒè¯é›†</li><li><p>train_pX/ï¼šç¬¬Xä»½è®­ç»ƒæ•°æ®ï¼Œæ¯ä¸€ä»½3000å¼ </p><ul><li>images/ï¼šå›¾ç‰‡æ–‡ä»¶å¤¹ï¼Œå­˜æ”¾æ‰€æœ‰å›¾åƒ</li><li>config.yamlï¼šå›¾ç‰‡æ–‡ä»¶å¤¹é…ç½®ï¼šé€šé“æ•°ï¼Œæ ¼å¼ç­‰ã€‚</li><li>filenamesï¼šimagesç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åï¼ˆå»æ‰åç¼€ï¼‰ï¼Œæ¯ä¸ªæ–‡ä»¶åå ä¸€è¡Œ</li><li>targetsï¼šimagesç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åï¼ˆå»æ‰åç¼€ï¼‰å’Œlabelï¼Œé€—å·åŒºåˆ†ï¼Œæ¯ä¸ªæ–‡ä»¶åå’Œç±»åˆ«å ä¸€è¡Œã€‚</li></ul></li></ul><h1 id="ä¿®æ”¹æºä»£ç "><a href="#ä¿®æ”¹æºä»£ç " class="headerlink" title="ä¿®æ”¹æºä»£ç "></a>ä¿®æ”¹æºä»£ç </h1><p>ä¹‹å‰åœ¨åˆ†ææºç æ—¶ï¼Œå¯ä»¥çœ‹åˆ°homo_nnçš„æ¨¡å‹é…ç½®æ¯”è¾ƒå®šåˆ¶åŒ–ï¼Œä¸å¤Ÿçµæ´»ï¼Œå› æ­¤æˆ‘ä»¬ä¿®æ”¹æºç å®ç°ï¼š</p><ol><li>ä¿®æ”¹æ•°æ®åŠ è½½</li><li>ä½¿ç”¨é¢„è®­ç»ƒçš„vgg16ç®—æ³•æ¨¡å‹ï¼›</li><li>ä½¿ç”¨GPU</li><li>å®ç°æ¨¡å‹è¯„ä¼°</li></ol><h2 id="ä¿®æ”¹æ•°æ®åŠ è½½"><a href="#ä¿®æ”¹æ•°æ®åŠ è½½" class="headerlink" title="ä¿®æ”¹æ•°æ®åŠ è½½"></a>ä¿®æ”¹æ•°æ®åŠ è½½</h2><p>æˆ‘ä»¬çŸ¥é“vgg16ä¼ å…¥çš„å›¾åƒå°ºå¯¸ä¸º$224<em>224</em>3$ï¼Œè€Œè‚ ç™Œæ•°æ®é›†çš„å›¾åƒæ ¼å¼å¤§å°ä¸º$768<em>768</em>3$ï¼Œæ‰€ä»¥éœ€è¦å…ˆå¯¹æ•°æ®åŠ è½½è¿›è¡Œä¿®æ”¹ï¼š</p><p>ä¿®æ”¹FATE/python/federatedml/nn/backend/pytorch/data.pyçš„<code>VisionDataSet</code>ç±»çš„<strong>get_item</strong>æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line"></span><br><span class="line">    img = Image.<span class="built_in">open</span>(self.images[index]).convert(self._PIL_mode)</span><br><span class="line">    <span class="keyword">if</span> img.size[<span class="number">0</span>] &gt; <span class="number">224</span>:</span><br><span class="line">        resize_transform = torchvision.transforms.Compose(</span><br><span class="line">            [</span><br><span class="line">                torchvision.transforms.Resize(<span class="number">256</span>),</span><br><span class="line">                torchvision.transforms.CenterCrop(<span class="number">224</span>),</span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line">        img = resize_transform(img)</span><br><span class="line">    <span class="keyword">if</span> self.targets_is_image:</span><br><span class="line">        target = Image.<span class="built_in">open</span>(self.targets[index])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        target = self.targets[index]</span><br><span class="line">    <span class="keyword">return</span> self.transforms(img, target)</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹ç®—æ³•æ¨¡å‹"><a href="#ä¿®æ”¹ç®—æ³•æ¨¡å‹" class="headerlink" title="ä¿®æ”¹ç®—æ³•æ¨¡å‹"></a>ä¿®æ”¹ç®—æ³•æ¨¡å‹</h2><p>æˆ‘ä»¬éœ€è¦ä¿®æ”¹homo<em>nnç»„ä»¶ä¸‹çš„<em>torch.pyæ–‡ä»¶ï¼Œ<code>FedLightModule</code>ç±»çš„__init</em></em>æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># --------- ä¿®æ”¹å‰ ----------</span></span><br><span class="line"><span class="comment"># self.model = nn.Sequential(*layers)</span></span><br><span class="line"><span class="comment"># --------- ä¿®æ”¹å ----------</span></span><br><span class="line"><span class="comment"># è¿™é‡Œéå¸¸å®šåˆ¶åŒ–ï¼Œout_features=2æ˜¯é’ˆå¯¹æœ¬äºŒåˆ†ç±»ä»»åŠ¡ï¼Œå¦‚æœéœ€è¦æ›´çµæ´»çš„ä¼ å‚ï¼Œå¯ä»¥è¯»å–é…ç½®æ–‡ä»¶çš„é…ç½®</span></span><br><span class="line">LOGGER.info(<span class="string">&quot;define vgg16&quot;</span>)</span><br><span class="line">self.model = models.vgg16(pretrained=<span class="literal">True</span>)</span><br><span class="line">self.model.classifier[<span class="number">6</span>] = nn.Linear(in_features=<span class="number">4096</span>, out_features=<span class="number">2</span>, bias=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨GPU"><a href="#ä½¿ç”¨GPU" class="headerlink" title="ä½¿ç”¨GPU"></a>ä½¿ç”¨GPU</h2><p>éœ€è¦ä¿®æ”¹homo_nnç»„ä»¶ä¸‹çš„_torch.pyæ–‡ä»¶ï¼Œ<code>FedLightModule</code>ç±»çš„training_stepã€validation_stepä»¥åŠdo_convergence_checkå’Œencryptæ–¹æ³•ã€‚æ”¹åŠ¨å¦‚ä¸‹ã€‚</p><blockquote><p>do_convergence_checkå’Œencryptè¦æ”¹åŠ¨çš„åŸå› å¹¶ä¸æ¸…æ¥šï¼Œå¤§è‡´æ¥çœ‹ï¼Œåº”è¯¥æ˜¯åœ¨modelèšåˆå’ŒåŠ å¯†çš„æ—¶å€™éœ€è¦å°†å…¶ä»GPUä¸­å–å‡ºã€‚ã€‚ä¸è¿‡å¯ä»¥è‚¯å®šï¼Œå¦‚æ­¤æ”¹åŠ¨å°±ä¼šç”Ÿæ•ˆã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">validation_step</span>(<span class="params">self, batch, batch_idx</span>):</span><br><span class="line">    x, y = batch</span><br><span class="line">    <span class="comment"># -------------- add start ------------------</span></span><br><span class="line">    device = torch.device(<span class="string">&#x27;cuda&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line">    <span class="comment"># LOGGER.info(f&#x27;device:&#123;device&#125;&#x27;)</span></span><br><span class="line">    x, y = x.to(device), y.to(device)</span><br><span class="line">    <span class="comment"># -------------- add end ------------------</span></span><br><span class="line">    y_hat = self.forward(x)</span><br><span class="line">    loss = self.loss_fn(y_hat, y)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> y_hat.shape[<span class="number">1</span>] &gt; <span class="number">1</span>:</span><br><span class="line">        accuracy = (y_hat.argmax(dim=<span class="number">1</span>) == y).<span class="built_in">sum</span>().<span class="built_in">float</span>() / <span class="built_in">float</span>(y.size(<span class="number">0</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        y_prob = y_hat[:, <span class="number">0</span>] &gt; <span class="number">0.5</span></span><br><span class="line">        accuracy = (y == y_prob).<span class="built_in">sum</span>().<span class="built_in">float</span>() / y.size(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;val_loss&quot;</span>: loss, <span class="string">&quot;val_accuracy&quot;</span>: accuracy&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">training_step</span>(<span class="params">self, batch, batch_idx</span>):</span><br><span class="line">    x, y = batch</span><br><span class="line">    <span class="comment"># -------------- add start ------------------</span></span><br><span class="line">    device = torch.device(<span class="string">&#x27;cuda&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line">    x, y = x.to(device), y.to(device)</span><br><span class="line">    self.model = self.model.to(device)</span><br><span class="line">    <span class="comment"># -------------- add end ------------------</span></span><br><span class="line">    y_hat = self.model(x)</span><br><span class="line">    <span class="comment"># LOGGER.info(&#x27;y_hat: &#123;&#125;&#x27;.format(y_hat.detach().numpy()))</span></span><br><span class="line">    loss = self.loss_fn(y_hat, y)</span><br><span class="line">    self.log(<span class="string">&quot;train_loss&quot;</span>, loss)</span><br><span class="line">    <span class="keyword">return</span> loss</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_convergence_check</span>(<span class="params">self, weight, loss</span>):</span><br><span class="line">    <span class="comment"># loss_value = loss.detach().numpy().tolist()</span></span><br><span class="line">    loss_value = loss.detach().cpu().numpy().tolist()</span><br><span class="line"></span><br><span class="line">    self.loss_summary.append(loss_value)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send loss to server</span></span><br><span class="line">    self.send_loss(loss_value, weight)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># recv convergence status</span></span><br><span class="line">    status = self.recv_loss()</span><br><span class="line">    <span class="keyword">return</span> status</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, tensor: torch.Tensor, weight</span>):</span><br><span class="line">    <span class="keyword">return</span> self.random_padding_cipher.encrypt(</span><br><span class="line"><span class="comment"># torch.clone(tensor).detach().mul_(weight)</span></span><br><span class="line">        torch.clone(tensor).detach().mul_(weight).cpu()</span><br><span class="line">    ).numpy()</span><br></pre></td></tr></table></figure><h2 id="æ¨¡å‹è¯„ä¼°"><a href="#æ¨¡å‹è¯„ä¼°" class="headerlink" title="æ¨¡å‹è¯„ä¼°"></a>æ¨¡å‹è¯„ä¼°</h2><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„æ¨¡å‹è¯„ä¼°ä»£ç ï¼Œåœ¨homo_nnæ–‡ä»¶å¤¹ä¸‹æ–°å»ºevaluation.pyï¼Œä»£ç åŠæ³¨é‡Šå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯¼å…¥å¿…è¦çš„åº“ï¼Œæ³¨æ„è¿™é‡Œéœ€è¦å¯¼å…¥homo_nnä¸‹çš„FedLightModuleç±»</span></span><br><span class="line"><span class="comment"># å¦‚æœåº“ä¸å­˜åœ¨ï¼Œéœ€è¦åœ¨fate-flowå®¹å™¨ä¸‹pipå®‰è£…</span></span><br><span class="line"><span class="keyword">from</span> federatedml.nn.homo_nn._torch <span class="keyword">import</span> FedLightModule</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader, Dataset, random_split</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> datasets, models, transforms</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment"># import cv2</span></span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"></span><br><span class="line"><span class="comment"># dataset</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">My_Dataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, image_path, target</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.image_path = image_path</span><br><span class="line">        self.target = target</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.image_path)</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        path = self.image_path[index]</span><br><span class="line">        img = Image.<span class="built_in">open</span>(path).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">        resize_transform = transforms.Compose([</span><br><span class="line">            transforms.Resize(<span class="number">256</span>),</span><br><span class="line">            transforms.CenterCrop(<span class="number">224</span>),</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        toTensor_transform = transforms.Compose([</span><br><span class="line">            transforms.ToTensor()</span><br><span class="line">        ])</span><br><span class="line">        label = self.target[index]</span><br><span class="line">        <span class="keyword">if</span> img.size[<span class="number">0</span>] &gt; <span class="number">224</span>:</span><br><span class="line">            img = resize_transform(img)</span><br><span class="line">        img = toTensor_transform(img)</span><br><span class="line">        <span class="keyword">return</span> img, label</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># test</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_model</span>(<span class="params">test_loader, model, criterion, device</span>):</span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line">  </span><br><span class="line">    true_labels = []</span><br><span class="line">    pred_labels = []</span><br><span class="line">    scores = []</span><br><span class="line"></span><br><span class="line">    size = <span class="built_in">len</span>(test_loader.dataset)</span><br><span class="line">    num_batches = <span class="built_in">len</span>(test_loader)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;size:<span class="subst">&#123;size&#125;</span>; num_batches:<span class="subst">&#123;num_batches&#125;</span>&#x27;</span>)</span><br><span class="line">    losses, correct = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="comment"># log_loss = 0</span></span><br><span class="line">    <span class="comment">################################# validation #################################</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">for</span> batch, (x, y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(tqdm(test_loader)):</span><br><span class="line">            device = torch.device(device)</span><br><span class="line">            x, y = x.to(device), y.to(device)</span><br><span class="line">            pred = model(x)</span><br><span class="line">            loss = criterion(pred, y.long().squeeze()) </span><br><span class="line">            current = batch * <span class="built_in">len</span>(x)</span><br><span class="line">            scores += pred.tolist()</span><br><span class="line">            y_pred, y_true = torch.argmax(pred, axis=<span class="number">1</span>), y.long().squeeze()</span><br><span class="line">            correct += (y_pred == y_true).<span class="built_in">type</span>(torch.<span class="built_in">float</span>).<span class="built_in">sum</span>().item()</span><br><span class="line">            loss, current = np.<span class="built_in">round</span>(loss.item(), <span class="number">5</span>), batch * <span class="built_in">len</span>(x)</span><br><span class="line">            true_labels += y_true.detach().cpu().tolist()</span><br><span class="line">            pred_labels += y_pred.detach().cpu().tolist()</span><br><span class="line">            losses += loss</span><br><span class="line">    correct /= size</span><br><span class="line">    losses /= num_batches</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;losses:<span class="subst">&#123;losses&#125;</span>\n&#x27;</span>)</span><br><span class="line">    metrics = <span class="string">f&quot;Test: Accuracy: <span class="subst">&#123;(<span class="number">100</span>*correct):&gt;<span class="number">0.2</span>f&#125;</span>%, Avg loss: <span class="subst">&#123;losses:&gt;5f&#125;</span> \n&quot;</span></span><br><span class="line">    <span class="keyword">return</span> np.array(true_labels), np.array(pred_labels), np.array(scores), metrics</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">model_path: model path</span></span><br><span class="line"><span class="string">res_path: save csv pathï¼Œä¿å­˜é¢„æµ‹çš„æ•°æ®ç»“æœ</span></span><br><span class="line"><span class="string">metric_path: mertic pathï¼Œä¿å­˜æ¨¡å‹è¯„ä¼°ç»“æœ</span></span><br><span class="line"><span class="string">typ : predict or testï¼Œtestæ˜¯è¯„ä¼°æ¨¡å‹ï¼Œéœ€è¦è¾“å‡ºæ¨¡å‹çš„è¯„ä¼°æŒ‡æ ‡ï¼Œpredictæ˜¯å•çº¯çš„å¯¹æœªçŸ¥labelæ•°æ®è¿›è¡Œé¢„æµ‹</span></span><br><span class="line"><span class="string">test_path: test data pathï¼Œæµ‹è¯•æ•°æ®é›†pathï¼Œé»˜è®¤å’Œtrainæ˜¯ç›¸åŒçš„ç»„ç»‡å½¢å¼</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">evaluation</span>(<span class="params">model_path, res_path, metric_path,  typ, test_path</span>):</span><br><span class="line">    model = FedLightModule.load_from_checkpoint(model_path)</span><br><span class="line">    test_images_over = []</span><br><span class="line">    test_labels_over = []</span><br><span class="line">    <span class="keyword">if</span> typ == <span class="string">&#x27;test&#x27;</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(test_path, <span class="string">&#x27;targets&#x27;</span>), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            line = f.readline()</span><br><span class="line">            <span class="keyword">while</span> line:</span><br><span class="line">                filename = line.split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">0</span>] + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">                target = <span class="built_in">int</span>(line.split(<span class="string">&#x27;,&#x27;</span>)[-<span class="number">1</span>].replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line">                test_images_over.append(os.path.join(test_path, <span class="string">&#x27;images&#x27;</span>, filename))</span><br><span class="line">                test_labels_over.append(target)</span><br><span class="line">                line = f.readline()</span><br><span class="line">    <span class="keyword">elif</span> typ == <span class="string">&#x27;predict&#x27;</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(test_path, <span class="string">&#x27;filenames&#x27;</span>), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            line = f.readline()</span><br><span class="line">            <span class="keyword">while</span> line:</span><br><span class="line">                filename = line.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>) + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">                target = <span class="number">0</span></span><br><span class="line">                test_images_over.append(os.path.join(test_path, <span class="string">&#x27;images&#x27;</span>, filename))</span><br><span class="line">                test_labels_over.append(target)</span><br><span class="line">                line = f.readline()</span><br><span class="line">    test_dataset = My_Dataset(test_images_over, test_labels_over)</span><br><span class="line">    test_loader = DataLoader(test_dataset, batch_size=<span class="number">32</span>)</span><br><span class="line">    loss_fn = nn.CrossEntropyLoss()</span><br><span class="line">    <span class="comment"># device = torch.device(&#x27;cuda&#x27; if torch.cuda.is_available() else &#x27;cpu&#x27;)</span></span><br><span class="line">    device = <span class="string">&#x27;cpu&#x27;</span></span><br><span class="line">    true_labels, pred_labels, scores, metrics = test_model(test_loader, model, loss_fn, device)</span><br><span class="line"></span><br><span class="line">    l = <span class="built_in">len</span>(true_labels)</span><br><span class="line">    <span class="keyword">if</span> typ == <span class="string">&#x27;test&#x27;</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(metric_path, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(<span class="string">f&#x27;<span class="subst">&#123;metrics&#125;</span>\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(res_path, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(<span class="string">&#x27;true_label,pred_label,score\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">                true_label, pred_label, score = true_labels[i], pred_labels[i], scores[i]</span><br><span class="line">                f.write(<span class="string">f&#x27;<span class="subst">&#123;true_label&#125;</span>,<span class="subst">&#123;pred_label&#125;</span>,<span class="subst">&#123;score&#125;</span>\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> typ == <span class="string">&#x27;predict&#x27;</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(res_path, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(<span class="string">&#x27;pred_label,score\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">                true_label, pred_label, score = true_labels[i], pred_labels[i], scores[i]</span><br><span class="line">                f.write(<span class="string">f&#x27;<span class="subst">&#123;pred_label&#125;</span>,<span class="subst">&#123;score&#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    res_path = <span class="string">&quot;./123.csv&quot;</span></span><br><span class="line">    metric_path = <span class="string">&quot;./123.txt&quot;</span></span><br><span class="line">    typ = <span class="string">&quot;test&quot;</span></span><br><span class="line">    path = <span class="string">&quot;/data/projects/fate/examples/gwork/colon/test&quot;</span></span><br><span class="line">    model_path = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    evaluation(model_path, res_path, metric_path,  typ, path)</span><br></pre></td></tr></table></figure><p>ä»£ç ä¿®æ”¹å®Œæ¯•ã€‚ä¸‹é¢è¿›è¡Œè®­ç»ƒã€‚</p><h1 id="è”é‚¦å­¦ä¹ "><a href="#è”é‚¦å­¦ä¹ " class="headerlink" title="è”é‚¦å­¦ä¹ "></a>è”é‚¦å­¦ä¹ </h1><p>åˆ†åˆ«ä¿®æ”¹CONFå’ŒDSLé…ç½®</p><h2 id="colon-conf-json"><a href="#colon-conf-json" class="headerlink" title="colon_conf.json"></a>colon_conf.json</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;dsl_version&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;initiator&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;role&quot;</span>: <span class="string">&quot;guest&quot;</span>,</span><br><span class="line">        <span class="string">&quot;party_id&quot;</span>: <span class="number">9999</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;role&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;arbiter&quot;</span>: [</span><br><span class="line">            <span class="number">10000</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;host&quot;</span>: [</span><br><span class="line">            <span class="number">9998</span>,<span class="number">9997</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;guest&quot;</span>: [</span><br><span class="line">            <span class="number">9999</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;component_parameters&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;common&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;homo_nn_0&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;api_version&quot;</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="string">&quot;encode_label&quot;</span>: true,</span><br><span class="line">                <span class="string">&quot;max_iter&quot;</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="string">&quot;batch_size&quot;</span>: <span class="number">32</span>,</span><br><span class="line">                <span class="string">&quot;optimizer&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;lr&quot;</span>: <span class="number">0.000001</span>,</span><br><span class="line">                    <span class="string">&quot;optimizer&quot;</span>: <span class="string">&quot;Adam&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">&quot;loss&quot;</span>: <span class="string">&quot;CrossEntropyLoss&quot;</span>,</span><br><span class="line">                <span class="string">&quot;metrics&quot;</span>: [</span><br><span class="line">                    <span class="string">&quot;accuracy&quot;</span></span><br><span class="line">                ],</span><br><span class="line">                <span class="string">&quot;nn_define&quot;</span>: [</span><br><span class="line">                ],</span><br><span class="line">                <span class="string">&quot;config_type&quot;</span>: <span class="string">&quot;pytorch&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;role&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;host&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;0&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;reader_0&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;table&quot;</span>: &#123;</span><br><span class="line">                            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;colon_images_0&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;namespace&quot;</span>: <span class="string">&quot;experiment&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">      <span class="string">&quot;1&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;reader_0&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;table&quot;</span>: &#123;</span><br><span class="line">                            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;colon_images_1&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;namespace&quot;</span>: <span class="string">&quot;experiment&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;guest&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;0&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;reader_0&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;table&quot;</span>: &#123;</span><br><span class="line">                            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;colon_images_2&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;namespace&quot;</span>: <span class="string">&quot;experiment&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="colon-dsl-json"><a href="#colon-dsl-json" class="headerlink" title="colon_dsl.json"></a>colon_dsl.json</h2><p>ç•¥</p><p>é¦–å…ˆæ•°æ®å·²ç»å¤„ç†æˆFATEå¯ä»¥è¯»å–çš„æ ¼å¼ã€‚</p><p>ç„¶åå°†ä¸‰ä»½æ•°æ®åˆ†å‘åˆ°é›†ç¾¤çš„ä¸‰å°ä¸åŒçš„æœºå™¨ä¸Šï¼Œåˆ†åˆ«æ˜¯fate9999ï¼Œfate9998ï¼Œä»¥åŠfate9997</p><p>è¿›å…¥ä¸‰å°æœºå™¨çš„fate-client containerï¼Œä½¿ç”¨flow table bind -c å‘½ä»¤å°†æ–‡ä»¶å¤¹ç»‘å®šåˆ°tableã€‚</p><p>åœ¨å‘èµ·æ–¹FATE9999çš„clientå®¹å™¨ä¸­ï¼Œè¿›å…¥codeæ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œ<code>flow job submit -c colon_conf.json -d colon_dsl.json</code>å¯åŠ¨ä»»åŠ¡</p><p>æŸ¥çœ‹FATE-BOARD Job</p><p>ä»–çš„homo_nnç»„ä»¶è¾“å‡ºçš„æ—¥å¿—å¦‚ä¸‹ï¼š</p><p><img src="image-20221014121445-6gzta7m.png" alt="image.png"></p><h1 id="æ¨¡å‹è¯„ä¼°-1"><a href="#æ¨¡å‹è¯„ä¼°-1" class="headerlink" title="æ¨¡å‹è¯„ä¼°"></a>æ¨¡å‹è¯„ä¼°</h1><p>åœ¨jobç»“æŸåï¼Œä¼šä¿å­˜check pointï¼Œä¿å­˜çš„å®¹å™¨ä¸ºfate-flow containerã€‚</p><p>ä»¥fate9999ä¸ºä¾‹ï¼Œä¿å­˜è·¯å¾„ä¸ºï¼š</p><p>/data/projects/fate/fateflow/jobs/202210131350059277200/guest/9999/homo_cv_0/202210131350059277200_homo_cv_0/0/task_executor/7f86f6064aff11edbd540242c0a70064/model.ckpt</p><blockquote><p>ä¸åŒè§’è‰²ï¼ˆgusetã€hostï¼‰ã€ä¸åŒparty_idçš„æœºå™¨ä¸Šè·¯å¾„å¯èƒ½æœ‰æ‰€å·®å¼‚ã€‚</p></blockquote><p>å°†è¯¥è·¯å¾„å¤åˆ¶åˆ°åˆšæ‰çš„evaluation.pyçš„model_pathä¸­ï¼Œæ‰§è¡Œ<code>python evaluation.py</code>ï¼ŒæŸ¥çœ‹è¾“å‡ºç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Accuracy: 99.20%, Avg loss: 0.022641</span><br></pre></td></tr></table></figure><h1 id="å®éªŒç»“æœ"><a href="#å®éªŒç»“æœ" class="headerlink" title="å®éªŒç»“æœ"></a>å®éªŒç»“æœ</h1><p>ç»“åˆbaselineçš„å®éªŒç»“æœï¼Œå¯ä»¥å¾—åˆ°ä¸‹è¡¨ã€‚</p><div class="table-container"><table><thead><tr><th>ä½¿ç”¨çš„æ•°æ®</th><th>è®­ç»ƒç±»å‹</th><th>æ¨¡å‹è¯„ä¼°</th></tr></thead><tbody><tr><td>å…¨éƒ¨è®­ç»ƒæ•°æ®ï¼ˆTrain_1+Train_2+Train_3ï¼‰</td><td>æœ¬åœ°ï¼ˆGPUï¼‰</td><td>Accuracy: 99.60%, Avg loss: 0.011775</td></tr><tr><td>Train_1</td><td>æœ¬åœ°ï¼ˆGPUï¼‰</td><td>Accuracy: 73.20%, Avg loss: 0.641481</td></tr><tr><td>Train_2</td><td>æœ¬åœ°ï¼ˆGPUï¼‰</td><td>Accuracy: 71.40%, Avg loss: 0.649055</td></tr><tr><td>Train_3</td><td>æœ¬åœ°ï¼ˆGPUï¼‰</td><td>Accuracy: 56.80%, Avg loss: 0.654335</td></tr><tr><td>å…¨éƒ¨è®­ç»ƒæ•°æ®ï¼ˆTrain_1+Train_2+Train_3ï¼‰</td><td>è”é‚¦ï¼ˆGPUï¼‰</td><td>Accuracy: 99.20%, Avg loss: 0.022641</td></tr></tbody></table></div><p>åœ¨å¢åŠ äº†éƒ¨åˆ†è¯»å†™æ—¥å¿—ï¼Œå¹¶åŠ ä»¥åˆ†æå¯ä»¥å¾—åˆ°è®­ç»ƒçš„æ—¶é—´åˆ†å¸ƒï¼š</p><p><img src="image-20221102004157-5zhbj13.png" alt="image.png"></p><h1 id="å®éªŒåˆ†æ"><a href="#å®éªŒåˆ†æ" class="headerlink" title="å®éªŒåˆ†æ"></a>å®éªŒåˆ†æ</h1><ol><li><p>ä½¿ç”¨è”é‚¦å­¦ä¹ çš„æ•ˆæœè¦ä¼˜äºåˆ†å¼€è®­ç»ƒçš„æ¨¡å‹æ•ˆæœï¼Œè¯æ˜äº†è”é‚¦å­¦ä¹ çš„æœ‰æ•ˆæ€§ã€‚</p></li><li><p>åšå®éªŒå‘ç°ï¼Œä½¿ç”¨CPUè¿›è¡Œè®­ç»ƒï¼Œæ¯ä¸ªepochéœ€è¦å¤§çº¦15åˆ†é’Ÿï¼Œè€Œä½¿ç”¨GPUä¹‹åï¼Œæ¯ä¸ªepochä»…éœ€è¦29så·¦å³ã€‚ä½¿ç”¨GPUçš„è®¡ç®—æ•ˆç‡è¦è¿œè¿œå¤§äºä½¿ç”¨CPUã€‚</p></li><li><p>å¯¹æ—¥å¿—è¿›è¡Œåˆ†æå‘ç°ï¼Œè®¡ç®—æ—¶é—´çº¦ä¸º60sï¼Œæ¨¡å‹å‚æ•°åŠ å¯†ã€è§£å¯†ä»¥åŠä¼ è¾“çš„æ—¶é—´çº¦ä¸ºæ¯”ä¾‹çº¦ä¸º600sï¼ŒäºŒè€…æ¯”ä¾‹çº¦ä¸º1:10ã€‚å› æ­¤å¯ä»¥å¾—å‡ºç»“è®ºï¼šç»“è‚ ç™Œè”é‚¦å­¦ä¹ çš„æ—¶é—´ç“¶é¢ˆä¸åœ¨äºæœ¬åœ°æ¨¡å‹çš„è®­ç»ƒæ—¶é—´ï¼Œè€Œæ˜¯åœ¨äºæ¨¡å‹å‚æ•°åŠ å¯†ã€è§£å¯†ä»¥åŠä¼ è¾“æ—¶é—´ã€‚</p></li></ol><h1 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h1><p>ä¿®æ”¹äº†homo_nnçš„æºç ï¼Œå¯¼è‡´åŸæœ‰çš„homo_nnçš„åŠŸèƒ½å¤±æ•ˆï¼Œæ‰€ä»¥è¿™é‡Œä¸æ¨èè¿™æ ·æ”¹ï¼Œæ›´æ¨èå¼€å‘æ–°çš„ç»„ä»¶æ¥å®Œæˆã€‚</p><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;åœ¨ä¸Šä¸€ç¯‡å·²ç»åœ¨æœ¬åœ°è·‘é€šäº†è‚ ç™Œå›¾åƒåˆ†ç±»çš„æ•´ä¸ªæµç¨‹ï¼Œç°åœ¨æˆ‘ä»¬å°†å®ƒç§»æ¤åˆ°FATEä¸Šï¼Œå®ç°è”é‚¦å­¦ä¹ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;æ•°æ®é¢„å¤„ç†&quot;&gt;&lt;a href=&quot;#æ•°æ®é¢„å¤„ç†&quot; class=&quot;headerlink&quot; title=&quot;æ•°</summary>
      
    
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/categories/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/tags/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>FATEæ¨ªå‘è”é‚¦å­¦ä¹ ï¼šè‚ ç™Œå›¾åƒåˆ†ç±»ä»»åŠ¡ï¼ˆä¸Šï¼‰â€”â€”baseline</title>
    <link href="https://guoyujian.github.io/2022/11/04/FATE%E6%A8%AA%E5%90%91%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%EF%BC%9A%E8%82%A0%E7%99%8C%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%E4%BB%BB%E5%8A%A1%EF%BC%88%E4%B8%8A%EF%BC%89%E2%80%94%E2%80%94baseline/"/>
    <id>https://guoyujian.github.io/2022/11/04/FATE%E6%A8%AA%E5%90%91%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%EF%BC%9A%E8%82%A0%E7%99%8C%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%E4%BB%BB%E5%8A%A1%EF%BC%88%E4%B8%8A%EF%BC%89%E2%80%94%E2%80%94baseline/</id>
    <published>2022-11-03T16:07:00.000Z</published>
    <updated>2022-11-03T16:08:08.651Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ¡ˆä¾‹åˆ†ä¸Šä¸‹ä¸¤ç¯‡ï¼Œä¸Šç¯‡ä»‹ç»è‚ ç™Œå›¾åƒåˆ†ç±»ä»»åŠ¡çš„æœ¬åœ°baselineï¼Œä¸‹ç¯‡ä»‹ç»å°†è‚ ç™Œå›¾åƒåˆ†ç±»ä»»åŠ¡ç§»æ¤åˆ°FATEä¸Šï¼Œå®ç°è”é‚¦å­¦ä¹ ã€‚</p><h1 id="ä»»åŠ¡ç›®æ ‡"><a href="#ä»»åŠ¡ç›®æ ‡" class="headerlink" title="ä»»åŠ¡ç›®æ ‡"></a>ä»»åŠ¡ç›®æ ‡</h1><ol><li>ä½¿ç”¨FATEå¼€å‘æ–°çš„ç»„ä»¶ï¼Œå®ç°å›¾åƒæ¨ªå‘è”é‚¦å­¦ä¹ </li><li>è¯æ˜è”é‚¦å­¦ä¹ æœ‰æ•ˆ</li></ol><h1 id="ä»»åŠ¡ä»‹ç»"><a href="#ä»»åŠ¡ä»‹ç»" class="headerlink" title="ä»»åŠ¡ä»‹ç»"></a>ä»»åŠ¡ä»‹ç»</h1><p>è¯¥ä»»åŠ¡å°†å¼€å‘åŸºäºç»“è‚ çš„ç»„ç»‡ç—…ç†å­¦å›¾åƒæ­£ç¡®åˆ¤æ–­æ˜¯è‰¯æ€§ç»„ç»‡æˆ–è€…ç»“è‚ ç™Œçš„äºŒåˆ†ç±»ç®—æ³•ã€‚</p><h2 id="æ•°æ®é›†"><a href="#æ•°æ®é›†" class="headerlink" title="æ•°æ®é›†"></a>æ•°æ®é›†</h2><p>æ•°æ®é›†æ¥è‡ªäº<a href="https://www.kaggle.com/datasets/andrewmvd/lung-and-colon-cancer-histopathological-imagesçš„colon_image_sets">https://www.kaggle.com/datasets/andrewmvd/lung-and-colon-cancer-histopathological-imagesçš„colon_image_sets</a></p><p>æœ¬ä»»åŠ¡æ•°æ®é›†ç”±2ä¸ªç±»åˆ«ç»„æˆçš„10000å¼ ç¬¦åˆHIPAAæ ‡å‡†çš„ç»“è‚ ç»„ç»‡ç—…ç†å­¦å›¾åƒã€‚æ‰€æœ‰å›¾åƒçš„å°ºå¯¸ä¸º$768 <em> 768 </em> 3$ï¼Œä¸ºjpegæ–‡ä»¶æ ¼å¼ã€‚</p><p>ä¸ºäº†è¿›è¡Œå®éªŒï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œåˆ’åˆ†ï¼šæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>æ•°æ®shuffleã€‚</p></li><li><p>åˆ†ä¸ºäº”ä¸ªå­é›†ï¼ŒåŒ…å«ä¸‰ä»½è®­ç»ƒé›†å­é›†ï¼Œå‘½åä¸ºTrain_1, Train_2, Train_3ï¼Œè®­ç»ƒé›†å­é›†å„ä¸‰åƒå¼ å›¾åƒï¼Œä¸€ä»½éªŒè¯é›†å’Œä¸€ä»½æµ‹è¯•é›†å„500å¼ ï¼Œåˆ†åˆ«å‘½åä¸ºvalå’Œtestã€‚ï¼ˆè¿™é‡Œæˆ‘æ²¡æœ‰å¯¹å›¾åƒæœ¬èº«è¿›è¡Œæ”¹åŠ¨ï¼Œè€Œæ˜¯ç”Ÿæˆäº†ä¸€ä¸ªexcelï¼Œæ¯ä¸ªsheetåŒ…å«image_pathå’Œtypeä¸¤åˆ—ï¼Œåˆ†åˆ«å¯¹åº”å›¾åƒçš„ä½ç½®å’Œlabelï¼Œä¸€å…±æœ‰input1ï¼Œinput2ï¼Œinput3ï¼Œvalå’Œtestäº”ä¸ªsheeté¡µï¼‰</p></li></ol><p>ä¸‰ä»½è®­ç»ƒæ•°æ®å’Œä¸€ä»½æµ‹è¯•æ•°æ®å¯¹åº”çš„ä¸‰ç§ç±»å‹çš„å›¾åƒæ•°é‡å¦‚ä¸‹ï¼š</p><div class="table-container"><table><thead><tr><th>Data</th><th>ç»“è‚ ç™Œç»„ç»‡</th><th>è‰¯æ€§ç»„ç»‡</th><th>æ€»è®¡</th></tr></thead><tbody><tr><td>Train_1</td><td>1505</td><td>1495</td><td>3000</td></tr><tr><td>Train_2</td><td>1467</td><td>1533</td><td>3000</td></tr><tr><td>Train_3</td><td>1515</td><td>1485</td><td>3000</td></tr><tr><td>Test</td><td>253</td><td>247</td><td>500</td></tr><tr><td>æ€»è®¡ï¼ˆä¸ç®—Testï¼‰</td><td>4487</td><td>4513</td><td>/</td></tr></tbody></table></div><h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><p>ä¸ºäº†ä¿è¯å•ä¸€å˜é‡å½±å“ï¼Œåœ¨æœ¬åœ°è®­ç»ƒå’Œè”é‚¦è®­ç»ƒçš„æ¨¡å‹å‚æ•°ç›¸åŒï¼Œå…·ä½“å‚æ•°å¦‚ä¸‹è¡¨</p><div class="table-container"><table><thead><tr><th>key</th><th>val</th></tr></thead><tbody><tr><td>å¹³å°</td><td>kaggle</td></tr><tr><td>ç®—æ³•</td><td>åŸºäºImageNet1Ké¢„è®­ç»ƒçš„vgg16æ¨¡å‹</td></tr><tr><td>Epoch</td><td>2</td></tr><tr><td>Batch Size</td><td>16 or 32</td></tr><tr><td>Optimizer</td><td>Adam</td></tr><tr><td>Learning Rate</td><td>1e-5</td></tr><tr><td>Loss</td><td>CrossEntropyLoss</td></tr><tr><td>Metrics</td><td>Accuracy</td></tr></tbody></table></div><h1 id="å®éªŒæ­¥éª¤"><a href="#å®éªŒæ­¥éª¤" class="headerlink" title="å®éªŒæ­¥éª¤"></a>å®éªŒæ­¥éª¤</h1><ol><li><p>ä½¿ç”¨å…¨éƒ¨è®­ç»ƒé›†åœ¨æœ¬åœ°è¿›è¡Œè®­ç»ƒï¼Œåœ¨æµ‹è¯•é›†è¿›è¡Œæ¨¡å‹è¯„ä¼°ã€‚</p></li><li><p>åˆ†åˆ«ä½¿ç”¨ä¸‰ä»½è®­ç»ƒé›†å­é›†åœ¨æœ¬åœ°è¿›è¡Œè®­ç»ƒï¼Œåœ¨æµ‹è¯•é›†è¿›è¡Œæ¨¡å‹è¯„ä¼°ã€‚</p></li><li><p>ä½¿ç”¨FATEå¯¹ä¸‰ä»½è®­ç»ƒé›†å­é›†è¿›è¡Œè”é‚¦è®­ç»ƒï¼Œåœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œæ¨¡å‹è¯„ä¼°ã€‚</p></li></ol><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><blockquote><p>è¿™é‡Œåªåˆ—å‡ºé‡è¦çš„codeï¼Œè¯¦ç»†codeå¯ä»¥å‚è§ï¼š<a href="https://www.kaggle.com/code/guoyujian/colon-cancer101">https://www.kaggle.com/code/guoyujian/colon-cancer101</a></p></blockquote><h2 id="define-params"><a href="#define-params" class="headerlink" title="define params"></a>define params</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">EPOCHS = <span class="number">2</span></span><br><span class="line">BATCH_SIZE = <span class="number">32</span></span><br><span class="line">lr = <span class="number">1e-5</span></span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(device)</span><br></pre></td></tr></table></figure><h2 id="åŠ è½½æ•°æ®"><a href="#åŠ è½½æ•°æ®" class="headerlink" title="åŠ è½½æ•°æ®"></a>åŠ è½½æ•°æ®</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä»å…ƒæ•°æ®ä¸­è¯»å–å›¾åƒçš„pathå’Œlabel</span></span><br><span class="line">metadata_path = <span class="string">&#x27;../input/input-colon/colon_inputs.xls&#x27;</span></span><br><span class="line"><span class="comment"># metadata_path = &#x27;../input/input-colon-cuts/colon_inputs_cuts.xls&#x27;</span></span><br><span class="line">df1 = pd.read_excel(metadata_path, sheet_name = <span class="string">&#x27;input1&#x27;</span>)</span><br><span class="line">df2 = pd.read_excel(metadata_path, sheet_name = <span class="string">&#x27;input2&#x27;</span>)</span><br><span class="line">df3 = pd.read_excel(metadata_path, sheet_name = <span class="string">&#x27;input3&#x27;</span>)</span><br><span class="line">df4 = pd.read_excel(metadata_path, sheet_name = <span class="string">&#x27;val&#x27;</span>)</span><br><span class="line">df5 = pd.read_excel(metadata_path, sheet_name = <span class="string">&#x27;test&#x27;</span>)</span><br><span class="line">df = pd.concat([df1, df2, df3])</span><br><span class="line"></span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…¨éƒ¨çš„å›¾ç‰‡è·¯å¾„å’Œæ ‡ç­¾</span></span><br><span class="line"><span class="comment"># images_all_over = df[&#x27;image_path&#x27;].to_list()</span></span><br><span class="line">images_all_over = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> df[<span class="string">&#x27;image_path&#x27;</span>]:</span><br><span class="line">    item = images_all_over.append(<span class="string">&#x27;../input/lung-and-colon-cancer-histopathological-images/lung_colon_image_set/colon_image_sets/&#x27;</span> + item)</span><br><span class="line">labels_all_over = df[<span class="string">&#x27;type&#x27;</span>].to_list()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;len images_all_over: <span class="subst">&#123;<span class="built_in">len</span>(images_all_over)&#125;</span>; len labels_all_over: <span class="subst">&#123;<span class="built_in">len</span>(labels_all_over)&#125;</span>; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># part1,2,3 &amp; val</span></span><br><span class="line">images_1_over = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> df1[<span class="string">&#x27;image_path&#x27;</span>]:</span><br><span class="line">    item = images_1_over.append(<span class="string">&#x27;../input/lung-and-colon-cancer-histopathological-images/lung_colon_image_set/colon_image_sets/&#x27;</span> + item)</span><br><span class="line">labels_1_over = df1[<span class="string">&#x27;type&#x27;</span>].to_list()</span><br><span class="line"></span><br><span class="line">images_2_over = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> df2[<span class="string">&#x27;image_path&#x27;</span>]:</span><br><span class="line">    item = images_2_over.append(<span class="string">&#x27;../input/lung-and-colon-cancer-histopathological-images/lung_colon_image_set/colon_image_sets/&#x27;</span> + item)</span><br><span class="line">labels_2_over = df2[<span class="string">&#x27;type&#x27;</span>].to_list()</span><br><span class="line"></span><br><span class="line">images_3_over = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> df3[<span class="string">&#x27;image_path&#x27;</span>]:</span><br><span class="line">    item = images_3_over.append(<span class="string">&#x27;../input/lung-and-colon-cancer-histopathological-images/lung_colon_image_set/colon_image_sets/&#x27;</span> + item)</span><br><span class="line">labels_3_over = df3[<span class="string">&#x27;type&#x27;</span>].to_list()</span><br><span class="line"></span><br><span class="line">images_val_over = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> df4[<span class="string">&#x27;image_path&#x27;</span>]:</span><br><span class="line">    item = images_val_over.append(<span class="string">&#x27;../input/lung-and-colon-cancer-histopathological-images/lung_colon_image_set/colon_image_sets/&#x27;</span> + item)</span><br><span class="line">labels_val_over = df4[<span class="string">&#x27;type&#x27;</span>].to_list()</span><br><span class="line"></span><br><span class="line">images_test_over = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> df5[<span class="string">&#x27;image_path&#x27;</span>]:</span><br><span class="line">    item = images_test_over.append(<span class="string">&#x27;../input/lung-and-colon-cancer-histopathological-images/lung_colon_image_set/colon_image_sets/&#x27;</span> + item)</span><br><span class="line">labels_test_over = df5[<span class="string">&#x27;type&#x27;</span>].to_list()</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯¹å…¨éƒ¨æ•°æ®shuffle</span></span><br><span class="line"></span><br><span class="line">shuffle_dataset = np.hstack((np.array(images_all_over).reshape(-<span class="number">1</span>, <span class="number">1</span>), np.array(labels_all_over).reshape(-<span class="number">1</span>, <span class="number">1</span>)))</span><br><span class="line">np.random.shuffle(shuffle_dataset)</span><br><span class="line">images_all_over = shuffle_dataset[:, <span class="number">0</span>].tolist()</span><br><span class="line">labels_all_over = shuffle_dataset[:, <span class="number">1</span>].astype(<span class="built_in">int</span>).tolist()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å®šä¹‰datasetç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Colon_Dataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, image_path, target, train_transform = <span class="literal">None</span>, test_transform = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.image_path = image_path</span><br><span class="line">        self.target = target</span><br><span class="line">        self.train_transform = train_transform</span><br><span class="line">        self.test_transform = test_transform</span><br><span class="line">        self.transform = <span class="literal">None</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.image_path)</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        path = self.image_path[index]</span><br><span class="line">        image = cv2.imread(path)</span><br><span class="line">        label = self.target[index]</span><br><span class="line">        <span class="keyword">if</span> self.transform:</span><br><span class="line">            image = self.transform(image)</span><br><span class="line">        <span class="keyword">return</span> image, label</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">train_mode</span>(<span class="params">self</span>):</span><br><span class="line">        self.transform = self.train_transform</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_mode</span>(<span class="params">self</span>):</span><br><span class="line">        self.transform = self.test_transform</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># define data transform</span></span><br><span class="line">train_transform = transforms.Compose([</span><br><span class="line">    transforms.ToPILImage(),</span><br><span class="line">    transforms.Resize(<span class="number">256</span>),</span><br><span class="line">    transforms.CenterCrop(<span class="number">224</span>),</span><br><span class="line">    transforms.RandomHorizontalFlip(),</span><br><span class="line">    transforms.RandomRotation(<span class="number">10</span>),</span><br><span class="line">    transforms.ColorJitter(),</span><br><span class="line">    transforms.ToTensor(),</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">test_transform = transforms.Compose([</span><br><span class="line">    transforms.ToPILImage(),</span><br><span class="line">    transforms.Resize(<span class="number">256</span>),</span><br><span class="line">    transforms.CenterCrop(<span class="number">224</span>),</span><br><span class="line">    transforms.ToTensor()</span><br><span class="line">])</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…¨éƒ¨è®­ç»ƒæ•°æ®</span></span><br><span class="line">colon_all_dataset = Colon_Dataset(images_all_over, labels_all_over, train_transform, test_transform)</span><br><span class="line">train_loader = DataLoader(colon_all_dataset, batch_size=BATCH_SIZE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‰ä»½è®­ç»ƒæ•°æ®ã€éªŒè¯æ•°æ®å’Œæµ‹è¯•æ•°æ®</span></span><br><span class="line">colon_1_dataset = Colon_Dataset(images_1_over, labels_1_over, train_transform, test_transform)</span><br><span class="line">colon_2_dataset = Colon_Dataset(images_2_over, labels_2_over, train_transform, test_transform)</span><br><span class="line">colon_3_dataset = Colon_Dataset(images_3_over, labels_3_over, train_transform, test_transform)</span><br><span class="line">colon_val_dataset = Colon_Dataset(images_val_over, labels_val_over, train_transform, test_transform)</span><br><span class="line">colon_test_dataset = Colon_Dataset(images_test_over, labels_test_over, train_transform, test_transform)</span><br><span class="line"></span><br><span class="line">train_1_loader = DataLoader(colon_1_dataset, batch_size=BATCH_SIZE)</span><br><span class="line">train_2_loader = DataLoader(colon_2_dataset, batch_size=BATCH_SIZE)</span><br><span class="line">train_3_loader = DataLoader(colon_3_dataset, batch_size=BATCH_SIZE)</span><br><span class="line">val_loader = DataLoader(colon_val_dataset, batch_size=BATCH_SIZE)</span><br><span class="line">test_loader = DataLoader(colon_test_dataset, batch_size=BATCH_SIZE)</span><br></pre></td></tr></table></figure><h2 id="define-a-model"><a href="#define-a-model" class="headerlink" title="define a model"></a>define a model</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Model = models.vgg16(pretrained=<span class="literal">True</span>)</span><br><span class="line">Model.classifier[<span class="number">6</span>] = nn.Linear(in_features=<span class="number">4096</span>, out_features=<span class="number">2</span>, bias=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">Model = Model.to(device)</span><br><span class="line"></span><br><span class="line">optimizer = torch.optim.Adam(Model.parameters() , lr = lr)</span><br><span class="line"></span><br><span class="line">scheduler = torch.optim.lr_scheduler.MultiStepLR(optimizer, milestones=[<span class="number">10</span>, <span class="number">25</span>, <span class="number">50</span>, <span class="number">75</span>, <span class="number">120</span>], gamma=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">loss_fn = nn.CrossEntropyLoss()</span><br></pre></td></tr></table></figure><h2 id="train-amp-val"><a href="#train-amp-val" class="headerlink" title="train&amp;val"></a>train&amp;val</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è®­ç»ƒä¸€è½®</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train_one_epoch</span>(<span class="params">train_loader, model, criterion, optimizer, device</span>):</span><br><span class="line">    model.train()</span><br><span class="line">  </span><br><span class="line">    colon_all_dataset.train_mode()</span><br><span class="line">    colon_1_dataset.train_mode()</span><br><span class="line">    colon_2_dataset.train_mode()</span><br><span class="line">    colon_3_dataset.train_mode()</span><br><span class="line">    colon_val_dataset.train_mode()</span><br><span class="line">  </span><br><span class="line">    size = <span class="built_in">len</span>(train_loader.dataset)</span><br><span class="line">    num_batches = <span class="built_in">len</span>(train_loader)</span><br><span class="line">    losses, correct = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="comment">################################# train #################################</span></span><br><span class="line">    <span class="keyword">for</span> batch, (x, y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(tqdm(train_loader)):</span><br><span class="line">        device = torch.device(device)</span><br><span class="line">        x, y = x.to(device), y.to(device)  </span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        pred = model(x)</span><br><span class="line"></span><br><span class="line">        loss = criterion(pred, y.long().squeeze())</span><br><span class="line"></span><br><span class="line">        current = batch * <span class="built_in">len</span>(x)</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line">        y_pred, y_true = torch.argmax(pred, axis=<span class="number">1</span>), y.long().squeeze()</span><br><span class="line">        correct += (y_pred == y_true).<span class="built_in">type</span>(torch.<span class="built_in">float</span>).<span class="built_in">sum</span>().item()</span><br><span class="line">        losses += loss.item()</span><br><span class="line">    correct /= size</span><br><span class="line">    losses /= num_batches</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Train: Accuracy: <span class="subst">&#123;(<span class="number">100</span>*correct):&gt;<span class="number">0.2</span>f&#125;</span>%, Avg loss: <span class="subst">&#123;losses:&gt;5f&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> losses, correct</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># éªŒè¯ä¸€è½®ï¼Œ éªŒè¯é›†æ•°æ®åŠ è½½ï¼Œæ¨¡å‹ï¼ŒæŸå¤±å‡½æ•°ï¼Œdevice</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">valid_one_epoch</span>(<span class="params">valid_loader, model, criterion, device</span>):</span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line">    colon_all_dataset.train_mode()</span><br><span class="line">    colon_1_dataset.train_mode()</span><br><span class="line">    colon_2_dataset.train_mode()</span><br><span class="line">    colon_3_dataset.train_mode()</span><br><span class="line">    colon_val_dataset.train_mode()</span><br><span class="line">  </span><br><span class="line">    size = <span class="built_in">len</span>(valid_loader.dataset)</span><br><span class="line">    num_batches = <span class="built_in">len</span>(valid_loader)</span><br><span class="line">    losses, correct = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="comment">################################# validation #################################</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">for</span> batch, (x, y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(tqdm(valid_loader)):</span><br><span class="line">            device = torch.device(device)</span><br><span class="line">            x, y = x.to(device), y.to(device)</span><br><span class="line">            pred = model(x)</span><br><span class="line">            loss = criterion(pred, y.long().squeeze())</span><br><span class="line"></span><br><span class="line">            current = batch * <span class="built_in">len</span>(x)</span><br><span class="line">            y_pred, y_true = torch.argmax(pred, axis=<span class="number">1</span>), y.long().squeeze()</span><br><span class="line">            correct += (y_pred == y_true).<span class="built_in">type</span>(torch.<span class="built_in">float</span>).<span class="built_in">sum</span>().item()</span><br><span class="line">            losses += loss.item()</span><br><span class="line">    correct /= size</span><br><span class="line">    losses /= num_batches</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Valid: Accuracy: <span class="subst">&#123;(<span class="number">100</span>*correct):&gt;<span class="number">0.2</span>f&#125;</span>%, Avg loss: <span class="subst">&#123;losses:&gt;5f&#125;</span> \n&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> losses, correct</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train_valid</span>(<span class="params">train_loader,valid_loader, model, criterion, optimizer, scheduler, device, part = <span class="literal">None</span></span>):</span><br><span class="line">    liveloss = PlotLosses()</span><br><span class="line">  </span><br><span class="line">    tolerance = <span class="number">0</span></span><br><span class="line">    best_loss = np.inf</span><br><span class="line">    best_epoch = <span class="number">0</span></span><br><span class="line">    best_acc = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Starting Training...\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, EPOCHS):</span><br><span class="line">        logs = &#123;&#125;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;-------------------------------   Epoch <span class="subst">&#123;epoch + <span class="number">1</span>&#125;</span>   -------------------------------&quot;</span>)</span><br><span class="line"></span><br><span class="line">        train_loss, train_acc = train_one_epoch(train_loader, model, criterion, optimizer, device)</span><br><span class="line">        valid_loss, valid_acc = valid_one_epoch(valid_loader, model, criterion, device)</span><br><span class="line">        scheduler.step()</span><br><span class="line">      </span><br><span class="line">        <span class="comment"># save validation loss if it was improved (reduced) &amp; validation accuracy if it was improved (increased)</span></span><br><span class="line">        <span class="keyword">if</span> valid_loss &lt; best_loss <span class="keyword">and</span> valid_acc &gt; best_acc:</span><br><span class="line">            best_epoch = epoch + <span class="number">1</span></span><br><span class="line">            best_loss = valid_loss</span><br><span class="line">            best_acc = valid_acc</span><br><span class="line">            <span class="comment"># save the model&#x27;s weights and biases</span></span><br><span class="line">            <span class="keyword">if</span> part:</span><br><span class="line">                torch.save(model, <span class="string">f&quot;vgg_ep<span class="subst">&#123;best_epoch&#125;</span>_part<span class="subst">&#123;part&#125;</span>.pth&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>: </span><br><span class="line">                torch.save(model, <span class="string">f&quot;vgg_ep<span class="subst">&#123;best_epoch&#125;</span>.pth&quot;</span>)</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line">        <span class="keyword">if</span> valid_acc &lt; best_acc:</span><br><span class="line">            tolerance += <span class="number">1</span></span><br><span class="line">      </span><br><span class="line">        logs[<span class="string">&#x27;log loss&#x27;</span>] = train_loss</span><br><span class="line">        logs[<span class="string">&#x27;accuracy&#x27;</span>] = train_acc*<span class="number">100</span></span><br><span class="line">        logs[<span class="string">&#x27;val_log loss&#x27;</span>] = valid_loss</span><br><span class="line">        logs[<span class="string">&#x27;val_accuracy&#x27;</span>] = valid_acc*<span class="number">100</span></span><br><span class="line">      </span><br><span class="line">        liveloss.update(logs)</span><br><span class="line">        liveloss.send()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Done!&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># train all</span></span><br><span class="line">train_valid(train_loader,val_loader, Model, loss_fn, optimizer, scheduler, device)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ¨¡å‹æ‹Ÿåˆçš„å¾ˆå¿«</p><p><img src="image-20221101180725-qad0jfu.png" alt="image.png"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 3 parts train </span></span><br><span class="line">train_valid(train_1_loader,val_loader, Model, loss_fn, optimizer, scheduler, device, part = <span class="number">1</span>)</span><br><span class="line">train_valid(train_2_loader,val_loader, Model, loss_fn, optimizer, scheduler, device, part = <span class="number">2</span>)</span><br><span class="line">train_valid(train_3_loader,val_loader, Model, loss_fn, optimizer, scheduler, device, part = <span class="number">3</span>)</span><br></pre></td></tr></table></figure><h2 id="æ¨¡å‹è¯„ä¼°"><a href="#æ¨¡å‹è¯„ä¼°" class="headerlink" title="æ¨¡å‹è¯„ä¼°"></a>æ¨¡å‹è¯„ä¼°</h2><p>è¿™é‡Œæ³¨æ„çš„æ˜¯ä¸éœ€è¦å…ˆå¯¹predè¿›è¡Œsoftmaxï¼Œåœ¨è®¡ç®—lossï¼Œè€Œæ˜¯ç›´æ¥è®¡ç®—lossï¼š</p><p>Ref:<a href="https://blog.csdn.net/DragonGirI/article/details/105743487">pytorch è®¡ç®— CrossEntropyLoss å’Œ softmax æ¿€æ´»å±‚</a></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># test</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_model</span>(<span class="params">test_loader, model, criterion, device</span>):</span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line">    cervical_test_dataset.test_mode()</span><br><span class="line">  </span><br><span class="line">    true_labels = []</span><br><span class="line">    pred_labels = []</span><br><span class="line">    scores = []</span><br><span class="line"></span><br><span class="line">    size = <span class="built_in">len</span>(test_loader.dataset)</span><br><span class="line"></span><br><span class="line">    num_batches = <span class="built_in">len</span>(test_loader)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;size:<span class="subst">&#123;size&#125;</span>; num_batches:<span class="subst">&#123;num_batches&#125;</span>&#x27;</span>)</span><br><span class="line">    losses, correct = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="comment">################################# validation #################################</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">for</span> batch, (x, y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(tqdm(test_loader)):</span><br><span class="line">            device = torch.device(device)</span><br><span class="line">            x, y = x.to(device), y.to(device)</span><br><span class="line">            pred = model(x)</span><br><span class="line"><span class="comment">#             pred = nn.Softmax()(pred)</span></span><br><span class="line"></span><br><span class="line">            loss = criterion(pred, y.long().squeeze()) </span><br><span class="line">            current = batch * <span class="built_in">len</span>(x)</span><br><span class="line">            scores += pred.tolist()</span><br><span class="line">            y_pred, y_true = torch.argmax(pred, axis=<span class="number">1</span>), y.long().squeeze()</span><br><span class="line">            correct += (y_pred == y_true).<span class="built_in">type</span>(torch.<span class="built_in">float</span>).<span class="built_in">sum</span>().item()</span><br><span class="line">            loss, current = np.<span class="built_in">round</span>(loss.item(), <span class="number">5</span>), batch * <span class="built_in">len</span>(x)</span><br><span class="line">            true_labels += y_true.detach().cpu().tolist()</span><br><span class="line">            pred_labels += y_pred.detach().cpu().tolist()</span><br><span class="line">            losses += loss.item()</span><br><span class="line">    correct /= size</span><br><span class="line">    losses /= num_batches</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Test: Accuracy: <span class="subst">&#123;(<span class="number">100</span>*correct):&gt;<span class="number">0.2</span>f&#125;</span>%, Avg loss: <span class="subst">&#123;losses:&gt;5f&#125;</span> \n&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> np.array(true_labels), np.array(pred_labels), np.array(scores)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">test_model_obj = torch.load(<span class="string">&#x27;æ¨¡å‹æ–‡ä»¶path&#x27;</span>)</span><br><span class="line">test_model_obj = test_model_obj.to(device)</span><br><span class="line">test_model(test_loader, test_model_obj, loss_fn, device)</span><br></pre></td></tr></table></figure><h1 id="å®éªŒç»“æœ"><a href="#å®éªŒç»“æœ" class="headerlink" title="å®éªŒç»“æœ"></a>å®éªŒç»“æœ</h1><div class="table-container"><table><thead><tr><th>ä½¿ç”¨çš„æ•°æ®</th><th>è¯„ä¼°ç»“æœ</th></tr></thead><tbody><tr><td>å…¨éƒ¨è®­ç»ƒæ•°æ®ï¼ˆTrain_1+Train_2+Train_3ï¼‰</td><td>Accuracy: 99.60%, Avg loss: 0.011775</td></tr><tr><td>Train_1</td><td>Accuracy: 73.20%, Avg loss: 0.641481</td></tr><tr><td>Train_2</td><td>Accuracy: 71.40%, Avg loss: 0.649055</td></tr><tr><td>Train_3</td><td>Accuracy: 56.80%, Avg loss: 0.654335</td></tr></tbody></table></div><h1 id="å®éªŒåˆ†æ"><a href="#å®éªŒåˆ†æ" class="headerlink" title="å®éªŒåˆ†æ"></a>å®éªŒåˆ†æ</h1><p>è§ä¸‹ç¯‡</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬æ¡ˆä¾‹åˆ†ä¸Šä¸‹ä¸¤ç¯‡ï¼Œä¸Šç¯‡ä»‹ç»è‚ ç™Œå›¾åƒåˆ†ç±»ä»»åŠ¡çš„æœ¬åœ°baselineï¼Œä¸‹ç¯‡ä»‹ç»å°†è‚ ç™Œå›¾åƒåˆ†ç±»ä»»åŠ¡ç§»æ¤åˆ°FATEä¸Šï¼Œå®ç°è”é‚¦å­¦ä¹ ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ä»»åŠ¡ç›®æ ‡&quot;&gt;&lt;a href=&quot;#ä»»åŠ¡ç›®æ ‡&quot; class=&quot;headerlink&quot; title=&quot;ä»»åŠ¡ç›®æ ‡&quot;&gt;&lt;/a&gt;ä»»åŠ¡ç›®æ ‡</summary>
      
    
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/categories/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/tags/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>FATEæ¨ªå‘è”é‚¦å­¦ä¹ ï¼šæ‰‹å†™æ•°å­—è¯†åˆ«</title>
    <link href="https://guoyujian.github.io/2022/11/04/FATE%E6%A8%AA%E5%90%91%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%EF%BC%9A%E6%89%8B%E5%86%99%E6%95%B0%E5%AD%97%E8%AF%86%E5%88%AB/"/>
    <id>https://guoyujian.github.io/2022/11/04/FATE%E6%A8%AA%E5%90%91%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%EF%BC%9A%E6%89%8B%E5%86%99%E6%95%B0%E5%AD%97%E8%AF%86%E5%88%AB/</id>
    <published>2022-11-03T16:04:59.000Z</published>
    <updated>2022-11-03T16:06:33.144Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä¸Šä¸Šä¸€ç¯‡ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨FATEå‘èµ·ä¸€ä¸ªæ¨ªå‘è”é‚¦å­¦ä¹ ä»»åŠ¡ï¼Œä½¿ç”¨çš„æ•°æ®æ ¼å¼æ˜¯ç»“æ„åŒ–çš„æ•°æ®ï¼Œä½¿ç”¨çš„ç®—æ³•æ˜¯ç»å…¸çš„LRç®—æ³•ã€‚</p><p>èƒ½ä¸èƒ½ä½¿ç”¨FATEåšè®¡ç®—æœºè§†è§‰çš„ç¥ç»ç½‘ç»œçš„è”é‚¦å­¦ä¹ å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚æœ¬ç¯‡å°±é€šè¿‡æ‰‹å†™æ•°å­—è¯†åˆ«è¿™ä¸€ç»å…¸ä»»åŠ¡æ¥å­¦ä¹ å¦‚ä½•ä½¿ç”¨FATEæ¥å®Œæˆä¸€ä¸ªè®¡ç®—æœºè§†è§‰æ–¹é¢çš„ç¥ç»ç½‘ç»œç®—æ³•çš„è”é‚¦å­¦ä¹ job</p></blockquote><p>â€</p><h1 id="å®éªŒç¯å¢ƒ"><a href="#å®éªŒç¯å¢ƒ" class="headerlink" title="å®éªŒç¯å¢ƒ"></a>å®éªŒç¯å¢ƒ</h1><p>fate standalone 1.9.0</p><ul><li>æ•°æ®é›†mnistï¼š<code>/data/projects/fate/examples/data/mnist_train</code></li><li>code:<code>/data/projects/fate/examples/dsl/v2/homo_nn/mnist_demo</code></li></ul><blockquote><p>æœ€å¥½æŠŠè¿™å‡ ä¸ªæ–‡ä»¶å¤¹å¤åˆ¶å‡ºæ¥ï¼Œå†æ”¹</p></blockquote><p>codeæ–‡ä»¶å¤¹ä¸­æœ‰ä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼Œåé¢éœ€è¦ç”¨åˆ°ã€‚</p><p>â€</p><p>åœ¨README.mdä¸­å·²ç»å†™å‡ºäº†ç”¨æ³•ï¼Œæœ¬ç¯‡å°†è¯¦ç»†è®²è§£ã€‚</p><p><img src="image-20221028155604-ny1t6o7.png" alt="image.png"></p><p>â€</p><h1 id="å®éªŒæ­¥éª¤"><a href="#å®éªŒæ­¥éª¤" class="headerlink" title="å®éªŒæ­¥éª¤"></a>å®éªŒæ­¥éª¤</h1><h2 id="ä¸‹è½½æ•°æ®é›†"><a href="#ä¸‹è½½æ•°æ®é›†" class="headerlink" title="ä¸‹è½½æ•°æ®é›†"></a>ä¸‹è½½æ•°æ®é›†</h2><p>æ‰§è¡Œ<code>fate_test data download -t mnist</code>å‘½ä»¤ä¸‹è½½mnistæ•°æ®é›†ï¼Œä¸‹è½½çš„ä½ç½®ä½äº<code>FATE/examples/data/mnist_train</code></p><h2 id="ç»‘å®šæ•°æ®"><a href="#ç»‘å®šæ•°æ®" class="headerlink" title="ç»‘å®šæ•°æ®"></a>ç»‘å®šæ•°æ®</h2><p>ä¿®æ”¹bind_local_path.jsonçš„address.pathä¸ºæ•°æ®é›†æ–‡ä»¶å¤¹æ‰€åœ¨çš„ä½ç½®ï¼Œä¿®æ”¹åå¦‚ä¸‹ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;engine&quot;</span>: <span class="string">&quot;PATH&quot;</span>,</span><br><span class="line">    <span class="string">&quot;namespace&quot;</span>: <span class="string">&quot;experiment&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;mnist_images&quot;</span>,</span><br><span class="line">    <span class="string">&quot;address&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/data/projects/fate/examples/data/mnist_train&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å®Œæˆåæ‰§è¡Œ<code>flow table bind -c bind_local_path.json</code>å‘½ä»¤è¿›è¡Œæ•°æ®ç»‘å®šã€‚è¿™æ ·ä¸€æ¥ï¼Œæ–‡ä»¶å¤¹ä¸­çš„æ•°æ®å°±å’Œå‘½åç©ºé—´ä¸ºexperimentï¼Œè¡¨åä¸ºmnist_imagesçš„è¡¨å…³è”äº†èµ·æ¥ã€‚</p><p>è¿”å›ç±»ä¼¼å³ç»‘å®šæˆåŠŸã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;retcode&quot;</span>: 0,</span><br><span class="line"><span class="string">&quot;retmsg&quot;</span>: <span class="string">&quot;success&quot;</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®æ–‡ä»¶å¹¶æäº¤job"><a href="#é…ç½®æ–‡ä»¶å¹¶æäº¤job" class="headerlink" title="é…ç½®æ–‡ä»¶å¹¶æäº¤job"></a>é…ç½®æ–‡ä»¶å¹¶æäº¤job</h2><p>mnist_dsl.jsonæ–‡ä»¶ï¼š</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;components&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;reader_0&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Reader&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;data&quot;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;homo_nn_0&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HomoNN&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;input&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;train_data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                        <span class="string">&quot;reader_0.data&quot;</span></span><br><span class="line">                    <span class="punctuation">]</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;output&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;data&quot;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;model&quot;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>mnist_conf.jsonæ–‡ä»¶ï¼š</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;dsl_version&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;initiator&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;guest&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;party_id&quot;</span><span class="punctuation">:</span> <span class="number">9999</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;arbiter&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="number">9999</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;host&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="number">9999</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;guest&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="number">9999</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;component_parameters&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;common&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;homo_nn_0&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;api_version&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;encode_label&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;max_iter&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;batch_size&quot;</span><span class="punctuation">:</span> <span class="number">32</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;early_stop&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;early_stop&quot;</span><span class="punctuation">:</span> <span class="string">&quot;diff&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;eps&quot;</span><span class="punctuation">:</span> <span class="number">0.0001</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;optimizer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;lr&quot;</span><span class="punctuation">:</span> <span class="number">0.001</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;optimizer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Adam&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;loss&quot;</span><span class="punctuation">:</span> <span class="string">&quot;NLLLoss&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;metrics&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;accuracy&quot;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;nn_define&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Conv2d&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;in_channels&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;out_channels&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;kernel_size&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="number">5</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MaxPool2d&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;kernel_size&quot;</span><span class="punctuation">:</span> <span class="number">2</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ReLU&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Conv2d&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;in_channels&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;out_channels&quot;</span><span class="punctuation">:</span> <span class="number">20</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;kernel_size&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="number">5</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Dropout2d&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MaxPool2d&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;kernel_size&quot;</span><span class="punctuation">:</span> <span class="number">2</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ReLU&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Flatten&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Linear&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;in_features&quot;</span><span class="punctuation">:</span> <span class="number">320</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;out_features&quot;</span><span class="punctuation">:</span> <span class="number">50</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ReLU&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Linear&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;in_features&quot;</span><span class="punctuation">:</span> <span class="number">50</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;out_features&quot;</span><span class="punctuation">:</span> <span class="number">10</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;layer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;LogSoftmax&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;config_type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pytorch&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;host&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;0&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;reader_0&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;table&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mnist_images&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">&quot;namespace&quot;</span><span class="punctuation">:</span> <span class="string">&quot;experiment&quot;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;guest&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;0&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;reader_0&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;table&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mnist_images&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">&quot;namespace&quot;</span><span class="punctuation">:</span> <span class="string">&quot;experiment&quot;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ<code>flow job submit -c mnist_conf.json -d mnist_dsl.json</code>å‘½ä»¤æäº¤jobï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@693afd940463 mnist_demo]<span class="comment"># flow job submit -c mnist_conf.json -d mnist_dsl.json </span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;board_url&quot;</span>: <span class="string">&quot;http://127.0.0.1:8080/index.html#/dashboard?job_id=202209210827526887030&amp;role=guest&amp;party_id=10000&quot;</span>,</span><br><span class="line">        <span class="string">&quot;code&quot;</span>: 0,</span><br><span class="line">        <span class="string">&quot;dsl_path&quot;</span>: <span class="string">&quot;/data/projects/fate/fateflow/jobs/202209210827526887030/job_dsl.json&quot;</span>,</span><br><span class="line">        <span class="string">&quot;job_id&quot;</span>: <span class="string">&quot;202209210827526887030&quot;</span>,</span><br><span class="line">        <span class="string">&quot;logs_directory&quot;</span>: <span class="string">&quot;/data/projects/fate/fateflow/logs/202209210827526887030&quot;</span>,</span><br><span class="line">        <span class="string">&quot;message&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">        <span class="string">&quot;model_info&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;model_id&quot;</span>: <span class="string">&quot;arbiter-10000#guest-10000#host-10000#model&quot;</span>,</span><br><span class="line">            <span class="string">&quot;model_version&quot;</span>: <span class="string">&quot;202209210827526887030&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;pipeline_dsl_path&quot;</span>: <span class="string">&quot;/data/projects/fate/fateflow/jobs/202209210827526887030/pipeline_dsl.json&quot;</span>,</span><br><span class="line">        <span class="string">&quot;runtime_conf_on_party_path&quot;</span>: <span class="string">&quot;/data/projects/fate/fateflow/jobs/202209210827526887030/guest/10000/job_runtime_on_party_conf.json&quot;</span>,</span><br><span class="line">        <span class="string">&quot;runtime_conf_path&quot;</span>: <span class="string">&quot;/data/projects/fate/fateflow/jobs/202209210827526887030/job_runtime_conf.json&quot;</span>,</span><br><span class="line">        <span class="string">&quot;train_runtime_conf_path&quot;</span>: <span class="string">&quot;/data/projects/fate/fateflow/jobs/202209210827526887030/train_runtime_conf.json&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;jobId&quot;</span>: <span class="string">&quot;202209210827526887030&quot;</span>,</span><br><span class="line">    <span class="string">&quot;retcode&quot;</span>: 0,</span><br><span class="line">    <span class="string">&quot;retmsg&quot;</span>: <span class="string">&quot;success&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨flow-testæäº¤Job"><a href="#ä½¿ç”¨flow-testæäº¤Job" class="headerlink" title="ä½¿ç”¨flow-testæäº¤Job"></a>ä½¿ç”¨flow-testæäº¤Job</h2><p>é™¤äº†ä¸Šè¿°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å¿«é€Ÿæäº¤ä¸€ä¸ªjobã€‚</p><p>flow-test å¿«é€Ÿçš„flowæµ‹è¯•ï¼Œæ¯”è¾ƒæ–¹ä¾¿ï¼Œåªéœ€è¦ä¿®æ”¹mnist_nn_testsuite.jsonå¹¶æ‰§è¡Œä¸€æ¬¡å‘½ä»¤å³å¯ã€‚ä»–æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>ä¸éœ€è¦æå‰ç»‘å®šæ•°æ®ï¼Œæ‰§è¡Œå®Œæˆåï¼Œä¹Ÿä¸å­˜åœ¨è¢«ç»‘å®šçš„æ•°æ®</li><li>æ—¥å¿—ä¼šä¿å­˜åœ¨åˆ°æœ¬åœ°ç›®å½•logs</li><li>ä¸ä¼šäº§ç”Ÿmodel_idå’Œmodel_version</li></ul><p>ä¸‹é¢ä»‹ç»æ‰§è¡Œæ­¥éª¤ï¼š</p><h3 id="ä¿®æ”¹mnist-nn-testsuite-json"><a href="#ä¿®æ”¹mnist-nn-testsuite-json" class="headerlink" title="ä¿®æ”¹mnist_nn_testsuite.json"></a>ä¿®æ”¹<code>mnist_nn_testsuite.json</code></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;engine&quot;</span>: <span class="string">&quot;PATH&quot;</span>,</span><br><span class="line">            <span class="string">&quot;namespace&quot;</span>: <span class="string">&quot;experiment&quot;</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;mnist_images&quot;</span>,</span><br><span class="line">            <span class="string">&quot;address&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/data/projects/fate/work/mnist_fed/mnist_images&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;role&quot;</span>: <span class="string">&quot;guest_0&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;engine&quot;</span>: <span class="string">&quot;PATH&quot;</span>,</span><br><span class="line">            <span class="string">&quot;namespace&quot;</span>: <span class="string">&quot;experiment&quot;</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;mnist_images&quot;</span>,</span><br><span class="line">            <span class="string">&quot;address&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/data/projects/fate/work/mnist_fed/mnist_images&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;role&quot;</span>: <span class="string">&quot;host_0&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;tasks&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;mnist&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;conf&quot;</span>: <span class="string">&quot;./mnist_conf.json&quot;</span>,</span><br><span class="line">            <span class="string">&quot;dsl&quot;</span>: <span class="string">&quot;./mnist_dsl.json&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ‰§è¡Œflow-test"><a href="#æ‰§è¡Œflow-test" class="headerlink" title="æ‰§è¡Œflow-test"></a>æ‰§è¡Œflow-test</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fate_test suite -i mnist_nn_testsuite.json</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="image-20220922142054-e4f41jc.png" alt="image.png"></p><p>â€</p><h1 id="æ¨¡å‹è¯„ä¼°"><a href="#æ¨¡å‹è¯„ä¼°" class="headerlink" title="æ¨¡å‹è¯„ä¼°"></a>æ¨¡å‹è¯„ä¼°</h1><p>ä¸Šè¿°è®­ç»ƒå®Œæˆä¹‹åï¼Œå¦‚ä½•è¿›è¡Œè¯„ä¼°æœ¬æ¬¡è®­ç»ƒå¾—åˆ°çš„æ¨¡å‹æ•ˆæœå‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼šæˆªæ­¢åˆ°1.9.0ç‰ˆæœ¬ï¼ŒFATEè¿˜æš‚ä¸æ”¯æŒå¯¹è®¡ç®—æœºè§†è§‰ç±»ä»»åŠ¡è¿›è¡Œæ¨¡å‹è¯„ä¼°ã€‚ã€‚ã€‚</p><p>æˆ‘çš„åšæ³•æ˜¯ï¼Œ<strong>ç›´æ¥åœ¨FATE-FLOWä¸­æ‰¾åˆ°Jobç”Ÿæˆçš„æ¨¡å‹æ–‡ä»¶ï¼Œè‡ªè¡Œå®ç°å¯¹æ¨¡å‹çš„è¯„ä¼°ã€‚</strong></p><p>è¦åšåˆ°è¿™ä¸€ç‚¹éœ€è¦ç†Ÿæ‚‰æºç ã€‚</p><h1 id="ä»Howåˆ°Why"><a href="#ä»Howåˆ°Why" class="headerlink" title="ä»Howåˆ°Why"></a>ä»Howåˆ°Why</h1><p>å‰é¢æˆ‘ä»¬äº†è§£äº†FATEæäº¤ä¸€ä¸ªè§†è§‰åˆ†ç±»ä»»åŠ¡çš„åŸºæœ¬æµç¨‹ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šæœªçŸ¥çš„ä¸œè¥¿ï¼šæ¯”å¦‚ä¸ºä»€ä¹ˆè¦è¿™æ ·ç»„ç»‡æ•°æ®ï¼ŒFATEæ˜¯å¦‚ä½•è¯»å–é…ç½®åˆ›å»ºæ¨¡å‹çš„ï¼Œè”é‚¦å­¦ä¹ ç»“æŸåä¿å­˜çš„æ¨¡å‹åœ¨å“ªé‡Œï¼Œå¦‚ä½•è°ƒç”¨ï¼Ÿ</p><p>æƒ³è¦çŸ¥é“è¿™äº›éœ€è¦è¯»æ‡‚FATEæºç ã€‚</p><h1 id="æºç ï¼ˆéƒ¨åˆ†ï¼‰"><a href="#æºç ï¼ˆéƒ¨åˆ†ï¼‰" class="headerlink" title="æºç ï¼ˆéƒ¨åˆ†ï¼‰"></a>æºç ï¼ˆéƒ¨åˆ†ï¼‰</h1><p>è¯¥éƒ¨åˆ†ä»‹ç»FATEæ˜¯å¦‚ä½•æ ¹æ®DSLå’ŒCONFé…ç½®è¯»å…¥æ•°æ®ã€åˆ›å»ºå’Œè®­ç»ƒæ¨¡å‹ä»¥åŠå¯¼å‡ºæ¨¡å‹çš„ã€‚</p><p>è¿™é‡Œå…ˆä»‹ç»ä¸€äº›æ¯”è¾ƒé‡è¦çš„ç›®å½•ï¼š</p><blockquote><ul><li><a href="https://github.com/FederatedAI/FATEï¼š">https://github.com/FederatedAI/FATEï¼š</a> FATEå®˜æ–¹å¼€æºçš„æ ¹ç›®å½•</li><li><a href="https://github.com/FederatedAI/FATE/tree/master/python/federatedmlï¼šFATEè”é‚¦å­¦ä¹ ç®—æ³•ç»„ä»¶çš„æºç ç›®å½•ï¼Œä¹Ÿæ˜¯åé¢é‡ç‚¹ç ”ç©¶çš„ç›®å½•ï¼Œè¯»æ‡‚è¯¥ç›®å½•ä¸‹çš„æºç å°±å¯ä»¥å¼€å§‹å¼€å‘æ–°çš„ç®—æ³•ç»„ä»¶ã€‚">https://github.com/FederatedAI/FATE/tree/master/python/federatedmlï¼šFATEè”é‚¦å­¦ä¹ ç®—æ³•ç»„ä»¶çš„æºç ç›®å½•ï¼Œä¹Ÿæ˜¯åé¢é‡ç‚¹ç ”ç©¶çš„ç›®å½•ï¼Œè¯»æ‡‚è¯¥ç›®å½•ä¸‹çš„æºç å°±å¯ä»¥å¼€å§‹å¼€å‘æ–°çš„ç®—æ³•ç»„ä»¶ã€‚</a></li><li><a href="https://github.com/FederatedAI/FATE-Flow/tree/3afbc3e5d335ac96634eadfc493c4c697ecbfc19/python/fate_flow/appsï¼šFATE">https://github.com/FederatedAI/FATE-Flow/tree/3afbc3e5d335ac96634eadfc493c4c697ecbfc19/python/fate_flow/appsï¼šFATE</a> APIæºç ç›®å½•ï¼Œå¯ä»¥åœ¨è¿™é‡Œå¼€å‘æ–°çš„API</li></ul></blockquote><p>â€</p><p>ä»ä¸Šé¢çš„æ¡ˆä¾‹ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨çš„æ˜¯HomoNNç®—æ³•ç»„ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è¦æ‰¾åˆ°NNå¯¹åº”çš„ä½ç½®ï¼š<a href="https://github.com/FederatedAI/FATE/tree/master/python/federatedml/nnï¼Œè¿™é‡Œnnæ˜¯ç¥ç»ç½‘ç»œçš„æ„æ€ã€‚">https://github.com/FederatedAI/FATE/tree/master/python/federatedml/nnï¼Œè¿™é‡Œnnæ˜¯ç¥ç»ç½‘ç»œçš„æ„æ€ã€‚</a></p><p>åœ¨è¯¥ç›®å½•ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼š</p><ul><li>backendï¼šå…¬å…±åç«¯ä»£ç </li><li>hetero_nnï¼šçºµå‘nnç»„ä»¶</li><li>homo_nnï¼šæ¨ªå‘nnç»„ä»¶</li></ul><p>è¿™ä¸‰ä¸ªæ–‡ä»¶å¤¹ä¸­æ˜¯éœ€è¦é‡ç‚¹è¯»æ‡‚çš„ä»£ç ã€‚</p><p>é¦–å…ˆï¼Œè¿™é‡Œæ˜ç¡®ï¼Œæˆ‘ä»¬è¦å¼„æ‡‚çš„é—®é¢˜ï¼š</p><ol><li>å›¾åƒæ•°æ®æ˜¯å¦‚ä½•inputçš„</li><li>ä¸ºä»€ä¹ˆåšå›¾åƒä»»åŠ¡æ—¶ï¼Œæ•°æ®çš„ç»„ç»‡å½¢å¼è¦åˆ†ä¸ºimages/ã€config.yamlã€filenamesä»¥åŠtargets</li><li>FATEæ˜¯å¦‚ä½•æ ¹æ®CONFç”Ÿæˆæ¨¡å‹ï¼Œoptimizerç­‰ç®—æ³•å‚æ•°çš„ã€‚</li><li>FATEæ˜¯å¦‚ä½•è¿›è¡Œè®­ç»ƒçš„ã€‚</li><li>FATEæ˜¯å¦æ”¯æŒä½¿ç”¨é¢„è®­ç»ƒçš„æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œæ˜¯å¦æ”¯æŒä½¿ç”¨GPUè¿›è¡Œè®­ç»ƒï¼Œæ˜¯å¦å¯ä»¥è‡ªå®šä¹‰æ·»åŠ logç­‰ç­‰ï¼Œå¦‚æœä¸èƒ½ï¼Œå¯å¦å¼€å‘è‡ªå·±çš„ç»„ä»¶æ¥å®ç°ã€‚</li><li>å¦‚æœä½¿ç”¨é…ç½®å®šä¹‰æ¨¡å‹ï¼Œé‚£ä¹ˆFATEæ”¯æŒçš„layerä»¥åŠå‚æ•°æœ‰å“ªäº›ï¼Ÿ</li></ol><p>å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥å­¦ä¹ æºç ã€‚</p><h2 id="enter-point-py"><a href="#enter-point-py" class="headerlink" title="enter_point.py"></a>enter_point.py</h2><p>enter_pointæ˜¯homo_nnç»„ä»¶è¢«è°ƒç”¨çš„èµ·ç‚¹ï¼ˆå­˜ç–‘ï¼‰ï¼Œæ–‡ä»¶ä½ç½®ï¼š<a href="https://github.com/FederatedAI/FATE/blob/master/python/federatedml/nn/homo_nn/enter_point.py">https://github.com/FederatedAI/FATE/blob/master/python/federatedml/nn/homo_nn/enter_point.py</a></p><p>é‡ç‚¹å…³æ³¨<code>HomoNNClient</code>ç±»ã€‚å®ƒåŒ…å«å‡ ä¸ªé‡è¦çš„æ–¹æ³•ï¼š</p><ul><li>fitï¼šæ¨¡å‹è®­ç»ƒ</li><li>predictï¼šæ¨¡å‹é¢„æµ‹</li><li>export_modelå’Œload_modelï¼šæ¨¡å‹çš„å¯¼å‡ºå’ŒåŠ è½½ã€‚</li></ul><h3 id="fit"><a href="#fit" class="headerlink" title="fit"></a>fit</h3><p>ä»¥ä¸‹æ˜¯è¯¥æ–¹æ³•çš„ä¸»è¦ä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fit</span>(<span class="params">self, data, *args</span>):</span><br><span class="line">...</span><br><span class="line">        <span class="keyword">from</span> federatedml.nn.homo_nn._torch <span class="keyword">import</span> build_trainer</span><br><span class="line">...</span><br><span class="line">        self._trainer, dataloader = build_trainer(</span><br><span class="line">            param=self.param,</span><br><span class="line">            data=data,</span><br><span class="line">            should_label_align=<span class="keyword">not</span> self.component_properties.is_warm_start,</span><br><span class="line">            trainer=self._trainer,</span><br><span class="line">        ) <span class="comment"># è°ƒç”¨build_trainerè·å–trainerå’Œdataloader</span></span><br><span class="line">        self._trainer.fit(dataloader) <span class="comment"># æ‰§è¡Œè®­ç»ƒ</span></span><br><span class="line">        self.set_summary(self._trainer.summary())</span><br><span class="line">        <span class="comment"># save model to local filesystem</span></span><br><span class="line">        self._trainer.save_checkpoint()</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°trainerå’Œdataloaderæ˜¯é€šè¿‡è°ƒç”¨build_trainerè¿”å›çš„ã€‚</p><p>â€</p><h2 id="torch-py"><a href="#torch-py" class="headerlink" title="_torch.py"></a>_torch.py</h2><p>è¿™æ˜¯FATEè¿›è¡Œè”é‚¦å­¦ä¹ ï¼Œhomo_nnç»„ä»¶çš„ä¸»è¦å®ç°ä»£ç ã€‚</p><h3 id="build-trainer"><a href="#build-trainer" class="headerlink" title="build_trainer"></a>build_trainer</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">build_trainer</span>(<span class="params">param: HomoNNParam, data, should_label_align=<span class="literal">True</span>, trainer=<span class="literal">None</span></span>):</span><br><span class="line">    ...</span><br><span class="line">    pl_trainer = pl.Trainer(</span><br><span class="line">        max_epochs=total_epoch,</span><br><span class="line">        callbacks=[EarlyStopCallback(context)],</span><br><span class="line">        num_sanity_val_steps=<span class="number">0</span>,</span><br><span class="line">    )</span><br><span class="line">    ...</span><br><span class="line">    pl_model = FedLightModule(</span><br><span class="line">        context,</span><br><span class="line">        layers_config=param.nn_define,</span><br><span class="line">        optimizer_config=param.optimizer,</span><br><span class="line">        loss_config=&#123;<span class="string">&quot;loss&quot;</span>: param.loss&#125;,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    dataset = make_dataset(</span><br><span class="line">        data=data,</span><br><span class="line">        is_train=should_label_align,</span><br><span class="line">        expected_label_type=expected_label_type,</span><br><span class="line">    )</span><br><span class="line">    ...</span><br><span class="line">    dataloader = torch.utils.data.DataLoader(</span><br><span class="line">        dataset=dataset, batch_size=batch_size, num_workers=<span class="number">1</span></span><br><span class="line">    )</span><br><span class="line"><span class="keyword">return</span> trainer, dataloader</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°datasetæ˜¯è°ƒç”¨make_datasetæ–¹æ³•å¾—åˆ°ï¼Œmodelæ˜¯FedLightModuleçš„å®ä¾‹åŒ–å¯¹è±¡ã€‚</p><p>â€</p><h3 id="make-dataset"><a href="#make-dataset" class="headerlink" title="make_dataset"></a>make_dataset</h3><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œå›¾åƒæ•°æ®ï¼Œæ˜¯é€šè¿‡VisionDataSetå®ä¾‹åŒ–å¾—åˆ°çš„ã€‚å…·ä½“VisionDataSetåé¢å†è°ˆã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">make_dataset</span>(<span class="params">data, **kwargs</span>):</span><br><span class="line">    <span class="keyword">if</span> is_table(data):</span><br><span class="line">        dataset = TableDataSet(data_instances=data, **kwargs)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(data, LocalData):</span><br><span class="line">        dataset = VisionDataSet(data.path, **kwargs)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">f&quot;data type <span class="subst">&#123;data&#125;</span> not supported&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dataset</span><br></pre></td></tr></table></figure><p>â€</p><h3 id="FedLightModule-init"><a href="#FedLightModule-init" class="headerlink" title="FedLightModule.init()"></a>FedLightModule.<strong>init</strong>()</h3><p>å…³æ³¨<code>FedLightModule</code>è¿™ä¸ªç±»ã€‚è¯¥ç±»ç»§æ‰¿äº†<code>LightningModule</code>ã€‚è¿™ä¸œè¥¿çœ‹ä¸Šå»æ˜¯ä¸€ä¸ªå°†pytorchè½»é‡åŒ–ã€è§„èŒƒåŒ–çš„åº“ã€‚</p><p>è¯¥ç±»æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š</p><ul><li><strong>init</strong>ï¼šåˆå§‹åŒ–</li><li>forwardï¼šå‰å‘ä¼ æ’­</li><li>training_stepï¼šæ¯ä¸ªbatchè®­ç»ƒçš„æ‰§è¡Œä»£ç ï¼Œä¼ å…¥batchå’Œbatch_idxï¼Œè¿”å›loss</li><li>validation_stepï¼šæ¯ä¸ªbatchéªŒè¯çš„æ‰§è¡Œä»£ç ï¼Œä¼ å…¥batchå’Œbatch_idxï¼Œè¿”å›losså’Œacc</li><li>validation_epoch_endï¼šæ¯ä¸ªepochç»“æŸåæ‰§è¡Œï¼Œè¾“å…¥çš„æ˜¯æ‰€æœ‰batchçš„outputsï¼Œæ‰“å°è¯¥epochçš„local losså’Œlocal accã€‚ï¼ˆlocalçš„æ„æ€æ˜¯ï¼ŒåªåŸºäºè‡ªå·±è¿™ä¸€æ–¹çš„æ•°æ®è®¡ç®—çš„ç»“æœï¼‰</li><li>configure_optimizersï¼šé…ç½®optimizer</li></ul><p>åœ¨initæ–¹æ³•ä¸­ï¼Œéå¸¸æ¸…æ™°çš„å¯ä»¥çœ‹åˆ°ï¼Œmodelã€losså’Œoptimizeræ˜¯å¦‚ä½•è¯»å–é…ç½®å®šä¹‰å‡ºæ¥çš„ã€‚</p><p>modelæ˜¯é€šè¿‡è¯»å–é…ç½®ä¸­çš„layer_configï¼Œç”Ÿæˆæ¨¡å‹çš„æ¯ä¸€å±‚ï¼Œç„¶ååœ¨â€œç»„è£…èµ·æ¥â€ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params"></span></span><br><span class="line"><span class="params">    self,</span></span><br><span class="line"><span class="params">    context: PyTorchSAClientContext,</span></span><br><span class="line"><span class="params">    layers_config: typing.<span class="type">List</span>[typing.Mapping],</span></span><br><span class="line"><span class="params">    optimizer_config: types.SimpleNamespace,</span></span><br><span class="line"><span class="params">    loss_config: typing.Mapping,</span></span><br><span class="line"><span class="params"></span>):</span><br><span class="line">    <span class="built_in">super</span>().__init__()</span><br><span class="line">    self.save_hyperparameters()</span><br><span class="line">    self.context = context</span><br><span class="line"></span><br><span class="line">    <span class="comment"># model</span></span><br><span class="line">    layers = []</span><br><span class="line">    <span class="keyword">for</span> layer_config <span class="keyword">in</span> layers_config:</span><br><span class="line">        layer_name = layer_config[<span class="string">&quot;layer&quot;</span>]</span><br><span class="line">        layer_kwargs = &#123;k: v <span class="keyword">for</span> k, v <span class="keyword">in</span> layer_config.items() <span class="keyword">if</span> k != <span class="string">&quot;layer&quot;</span>&#125;</span><br><span class="line">        layers.append(get_layer_fn(layer_name, layer_kwargs))</span><br><span class="line">    self.model = nn.Sequential(*layers)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># loss</span></span><br><span class="line">    loss_name = loss_config[<span class="string">&quot;loss&quot;</span>]</span><br><span class="line">    loss_kwargs = &#123;k: v <span class="keyword">for</span> k, v <span class="keyword">in</span> loss_config.items() <span class="keyword">if</span> k != <span class="string">&quot;loss&quot;</span>&#125;</span><br><span class="line">    self.loss_fn, self.expected_label_type = get_loss_fn(loss_name, loss_kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># optimizer</span></span><br><span class="line">    self._optimizer_name = optimizer_config.optimizer</span><br><span class="line">    self._optimizer_kwargs = optimizer_config.kwargs</span><br><span class="line"></span><br><span class="line">    self.num_data_consumed = <span class="number">0</span></span><br><span class="line">    self._all_consumed_data_aggregated = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    self._should_early_stop = <span class="literal">False</span></span><br><span class="line">    self._loss = <span class="literal">None</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬éœ€è¦å®šä¹‰è‡ªå·±çš„æ¨¡å‹ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦å®šä¹‰ä¸€ä¸ªé¢„è®­ç»ƒçš„vgg16ï¼Œåˆ™ä¿®æ”¹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">self.model = models.vgg16(pretrained=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å›ç­”ç¬¬ä¸‰ã€å››ã€äº”ä¸ªé—®é¢˜ï¼š FATEæœ¬èº«ä¸æ”¯æŒåŠ è½½é¢„è®­ç»ƒæ¨¡å‹ã€ä½¿ç”¨GPUè®­ç»ƒã€è‡ªå®šä¹‰æ—¥å¿—ï¼Œä½†æ˜¯æ‚¨å¯ä»¥è‡ªè¡Œå¼€å‘ã€‚</p><h3 id="PyTorchFederatedTrainer"><a href="#PyTorchFederatedTrainer" class="headerlink" title="PyTorchFederatedTrainer"></a>PyTorchFederatedTrainer</h3><p>è¿™ä¸ªç±»å’Œæ¨¡å‹æœ‰å…³ã€‚ä»<code>save_checkpoint</code>æ–¹æ³•ä¸­å¯ä»¥çŸ¥é“ï¼ŒFATEå°†æ¨¡å‹æ–‡ä»¶ä¿å­˜ä¸ºmodel.ckptã€‚ä»<code>load_model</code>æ–¹æ³•ä¸­å¯ä»¥äº†è§£åˆ°ï¼ŒåŠ è½½æœ€åå¾—åˆ°çš„æ¨¡å‹æ–‡ä»¶çš„æ–¹å¼ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pl_model = FedLightModule.load_from_checkpoint(filepath)</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°æœ€åç”Ÿæˆçš„æ¨¡å‹ï¼Œå°±å¯ä»¥loadè¿›æ¥ï¼Œ è‡ªå·±å¼€å‘è¿›è¡Œæ¨¡å‹è¯„ä¼°ã€‚</p><h2 id="data-py"><a href="#data-py" class="headerlink" title="data.py"></a>data.py</h2><p><a href="https://github.com/FederatedAI/FATE/blob/master/python/federatedml/nn/backend/pytorch/data.py">https://github.com/FederatedAI/FATE/blob/master/python/federatedml/nn/backend/pytorch/data.py</a></p><p>FATEé€šè¿‡<code>VisionDataSet</code>ç±»åŠ è½½å›¾åƒæ•°æ®ï¼Œè¿™ä¹Ÿå›ç­”äº†ç¬¬ä¸€ã€äºŒä¸ªé—®é¢˜ã€‚</p><p>â€</p><h2 id="FATEæ”¯æŒçš„layer"><a href="#FATEæ”¯æŒçš„layer" class="headerlink" title="FATEæ”¯æŒçš„layer"></a>FATEæ”¯æŒçš„layer</h2><p>åœ¨CONFæ–‡ä»¶çš„â€œnn_defineâ€ä¸­å‡ºç°äº†å¾ˆå¤šç±»å‹çš„layerï¼šConv2dã€ReLuâ€¦</p><p>FATEæ”¯æŒçš„å±‚çš„å®šä¹‰ä½äº<a href="https://github.com/FederatedAI/FATE/blob/master/python/federatedml/nn/backend/fate_torch/nn.py">https://github.com/FederatedAI/FATE/blob/master/python/federatedml/nn/backend/fate_torch/nn.py</a></p><blockquote><p>è¿™é‡Œæˆ‘ä¸€å¼€å§‹è¯¯ä»¥ä¸ºå®šä¹‰çš„å±‚ä½äºï¼š<a href="https://github.com/FederatedAI/FATE/blob/master/python/federatedml/nn/backend/pytorch/nn_model.py">https://github.com/FederatedAI/FATE/blob/master/python/federatedml/nn/backend/pytorch/nn_model.py</a></p><p>åæ¥å‘ç°æ˜¯ä¸å¯¹çš„ï¼Œä¸ºä»€ä¹ˆä¸å¯¹ã€‚æˆ‘ä¹Ÿæ²¡ææ¸…æ¥šã€‚</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ä¸Šä¸Šä¸€ç¯‡ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨FATEå‘èµ·ä¸€ä¸ªæ¨ªå‘è”é‚¦å­¦ä¹ ä»»åŠ¡ï¼Œä½¿ç”¨çš„æ•°æ®æ ¼å¼æ˜¯ç»“æ„åŒ–çš„æ•°æ®ï¼Œä½¿ç”¨çš„ç®—æ³•æ˜¯ç»å…¸çš„LRç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;èƒ½ä¸èƒ½ä½¿ç”¨FATEåšè®¡ç®—æœºè§†è§‰çš„ç¥ç»ç½‘ç»œçš„è”é‚¦å­¦ä¹ å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚æœ¬ç¯‡å°±é€šè¿‡æ‰‹å†™æ•°å­—è¯†åˆ«è¿™ä¸€ç»å…¸ä»»åŠ¡</summary>
      
    
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/categories/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/tags/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>FATE DSLé…ç½®æ–‡ä»¶è¯¦ç»†è§£é‡Š</title>
    <link href="https://guoyujian.github.io/2022/11/04/FATE-DSL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E7%BB%86%E8%A7%A3%E9%87%8A/"/>
    <id>https://guoyujian.github.io/2022/11/04/FATE-DSL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E7%BB%86%E8%A7%A3%E9%87%8A/</id>
    <published>2022-11-03T16:03:55.000Z</published>
    <updated>2022-11-03T16:04:41.428Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™é‡Œå¯¹FATE DSLæ–‡ä»¶åšè¯¦ç»†è§£é‡Šã€‚</p><h1 id="DSL"><a href="#DSL" class="headerlink" title="DSL"></a>DSL</h1><p>DSLæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒFATE 1.7ä»¥ä¸Šç‰ˆæœ¬å¼ºåˆ¶ä½¿ç”¨v2ã€‚</p><p>dsl.jsonæä¾›äº†æµç¨‹ï¼Œconf.jsonæä¾›äº†ä¸ªæµç¨‹å‚æ•°ã€‚</p><p>å…¶ä¸­dsl.jsonçš„é…ç½®å‚è§ï¼š<a href="https://github.com/FederatedAI/FATE/blob/master/doc/tutorial/dsl_conf/dsl_conf_v2_setting_guide.zh.md">https://github.com/FederatedAI/FATE/blob/master/doc/tutorial/dsl_conf/dsl_conf_v2_setting_guide.zh.md</a></p><p>ä¸‹é¢é€‰å–ä¸€ä¸ªæ¡ˆä¾‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//dsl.json</span><br><span class="line">&#123;</span><br><span class="line">    &quot;components&quot;: &#123; // ä¸€çº§é…ç½®ï¼Œè¡¨ç¤ºè¿™ä¸ªä»»åŠ¡ä¼šä½¿ç”¨çš„ç»„ä»¶</span><br><span class="line">        &quot;reader_0&quot;: &#123; // ç»„ä»¶çš„åå­—ï¼Œè‡ªå®šä¹‰</span><br><span class="line">    // æŒ‡å®šæ¨¡å—ï¼Œå‚æ•°éœ€è¦å’Œç›®å½•/data/projects/fate/fate/python/federatedml/componentsä¸€è‡´ï¼Œé‡Œé¢æœ‰ä¸€äº›å®šä¹‰å¥½çš„ç»„ä»¶ï¼Œä½†æ˜¯æ„Ÿè§‰ä¸å…¨ï¼Œæˆ‘çš„å»ºè®®è¿˜æ˜¯çœ‹å®˜æ–¹docsï¼šhttps://fate.readthedocs.io/en/latest/federatedml_component/</span><br><span class="line">            &quot;module&quot;: &quot;Reader&quot;, //æ•°æ®éœ€è¦é€šè¿‡Readerç»„ä»¶ä»æ•°æ®å­˜å‚¨æ‹¿å–æ•°æ®ï¼Œæ³¨æ„æ­¤ç»„ä»¶ä»…æœ‰è¾“å‡ºoutputï¼Œæ­¤æ¨¡å—å¿…é¡»è¦æœ‰</span><br><span class="line">            &quot;output&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: [</span><br><span class="line">                    &quot;data&quot; // è¿™ä¸ªåœ°æ–¹æ˜¯è‡ªå®šä¹‰è¿˜æ˜¯å¿…é¡»æ˜¯trainï¼Ÿéœ€è¦å°è¯•</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">// é™¤readerä¹‹å¤–ï¼Œæ¯ä¸ªç»„ä»¶ä¸‹åŒ…å«inputå’Œoutputï¼Œinputå’Œoutputä¸‹åˆåŒ…å«dataå’Œmodel</span><br><span class="line">// data input: æ¥è‡ªäºä¹‹å‰çš„ç»„ä»¶æœ‰å››ç§å¯èƒ½çš„ç±»å‹ï¼Œ</span><br><span class="line">// 1. data: ç”¨åœ¨data_transform, feature_engineering modules å’Œ evaluationæ¨¡å—</span><br><span class="line">// 2. train_data: ç”¨åœ¨è®­ç»ƒç»„ä»¶ï¼Œæ¯”å¦‚HeteroLRã€HeteroSBTï¼Œå¦‚æœä½¿ç”¨äº†è¿™ä¸ªå­—æ®µï¼Œ åˆ™è¿™ä¸ªtaskä¼šè¢«è§£æä¸ºä¸€ä¸ªfit taskï¼ˆè®­ç»ƒä»»åŠ¡ï¼Ÿï¼‰</span><br><span class="line">// 3. validate_data: å¦‚æœæœ‰äº†train_dataï¼Œé‚£ä¹ˆè¯¥å­—æ®µå°±æ˜¯å¯é€‰åœ°. è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®è¢«ç”¨ä½œvalidationé›†.</span><br><span class="line">// 4. test_data: æŒ‡å®šç”¨äºé¢„æµ‹çš„æ•°æ®ï¼Œå¦‚æœè®¾ç½®äº†è¿™ä¸ªå­—æ®µï¼Œæ¨¡å‹ä¹Ÿéœ€è¦ã€‚</span><br><span class="line"></span><br><span class="line">// model input: æ¥è‡ªäºä¹‹å‰çš„æ¨¡å—ï¼Œæœ‰2ç§å¯èƒ½çš„ç±»å‹ï¼Œ</span><br><span class="line">// 1. model: ç”±åŒç±»å‹ï¼ˆæŒ‡â€œmoduleâ€å­—æ®µç›¸åŒï¼‰ç»„ä»¶è¾“å…¥çš„æ¨¡å‹ã€‚æŠŠå…¶ä»–ç»„ä»¶çš„æ¨¡å‹è¾“å‡ºä½œä¸ºè¾“å…¥ã€‚</span><br><span class="line">// 2. isometric_model: æ¨¡å‹è¾“å…¥æ¥è‡ªä¸Šæ¸¸ç»„ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">// data output: æ¥è‡ªäºä¹‹å‰çš„æ¨¡å—ï¼Œæœ‰4ç§å¯èƒ½çš„ç±»å‹ï¼Œ</span><br><span class="line">// 1. data: </span><br><span class="line">// 2. train_dataã€validate_dataã€test_data: ä»…ç”¨äºæ•°æ®åˆ†ç‰‡ï¼Ÿ</span><br><span class="line"></span><br><span class="line">// model : æ¥è‡ªäºä¹‹å‰çš„æ¨¡å—ï¼Œæœ‰1ç§å¯èƒ½çš„ç±»å‹ï¼Œ</span><br><span class="line">// 1. model</span><br><span class="line"></span><br><span class="line">        &quot;data_transform_0&quot;: &#123;</span><br><span class="line">            &quot;module&quot;: &quot;DataTransform&quot;,</span><br><span class="line">            &quot;input&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: &#123;</span><br><span class="line">                    &quot;data&quot;: [</span><br><span class="line">                        &quot;reader_0.data&quot;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;output&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: [</span><br><span class="line">                    &quot;data&quot;</span><br><span class="line">                ],</span><br><span class="line">                &quot;model&quot;: [</span><br><span class="line">                    &quot;model&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;scale_0&quot;: &#123;</span><br><span class="line">            &quot;module&quot;: &quot;FeatureScale&quot;,</span><br><span class="line">            &quot;input&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: &#123;</span><br><span class="line">                    &quot;data&quot;: [</span><br><span class="line">                        &quot;data_transform_0.data&quot;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;output&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: [</span><br><span class="line">                    &quot;data&quot;</span><br><span class="line">                ],</span><br><span class="line">                &quot;model&quot;: [</span><br><span class="line">                    &quot;model&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;homo_lr_0&quot;: &#123;</span><br><span class="line">            &quot;module&quot;: &quot;HomoLR&quot;,</span><br><span class="line">            &quot;input&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: &#123;</span><br><span class="line">                    &quot;train_data&quot;: [</span><br><span class="line">                        &quot;scale_0.data&quot;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;output&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: [</span><br><span class="line">                    &quot;data&quot;</span><br><span class="line">                ],</span><br><span class="line">                &quot;model&quot;: [</span><br><span class="line">                    &quot;model&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;evaluation_0&quot;: &#123;</span><br><span class="line">            &quot;module&quot;: &quot;Evaluation&quot;,</span><br><span class="line">            &quot;input&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: &#123;</span><br><span class="line">                    &quot;data&quot;: [</span><br><span class="line">                        &quot;homo_lr_0.data&quot;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;output&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: [</span><br><span class="line">                    &quot;data&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€</p><h1 id="CONF"><a href="#CONF" class="headerlink" title="CONF"></a>CONF</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">//conf.json</span><br><span class="line">&#123;</span><br><span class="line">    //fateç‰ˆæœ¬å¤§äºç­‰äº1.7æ—¶ï¼Œå¿…é¡»è®¾ç½®dsl_version=2</span><br><span class="line">    &quot;dsl_version&quot;: 2,</span><br><span class="line"></span><br><span class="line">    &quot;initiator&quot;: &#123; //å®šä¹‰å‘èµ·è€…çš„è§’è‰²å’Œpartyid</span><br><span class="line">        &quot;role&quot;: &quot;guest&quot;,</span><br><span class="line">        &quot;party_id&quot;: 10000</span><br><span class="line">    &#125;,</span><br><span class="line">    //å®šä¹‰æ‰€æœ‰çš„å‚ä¸æ–¹</span><br><span class="line">    &quot;role&quot;: &#123;</span><br><span class="line">        &quot;guest&quot;: [</span><br><span class="line">            10000</span><br><span class="line">        ],</span><br><span class="line">        &quot;host&quot;: [</span><br><span class="line">            10000</span><br><span class="line">        ],</span><br><span class="line">        &quot;arbiter&quot;: [</span><br><span class="line">            10000</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">  </span><br><span class="line">    &quot;component_parameters&quot;: &#123;</span><br><span class="line">        //commonï¼šå‚æ•°åº”ç”¨åˆ°æ‰€æœ‰çš„å‚ä¸æ–¹, roleï¼šå‚æ•°åº”ç”¨åˆ°æŒ‡å®šçš„å‚ä¸æ–¹</span><br><span class="line">        &quot;common&quot;: &#123;</span><br><span class="line">    //ç»„ä»¶çš„è¯¦ç»†å‚æ•°å‚è§ï¼šhttps://fate.readthedocs.io/en/latest/federatedml_component/</span><br><span class="line">            &quot;data_transform_0&quot;: &#123;</span><br><span class="line">                &quot;with_label&quot;: true,</span><br><span class="line">                &quot;output_format&quot;: &quot;dense&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;homo_lr_0&quot;: &#123;</span><br><span class="line">                &quot;penalty&quot;: &quot;L2&quot;,</span><br><span class="line">                &quot;tol&quot;: 1e-05,</span><br><span class="line">                &quot;alpha&quot;: 0.01,</span><br><span class="line">                &quot;optimizer&quot;: &quot;sgd&quot;,</span><br><span class="line">                &quot;batch_size&quot;: -1,</span><br><span class="line">                &quot;learning_rate&quot;: 0.15,</span><br><span class="line">                &quot;init_param&quot;: &#123;</span><br><span class="line">                    &quot;init_method&quot;: &quot;zeros&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;max_iter&quot;: 30,</span><br><span class="line">                &quot;early_stop&quot;: &quot;diff&quot;,</span><br><span class="line">                &quot;encrypt_param&quot;: &#123;</span><br><span class="line">                    &quot;method&quot;: null</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;cv_param&quot;: &#123;</span><br><span class="line">                    &quot;n_splits&quot;: 4,</span><br><span class="line">                    &quot;shuffle&quot;: true,</span><br><span class="line">                    &quot;random_seed&quot;: 33,</span><br><span class="line">                    &quot;need_cv&quot;: false</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;decay&quot;: 1,</span><br><span class="line">                &quot;decay_sqrt&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;evaluation_0&quot;: &#123;</span><br><span class="line">                &quot;eval_type&quot;: &quot;binary&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        &quot;role&quot;: &#123;</span><br><span class="line">            &quot;host&quot;: &#123;</span><br><span class="line">                &quot;0&quot;: &#123; //role.host.0ï¼šå‚æ•°åº”ç”¨åˆ°hostçš„index=0çš„å‚ä¸æ–¹</span><br><span class="line">                    &quot;reader_0&quot;: &#123;</span><br><span class="line">                        &quot;table&quot;: &#123;</span><br><span class="line">                            &quot;name&quot;: &quot;homo_default_credit_host&quot;,</span><br><span class="line">                            &quot;namespace&quot;: &quot;homo_default_credit_host&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;evaluation_0&quot;: &#123;</span><br><span class="line">                        &quot;need_run&quot;: false</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;guest&quot;: &#123;</span><br><span class="line">                &quot;0&quot;: &#123;</span><br><span class="line">                    &quot;reader_0&quot;: &#123;</span><br><span class="line">                        &quot;table&quot;: &#123;</span><br><span class="line">                            &quot;name&quot;: &quot;homo_default_credit_guest&quot;,</span><br><span class="line">                            &quot;namespace&quot;: &quot;homo_default_credit_guest&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨ï¼š</p><ol><li>ä¸Šé¢çš„confæ²¡æœ‰ä½¿ç”¨åˆ°providerç»„ä»¶ï¼Œè¯¥ç»„ä»¶æ”¯æŒåŠ è½½å¤šç§ä¸”å¤šç‰ˆæœ¬çš„ç»„ä»¶æä¾›æ–¹</li><li>ä¸Šé¢confæ²¡æ¶‰åŠç³»ç»Ÿè¿è¡Œæ—¶å‚æ•°ï¼Œå…·ä½“å‚è§ï¼š<a href="https://federatedai.github.io/FATE-Flow/latest/zh/fate_flow_job_scheduling/#43">https://federatedai.github.io/FATE-Flow/latest/zh/fate_flow_job_scheduling/#43</a></li><li>dsl v2ä¸­ï¼Œpredict dslä¸ä¼šåœ¨è®­ç»ƒåè‡ªåŠ¨ç”Ÿæˆï¼Œç”¨æˆ·éœ€è¦é€šè¿‡flow clientéƒ¨ç½²æ‰€éœ€çš„ç»„ä»¶ï¼š<a href="https://github.com/FederatedAI/FATE-Flow/blob/main/doc/cli/model.md#deploy">https://github.com/FederatedAI/FATE-Flow/blob/main/doc/cli/model.md#deploy</a></li><li>train dsl å’Œpredict dsl examplesï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;components&quot;: &#123;</span><br><span class="line">    &quot;reader_0&quot;: &#123;</span><br><span class="line">        &quot;module&quot;: &quot;Reader&quot;,</span><br><span class="line">        &quot;output&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: [</span><br><span class="line">                &quot;data&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;data_transform_0&quot;: &#123;</span><br><span class="line">        &quot;module&quot;: &quot;DataTransform&quot;,</span><br><span class="line">        &quot;input&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: [</span><br><span class="line">                    &quot;reader_0.data&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;output&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: [</span><br><span class="line">                &quot;data&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;model&quot;: [</span><br><span class="line">                &quot;model&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;intersection_0&quot;: &#123;</span><br><span class="line">        &quot;module&quot;: &quot;Intersection&quot;,</span><br><span class="line">        &quot;input&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: [</span><br><span class="line">                    &quot;data_transform_0.data&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;output&quot;: &#123;</span><br><span class="line">            &quot;data&quot;:[</span><br><span class="line">                &quot;data&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;hetero_nn_0&quot;: &#123;</span><br><span class="line">        &quot;module&quot;: &quot;HeteroNN&quot;,</span><br><span class="line">        &quot;input&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: &#123;</span><br><span class="line">                &quot;train_data&quot;: [</span><br><span class="line">                    &quot;intersection_0.data&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;output&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: [</span><br><span class="line">                &quot;data&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;model&quot;: [</span><br><span class="line">                &quot;model&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â€</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;components&quot;: &#123;</span><br><span class="line">    &quot;reader_0&quot;: &#123;</span><br><span class="line">        &quot;module&quot;: &quot;Reader&quot;,</span><br><span class="line">        &quot;output&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: [</span><br><span class="line">                &quot;data&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;data_transform_0&quot;: &#123;</span><br><span class="line">        &quot;module&quot;: &quot;DataTransform&quot;,</span><br><span class="line">        &quot;input&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: [</span><br><span class="line">                    &quot;reader_0.data&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;output&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: [</span><br><span class="line">                &quot;data&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;model&quot;: [</span><br><span class="line">                &quot;model&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;intersection_0&quot;: &#123;</span><br><span class="line">        &quot;module&quot;: &quot;Intersection&quot;,</span><br><span class="line">        &quot;input&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: [</span><br><span class="line">                    &quot;data_transform_0.data&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;output&quot;: &#123;</span><br><span class="line">            &quot;data&quot;:[</span><br><span class="line">                &quot;data&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;hetero_nn_0&quot;: &#123;</span><br><span class="line">        &quot;module&quot;: &quot;HeteroNN&quot;,</span><br><span class="line">        &quot;input&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: &#123;</span><br><span class="line">                &quot;train_data&quot;: [</span><br><span class="line">                    &quot;intersection_0.data&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;output&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: [</span><br><span class="line">                &quot;data&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;model&quot;: [</span><br><span class="line">                &quot;model&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;evaluation_0&quot;: &#123;</span><br><span class="line">        &quot;module&quot;: &quot;Evaluation&quot;,</span><br><span class="line">        &quot;input&quot;: &#123;</span><br><span class="line">            &quot;data&quot;: &#123;</span><br><span class="line">                &quot;data&quot;: [</span><br><span class="line">                    &quot;hetero_nn_0.data&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;,</span><br><span class="line">         &quot;output&quot;: &#123;</span><br><span class="line">             &quot;data&quot;: [</span><br><span class="line">                 &quot;data&quot;</span><br><span class="line">             ]</span><br><span class="line">          &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="åŸºæœ¬å·¥ä½œæµ"><a href="#åŸºæœ¬å·¥ä½œæµ" class="headerlink" title="åŸºæœ¬å·¥ä½œæµ"></a>åŸºæœ¬å·¥ä½œæµ</h1><ol><li>æäº¤ä½œä¸šåï¼Œä½œä¸šçš„dslå’Œé…ç½®ä¼šå­˜å‚¨åˆ°ç›¸åº”çš„ç›®å½•ï¼š<code>/data/projects/fate/fateflow/jobs</code></li><li>è§£ædslå’Œconfï¼Œç”Ÿæˆé…ç½®ï¼Œåˆ†å‘å…±åŒçš„é…ç½®ç»™æ¯ä¸€æ–¹ï¼Œå¹¶ç”Ÿæˆå­˜å‚¨ç‰¹å®šæ–¹çš„é…ç½®åœ¨ç›®å½•ï¼š<code>/data/projects/fate/fateflow/jobs/[job_id]/[role]/[party_id]</code></li></ol><p>â€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™é‡Œå¯¹FATE DSLæ–‡ä»¶åšè¯¦ç»†è§£é‡Šã€‚&lt;/p&gt;
&lt;h1 id=&quot;DSL&quot;&gt;&lt;a href=&quot;#DSL&quot; class=&quot;headerlink&quot; title=&quot;DSL&quot;&gt;&lt;/a&gt;DSL&lt;/h1&gt;&lt;p&gt;DSLæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒFATE 1.7ä»¥ä¸Šç‰ˆæœ¬å¼ºåˆ¶ä½¿ç”¨v2ã€‚&lt;/p&gt;
&lt;p&gt;dsl</summary>
      
    
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/categories/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="è”é‚¦å­¦ä¹ " scheme="https://guoyujian.github.io/tags/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
</feed>
