<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="ç¥ç»ç½‘ç»œè®­ç»ƒåˆä½“éªŒ: æˆ¿ä»·é¢„æµ‹æ¯”èµ›"><meta name="keywords" content="æ·±åº¦å­¦ä¹ "><meta name="author" content="Met Guo"><meta name="copyright" content="Met Guo"><title>ç¥ç»ç½‘ç»œè®­ç»ƒåˆä½“éªŒ: æˆ¿ä»·é¢„æµ‹æ¯”èµ› | Gmet's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.8.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.8.2"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"LEZCUKXOU8","apiKey":"43c226e390cd280e256d1d7cc0e6cce4","indexName":"blogs","hits":{"per_page":10,"input_placeholder":"Search for Posts","hits_empty":"Ã»ï¿½ï¿½ï¿½Òµï¿½ï¿½ï¿½ï¿½ï¿½Òªï¿½Ä½ï¿½ï¿½: ${query}","hits_stats":"ï¿½Òµï¿½${hits}ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê±${time}ï¿½ï¿½ï¿½ë£©"},"languages":{"input_placeholder":"æœç´¢æ–‡ç« ","hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}","hits_stats":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’"}},
  localSearch: undefined,
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  hexoVersion: '5.4.2'
} </script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Gmet's Blog" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="åˆ‡æ¢æ–‡ç« è¯¦æƒ…">åˆ‡æ¢ç«™ç‚¹æ¦‚è§ˆ</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.</span> <span class="toc-text">å·¥ä½œç¯å¢ƒ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.</span> <span class="toc-text">åˆ›å»ºé¡¹ç›®</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">3.</span> <span class="toc-text">ä¸‹è½½æ•°æ®é›†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">4.</span> <span class="toc-text">è¯»å–æ•°æ®é›†</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">4.1.</span> <span class="toc-text">æ•°æ®é¢„å¤„ç†</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%AD%E7%BB%83"><span class="toc-number">5.</span> <span class="toc-text">è®­ç»ƒ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#K-%E6%8A%98%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81"><span class="toc-number">6.</span> <span class="toc-text">K-æŠ˜äº¤å‰éªŒè¯</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E9%80%89%E6%8B%A9"><span class="toc-number">7.</span> <span class="toc-text">æ¨¡å‹é€‰æ‹©</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8F%90%E4%BA%A4Kaggle%E9%A2%84%E6%B5%8B"><span class="toc-number">8.</span> <span class="toc-text">æäº¤Kaggleé¢„æµ‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">9.</span> <span class="toc-text">å°ç»“</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9B%B4%E8%BF%9B%E4%B8%80%E6%AD%A5"><span class="toc-number">10.</span> <span class="toc-text">æ›´è¿›ä¸€æ­¥</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0"><span class="toc-number">11.</span> <span class="toc-text">åè®°</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">12.</span> <span class="toc-text">å‚è€ƒèµ„æ–™</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Met Guo</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">æ–‡ç« </span><span class="pull-right">71</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">æ ‡ç­¾</span><span class="pull-right">55</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">åˆ†ç±»</span><span class="pull-right">43</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://images7.alphacoders.com/550/thumb-1920-550739.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Gmet's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/slides">Slides</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> æœç´¢</span></a></span></div><div id="post-info"><div id="post-title">ç¥ç»ç½‘ç»œè®­ç»ƒåˆä½“éªŒ: æˆ¿ä»·é¢„æµ‹æ¯”èµ›</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-12</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ </a><div class="post-meta-wordcount"><span>å­—æ•°æ€»è®¡: </span><span class="word-count">3.7k</span><span class="post-meta__separator">|</span><span>é˜…è¯»æ—¶é•¿: 14 åˆ†é’Ÿ</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><blockquote>
<p>æœ¬æ–‡FROMã€ŠåŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ã€‹ç¬¬å››ç« ç¬¬åèŠ‚ï¼Œé“¾æ¥è¯¦è§<em>å‚è€ƒèµ„æ–™1</em></p>
</blockquote>
<h1 id="å·¥ä½œç¯å¢ƒ"><a href="#å·¥ä½œç¯å¢ƒ" class="headerlink" title="å·¥ä½œç¯å¢ƒ"></a>å·¥ä½œç¯å¢ƒ</h1><div class="table-container">
<table>
<thead>
<tr>
<th>è½¯ä»¶åç§°</th>
<th>è¯´æ˜</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>anaconda</td>
<td>Pythonç¯å¢ƒå’Œå¼€æºæ¨¡å—ç®¡ç†å·¥å…·</td>
<td>é»˜è®¤</td>
</tr>
<tr>
<td>Python</td>
<td>å¼€å‘è¯­è¨€</td>
<td>3.8</td>
</tr>
<tr>
<td>torchã€torchvision</td>
<td>æ·±åº¦å­¦ä¹ æ¡†æ¶</td>
<td>é»˜è®¤</td>
</tr>
<tr>
<td>d2l</td>
<td>åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ å®˜æ–¹æ¨¡å—</td>
<td>é»˜è®¤</td>
</tr>
<tr>
<td>VS Code</td>
<td>å¼€å‘IDE</td>
<td>é»˜è®¤</td>
</tr>
</tbody>
</table>
</div>
<h1 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h1><p>åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹<code>kaggle-house-prices</code>ï¼ˆè‡ªå®šä¹‰å‘½åï¼‰ä»¥åŠ<code>code</code>å­æ–‡ä»¶å¤¹ï¼Œ<code>code/</code>ä¸‹åˆ›å»ºJupyter notebookï¼Œæ‰€æœ‰ä»£ç å†™åœ¨è¿™é‡Œé¢ã€‚</p>
<p>ç”Ÿæˆçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kaggle-house-prices/</span><br><span class="line">	code/</span><br><span class="line">		kaggle-house-prices.ipynb</span><br></pre></td></tr></table></figure>
<h1 id="ä¸‹è½½æ•°æ®é›†"><a href="#ä¸‹è½½æ•°æ®é›†" class="headerlink" title="ä¸‹è½½æ•°æ®é›†"></a>ä¸‹è½½æ•°æ®é›†</h1><p>æ•°æ®é›†æ¥è‡ªäºKaggleä¸Šçš„ä¸€ä¸ªç«èµ›ã€‚ç½‘å€ï¼š<a target="_blank" rel="noopener" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data">https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data</a></p>
<p>ä½ å¯ä»¥ç›´æ¥ä»ä¸Šé¢ä¸‹è½½æ•°æ®é›†ï¼›ï¼ˆåŒ…å«è®­ç»ƒé›†ã€æµ‹è¯•é›†ã€æ•°æ®æè¿°å’Œæäº¤æ ·ä¾‹ï¼‰</p>
<p>æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨ä¹¦ä¸­çš„æ–¹å¼ä¸‹è½½ä»£ç ï¼Œè¿™é‡Œæˆ‘æŠŠå®Œæ•´çš„ä»£ç è´´ä¸€ä¸‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªäºŒå…ƒç»„åŒ…å«æ•°æ®é›†çš„urlå’ŒéªŒè¯æ–‡ä»¶å®Œæ•´æ€§çš„sha-1å¯†é’¥</span></span><br><span class="line">DATA_HUB = <span class="built_in">dict</span>()</span><br><span class="line">DATA_URL = <span class="string">&#x27;http://d2l-data.s3-accelerate.amazonaws.com/&#x27;</span></span><br><span class="line">DATA_HUB[<span class="string">&#x27;kaggle_house_train&#x27;</span>] = (</span><br><span class="line">    DATA_URL + <span class="string">&#x27;kaggle_house_pred_train.csv&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;585e9cc93e70b39160e7921475f9bcd7d31219ce&#x27;</span>)</span><br><span class="line"></span><br><span class="line">DATA_HUB[<span class="string">&#x27;kaggle_house_test&#x27;</span>] = (</span><br><span class="line">    DATA_URL + <span class="string">&#x27;kaggle_house_pred_test.csv&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;fa19780a7b011d9b009e8bff8e99922a8ee2eb90&#x27;</span>)</span><br><span class="line"></span><br><span class="line">DATA_URL = <span class="string">&#x27;http://d2l-data.s3-accelerate.amazonaws.com/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å®šä¹‰äº†ä¸€å †ä¸‹è½½ã€è§£å‹çš„å‡½æ•°</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>(<span class="params">name, cache_dir=os.path.join(<span class="params"><span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;data&#x27;</span></span>)</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸‹è½½ä¸€ä¸ªDATA_HUBä¸­çš„æ–‡ä»¶ï¼Œè¿”å›æœ¬åœ°æ–‡ä»¶å&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">assert</span> name <span class="keyword">in</span> DATA_HUB, <span class="string">f&quot;<span class="subst">&#123;name&#125;</span> ä¸å­˜åœ¨äº <span class="subst">&#123;DATA_HUB&#125;</span>&quot;</span></span><br><span class="line">    url, sha1_hash = DATA_HUB[name]</span><br><span class="line">    os.makedirs(cache_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    fname = os.path.join(cache_dir, url.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(fname):</span><br><span class="line">        sha1 = hashlib.sha1()</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(fname, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                data = f.read(<span class="number">1048576</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                sha1.update(data)</span><br><span class="line">        <span class="keyword">if</span> sha1.hexdigest() == sha1_hash:</span><br><span class="line">            <span class="keyword">return</span> fname  <span class="comment"># å‘½ä¸­ç¼“å­˜</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;æ­£åœ¨ä»<span class="subst">&#123;url&#125;</span>ä¸‹è½½<span class="subst">&#123;fname&#125;</span>...&#x27;</span>)</span><br><span class="line">    r = requests.get(url, stream=<span class="literal">True</span>, verify=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(fname, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(r.content)</span><br><span class="line">    <span class="keyword">return</span> fname</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download_extract</span>(<span class="params">name, folder=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸‹è½½å¹¶è§£å‹zip/taræ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    fname = download(name)</span><br><span class="line">    base_dir = os.path.dirname(fname)</span><br><span class="line">    data_dir, ext = os.path.splitext(fname)</span><br><span class="line">    <span class="keyword">if</span> ext == <span class="string">&#x27;.zip&#x27;</span>:</span><br><span class="line">        fp = zipfile.ZipFile(fname, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> ext <span class="keyword">in</span> (<span class="string">&#x27;.tar&#x27;</span>, <span class="string">&#x27;.gz&#x27;</span>):</span><br><span class="line">        fp = tarfile.<span class="built_in">open</span>(fname, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">assert</span> <span class="literal">False</span>, <span class="string">&#x27;åªæœ‰zip/taræ–‡ä»¶å¯ä»¥è¢«è§£å‹ç¼©&#x27;</span></span><br><span class="line">    fp.extractall(base_dir)</span><br><span class="line">    <span class="keyword">return</span> os.path.join(base_dir, folder) <span class="keyword">if</span> folder <span class="keyword">else</span> data_dir</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download_all</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸‹è½½DATA_HUBä¸­çš„æ‰€æœ‰æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> DATA_HUB:</span><br><span class="line">        download(name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½è®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span><br><span class="line">download_all()</span><br></pre></td></tr></table></figure>
<pre><code>æ­£åœ¨ä»http://d2l-data.s3-accelerate.amazonaws.com/kaggle_house_pred_train.csvä¸‹è½½..\data\kaggle_house_pred_train.csv...
æ­£åœ¨ä»http://d2l-data.s3-accelerate.amazonaws.com/kaggle_house_pred_test.csvä¸‹è½½..\data\kaggle_house_pred_test.csv...
</code></pre><p>ä½¿ç”¨ä¹¦ä¸­çš„ä»£ç ä¸‹è½½çš„æ•°æ®é›†å­˜æ”¾åœ¨<code>../data/</code>ä¸­ã€‚ç»“æ„ç›®å½•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kaggle-house-prices/</span><br><span class="line">	code/</span><br><span class="line">		kaggle-house-prices.ipynb</span><br><span class="line">    data/</span><br><span class="line">    	kaggle_house_pred_train.csv</span><br><span class="line">    	kaggle_house_pred_test.csv</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢è¿›è¡Œæ•°æ®è¯»å–å’Œé¢„å¤„ç†ã€‚</p>
<h1 id="è¯»å–æ•°æ®é›†"><a href="#è¯»å–æ•°æ®é›†" class="headerlink" title="è¯»å–æ•°æ®é›†"></a>è¯»å–æ•°æ®é›†</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœpandasæ²¡æœ‰è¢«å®‰è£…ï¼Œè¯·å–æ¶ˆä¸‹ä¸€å¥çš„æ³¨é‡Šã€‚</span></span><br><span class="line"><span class="comment"># !pip install pandas</span></span><br><span class="line"></span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"><span class="keyword">from</span> d2l <span class="keyword">import</span> torch <span class="keyword">as</span> d2l</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">train_data = pd.read_csv(<span class="string">&quot;../data/kaggle_house_pred_train.csv&quot;</span>)</span><br><span class="line">test_data = pd.read_csv(<span class="string">&quot;../data/kaggle_house_pred_train.csv&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰“å°ä»–ä»¬çš„è¡Œåˆ—æ•°ï¼Œè¿™é‡Œtest_dataçš„åˆ—æ¯”train_dataå°‘1ï¼Œå°‘çš„æ˜¯æ ‡ç­¾ä¸€åˆ—</span></span><br><span class="line"><span class="built_in">print</span>(train_data.shape)</span><br><span class="line"><span class="built_in">print</span>(test_data.shape)</span><br></pre></td></tr></table></figure>
<pre><code>(1460, 81)
(1460, 81)
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># print train_data ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æŒ‡å‡ºæ‰“å°çš„è¡Œï¼ˆæ ·æœ¬ï¼‰å’Œåˆ—ï¼ˆç‰¹å¾ï¼‰</span></span><br><span class="line"><span class="built_in">print</span>(train_data.iloc[<span class="number">0</span>:<span class="number">4</span>, [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, -<span class="number">3</span>, -<span class="number">2</span>, -<span class="number">1</span>]])</span><br></pre></td></tr></table></figure>
<pre><code>   Id  MSSubClass MSZoning  LotFrontage SaleType SaleCondition  SalePrice
0   1          60       RL         65.0       WD        Normal     208500
1   2          20       RL         80.0       WD        Normal     181500
2   3          60       RL         68.0       WD        Normal     223500
3   4          70       RL         60.0       WD       Abnorml     140000
</code></pre><p>å°†train_dataå’Œtest_dataå»æ‰ç¬¬ä¸€ä¸ªç‰¹å¾ï¼ˆç¬¬ä¸€ä¸ªç‰¹å¾æ˜¯IDï¼Œå¯¹è®­ç»ƒæ— æ„ä¹‰ï¼‰çš„æ‰€æœ‰ç‰¹å¾éƒ½æ”¾åˆ°all_featuresä¸­ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">all_features = pd.concat((train_data.iloc[:, <span class="number">1</span>:-<span class="number">1</span>], test_data.iloc[:, <span class="number">1</span>:]))</span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®é¢„å¤„ç†"><a href="#æ•°æ®é¢„å¤„ç†" class="headerlink" title="æ•°æ®é¢„å¤„ç†"></a>æ•°æ®é¢„å¤„ç†</h2><p>åœ¨å¼€å§‹å»ºæ¨¡ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ã€‚</p>
<p>å¯¹äºæ•°å­—ç‰¹å¾ï¼Œé¦–å…ˆï¼Œ<strong>å°†æ‰€æœ‰ç¼ºå¤±çš„å€¼æ›¿æ¢ä¸ºç›¸åº”ç‰¹å¾çš„å¹³å‡å€¼ï¼›</strong></p>
<p>ç„¶åï¼Œä¸ºäº†å°†æ‰€æœ‰ç‰¹å¾æ”¾åœ¨ä¸€ä¸ªå…±åŒçš„å°ºåº¦ä¸Šï¼Œæˆ‘ä»¬<strong>é€šè¿‡å°†ç‰¹å¾é‡æ–°ç¼©æ”¾åˆ°é›¶å‡å€¼å’Œå•ä½æ–¹å·®æ¥æ ‡å‡†åŒ–æ•°æ®</strong>ï¼š</p>
<script type="math/tex; mode=display">
x \leftarrow \frac{x - \mu}{\sigma}.</script><p>æ­¤æ—¶ï¼Œç‰¹å¾å³å…·æœ‰é›¶å‡å€¼å’Œå•ä½æ–¹å·®ï¼Œå³ $E[\frac{x-\mu}{\sigma}] = \frac{\mu - \mu}{\sigma} = 0$å’Œ$E[(x-\mu)^2] = (\sigma^2 + \mu^2) - 2\mu^2+\mu^2 = \sigma^2$ã€‚</p>
<p>æ ‡å‡†åŒ–æ•°æ®æœ‰ä¸¤ä¸ªåŸå› ï¼š</p>
<ul>
<li>æ–¹ä¾¿ä¼˜åŒ–ï¼›</li>
<li>æˆ‘ä»¬ä¸çŸ¥é“å“ªäº›ç‰¹å¾æ˜¯ç›¸å…³çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸æƒ³è®©æƒ©ç½šåˆ†é…ç»™ä¸€ä¸ªç‰¹å¾çš„ç³»æ•°æ¯”åˆ†é…ç»™å…¶ä»–ä»»ä½•ç‰¹å¾çš„ç³»æ•°æ›´å¤§ï¼›</li>
<li>å–æ¶ˆç”±äºé‡çº²ä¸åŒã€è‡ªèº«å˜å¼‚æˆ–è€…æ•°å€¼ç›¸å·®è¾ƒå¤§æ‰€å¼•èµ·çš„è¯¯å·®ã€‚</li>
</ul>
<p>æ›´å¤šå…³äºæ ‡å‡†åŒ–çš„çŸ¥è¯†è¯·è§<em>å‚è€ƒèµ„æ–™2</em></p>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œä¹¦ä¸­æåˆ°çš„æ˜¯å…ˆå¤„ç†ç¼ºå¤±å€¼ï¼Œå†æ ‡å‡†åŒ–ï¼›è€Œå®é™…ä»£ç æ˜¯å…ˆæ ‡å‡†åŒ–ï¼Œå†å¤„ç†ç¼ºå¤±å€¼ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è‹¥æ— æ³•è·å¾—æµ‹è¯•æ•°æ®ï¼Œåˆ™å¯æ ¹æ®è®­ç»ƒæ•°æ®è®¡ç®—å‡å€¼å’Œæ ‡å‡†å·®</span></span><br><span class="line"><span class="comment"># å–å‡ºæ•°å­—ç±»å‹çš„ç‰¹å¾ç´¢å¼•</span></span><br><span class="line">numeric_features = all_features.dtypes[all_features.dtypes != <span class="string">&#x27;object&#x27;</span>].index</span><br><span class="line"><span class="comment"># å°†æ•°å­—ç±»å‹çš„ç‰¹å¾æ ‡å‡†åŒ–</span></span><br><span class="line">all_features[numeric_features] = all_features[numeric_features].apply(</span><br><span class="line">    <span class="keyword">lambda</span> x: (x - x.mean()) / (x.std()))</span><br><span class="line"><span class="comment"># åœ¨æ ‡å‡†åŒ–æ•°æ®ä¹‹åï¼Œæ‰€æœ‰å‡å€¼æ¶ˆå¤±ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†ç¼ºå¤±å€¼è®¾ç½®ä¸º0</span></span><br><span class="line">all_features[numeric_features] = all_features[numeric_features].fillna(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>å¯¹äºç¦»æ•£å€¼ï¼Œæˆ‘ä»¬ä½¿ç”¨one-hotç¼–ç ï¼Œå°±æ˜¯ç‰¹å¾çš„ç¦»æ•£å€¼è½¬æ¢ä¸ºå‘é‡ã€‚ä¾‹å¦‚ï¼Œç‰¹å¾â€œtypeâ€çš„å€¼åŒ…æ‹¬catï¼Œdogï¼Œratï¼Œé‚£ä¹ˆç»è¿‡one-hotç¼–ç åä¼šç”Ÿæˆä¸‰ä¸ªç‰¹å¾â€œtype_catâ€ï¼Œâ€œtype_dogâ€ï¼Œâ€œtype_ratâ€ã€‚å¦‚æœåŸæ¥â€œtypeâ€=catï¼Œåˆ™â€œtype_catâ€=1ï¼Œâ€œtype_dogâ€=0ï¼Œâ€œtype_ratâ€=0ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># â€œDummy_na=Trueâ€å°†â€œnaâ€ï¼ˆç¼ºå¤±å€¼ï¼‰è§†ä¸ºæœ‰æ•ˆçš„ç‰¹å¾å€¼ï¼Œå¹¶ä¸ºå…¶åˆ›å»ºæŒ‡ç¤ºç¬¦ç‰¹å¾</span></span><br><span class="line">all_features = pd.get_dummies(all_features, dummy_na=<span class="literal">True</span>)</span><br><span class="line">all_features.shape</span><br></pre></td></tr></table></figure>
<pre><code>(2920, 332)
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤è½¬æ¢ä¼šå°†ç‰¹å¾çš„æ€»æ•°é‡ä»79ä¸ªå¢åŠ åˆ°331ä¸ªã€‚ æœ€åï¼Œé€šè¿‡valueså±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ ä»pandasæ ¼å¼ä¸­æå–NumPyæ ¼å¼ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºå¼ é‡è¡¨ç¤ºç”¨äºè®­ç»ƒã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n_train = train_data.shape[<span class="number">0</span>]  <span class="comment"># å–å¾—train_dataçš„è¡Œæ•°</span></span><br><span class="line"><span class="comment"># å–å‡ºall_featuresçš„train_dataè½¬æ¢æˆtensor</span></span><br><span class="line">train_features = torch.tensor(all_features[:n_train].values, dtype=torch.float32)</span><br><span class="line"><span class="comment"># å–å‡ºall_featuresçš„test_dataè½¬æ¢æˆtensor</span></span><br><span class="line">test_features = torch.tensor(all_features[n_train:].values, dtype=torch.float32)</span><br><span class="line"><span class="comment"># train_labels.shape[0] == n_train</span></span><br><span class="line"><span class="comment"># reshape(-1, 1)ç›¸å½“äºæŠŠlabelsä¸€è¡Œè½¬ä¸ºä¸€åˆ—å’Œtrain_featuresä¸€ä¸€å¯¹åº”</span></span><br><span class="line">train_labels = torch.tensor(</span><br><span class="line">    train_data.SalePrice.values.reshape(-<span class="number">1</span>, <span class="number">1</span>), dtype=torch.float32)</span><br></pre></td></tr></table></figure>
<h1 id="è®­ç»ƒ"><a href="#è®­ç»ƒ" class="headerlink" title="è®­ç»ƒ"></a>è®­ç»ƒ</h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬è®­ç»ƒä¸€ä¸ªå¸¦æœ‰æŸå¤±å¹³æ–¹çš„çº¿æ€§æ¨¡å‹ã€‚å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œçº¿æ€§æ¨¡å‹å°†ä½œä¸ºåŸºçº¿ï¼ˆbaselineï¼‰æ¨¡å‹ï¼Œ è®©æˆ‘ä»¬ç›´è§‚åœ°çŸ¥é“æœ€å¥½çš„æ¨¡å‹æœ‰è¶…å‡ºç®€å•çš„æ¨¡å‹å¤šå°‘ã€‚</p>
<p>æŸå¤±å‡½æ•°ï¼šMSE Loss</p>
<p>åŸºçº¿æ¨¡å‹ï¼šï¼ˆä¸ªäººç†è§£ï¼‰æœ€å…ˆæƒ³åˆ°çš„ã€æœ€ç®€å•çš„ã€ç»“æœæ¯”è¾ƒå·®ã€ä¸€èˆ¬åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œä¼˜åŒ–çš„æ¨¡å‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">loss = nn.MSELoss()</span><br><span class="line">in_features = train_features.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_net</span>():</span><br><span class="line">    net = nn.Sequential(nn.Linear(in_features,<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> net</span><br></pre></td></tr></table></figure>
<p>å¯¹äºæˆ¿ä»·ï¼Œå°±åƒè‚¡ç¥¨ä»·æ ¼ä¸€æ ·ï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯ç›¸å¯¹æ•°é‡ï¼Œè€Œä¸æ˜¯ç»å¯¹æ•°é‡ã€‚å› æ­¤ï¼Œ[<strong>æˆ‘ä»¬æ›´å…³å¿ƒç›¸å¯¹è¯¯å·®$\frac{y - \hat{y}}{y}$ï¼Œ</strong>]è€Œä¸æ˜¯ç»å¯¹è¯¯å·®$y - \hat{y}$ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¿„äº¥ä¿„å·å†œæ‘åœ°åŒºä¼°è®¡ä¸€æ ‹æˆ¿å­çš„ä»·æ ¼æ—¶ï¼Œæˆ‘ä»¬çš„é¢„æµ‹åå·®äº†10ä¸‡ç¾å…ƒï¼Œåœ¨é‚£é‡Œä¸€æ ‹å…¸å‹çš„æˆ¿å­çš„ä»·å€¼æ˜¯12.5ä¸‡ç¾å…ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½åšå¾—å¾ˆç³Ÿç³•ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæˆ‘ä»¬åœ¨åŠ å·è±ªå®…åŒºçš„é¢„æµ‹å‡ºç°äº†è¿™ä¸ªæ•°å­—çš„åå·®ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªæƒŠäººçš„å‡†ç¡®é¢„æµ‹ï¼ˆåœ¨é‚£é‡Œï¼Œæˆ¿ä»·å‡å€¼è¶…è¿‡400ä¸‡ç¾å…ƒï¼‰ã€‚</p>
<p>(<strong>è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯ç”¨ä»·æ ¼é¢„æµ‹çš„å¯¹æ•°æ¥è¡¡é‡å·®å¼‚</strong>)ã€‚äº‹å®ä¸Šï¼Œè¿™ä¹Ÿæ˜¯æ¯”èµ›ä¸­å®˜æ–¹ç”¨æ¥è¯„ä»·æäº¤è´¨é‡çš„è¯¯å·®æŒ‡æ ‡ã€‚å³å°† $\delta$ for $|\log y - \log \hat{y}| \leq \delta$è½¬æ¢ä¸º$e^{-\delta} \leq \frac{\hat{y}}{y} \leq e^\delta$ã€‚è¿™ä½¿å¾—é¢„æµ‹ä»·æ ¼çš„å¯¹æ•°ä¸çœŸå®æ ‡ç­¾ä»·æ ¼çš„å¯¹æ•°ä¹‹é—´å‡ºç°ä»¥ä¸‹å‡æ–¹æ ¹è¯¯å·®ï¼š</p>
<script type="math/tex; mode=display">
\sqrt{\frac{1}{n}\sum_{i=1}^n\left(\log y_i -\log \hat{y}_i\right)^2}.</script><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">log_rmse</span>(<span class="params">net, features, labels</span>):</span><br><span class="line">    <span class="comment"># ä¸ºäº†åœ¨å–å¯¹æ•°æ—¶è¿›ä¸€æ­¥ç¨³å®šè¯¥å€¼ï¼Œå°†å°äº1çš„å€¼è®¾ç½®ä¸º1</span></span><br><span class="line">    <span class="comment"># clampæ–¹æ³•è¯´æ˜è¯¦è§ å‚è€ƒèµ„æ–™5</span></span><br><span class="line">    clipped_preds = torch.clamp(net(features), <span class="number">1</span>, <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>))</span><br><span class="line">    rmse = torch.sqrt(loss(torch.log(clipped_preds),</span><br><span class="line">                           torch.log(labels)))</span><br><span class="line">    <span class="keyword">return</span> rmse.item()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä¸€å¼€å§‹å¯¹æŸå¤±å‡½æ•°ï¼ˆlossï¼‰å’Œè¯„ä»·æŒ‡æ ‡ï¼ˆmetricsï¼‰æ²¡æœ‰ç†è§£ï¼Œæ‰€ä»¥æˆ‘å¯¹losså’Œlog_rmseçº ç»“äº†å¾ˆä¹…ã€‚</p>
<p>è¿™é‡Œæˆ‘çš„ç†è§£æ˜¯ï¼Œ</p>
<p>lossæ˜¯éœ€è¦ä¸¢åˆ°ç½‘ç»œé‡Œçš„ï¼Œæ˜¯ç½‘ç»œä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°ï¼›å› ä¸ºéœ€è¦é€šè¿‡æ¢¯åº¦ä¸‹é™æ¥åå‘ä¼ æ’­ï¼Œæ‰€ä»¥å¿…é¡»æ˜¯å¯å¯¼çš„ï¼›</p>
<p>metricsæ˜¯è¯„ä»·ç½‘ç»œçš„ä¸€ç§æŒ‡æ ‡ï¼Œä¸å‚ä¸ä¼˜åŒ–ï¼›ä¸éœ€è¦å¯å¯¼ã€‚</p>
<p>æ›´å¤šå…³äºæŸå¤±å‡½æ•°å’Œè¯„ä»·æŒ‡æ ‡è¯·å‚è§<em>å‚è€ƒèµ„æ–™3</em>ï¼Œ<em>å‚è€ƒèµ„æ–™4</em></p>
</blockquote>
<hr>
<p>æˆ‘ä»¬çš„è®­ç»ƒå‡½æ•°å°†å€ŸåŠ©Adamä¼˜åŒ–å™¨ã€‚</p>
<p>Adamä¼˜åŒ–å™¨çš„ä¸»è¦å¸å¼•åŠ›åœ¨äºå®ƒå¯¹åˆå§‹å­¦ä¹ ç‡ä¸é‚£ä¹ˆæ•æ„Ÿã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">net, train_features, train_labels, test_features, test_labels,</span></span><br><span class="line"><span class="params">          num_epochs, learning_rate, weight_decay, batch_size</span>):</span><br><span class="line">    train_ls, test_ls = [], []</span><br><span class="line">    train_iter = d2l.load_array((train_features, train_labels), batch_size)</span><br><span class="line">    <span class="comment"># è¿™é‡Œä½¿ç”¨çš„æ˜¯Adamä¼˜åŒ–ç®—æ³•</span></span><br><span class="line">    optimizer = torch.optim.Adam(net.parameters(),</span><br><span class="line">                                 lr = learning_rate,</span><br><span class="line">                                 weight_decay = weight_decay)</span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">        <span class="keyword">for</span> X, y <span class="keyword">in</span> train_iter:</span><br><span class="line">            optimizer.zero_grad()</span><br><span class="line">            l = loss(net(X), y)</span><br><span class="line">            l.backward()</span><br><span class="line">            optimizer.step()</span><br><span class="line">        train_ls.append(log_rmse(net, train_features, train_labels))</span><br><span class="line">        <span class="keyword">if</span> test_labels <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            test_ls.append(log_rmse(net, test_features, test_labels))</span><br><span class="line">    <span class="keyword">return</span> train_ls, test_ls</span><br></pre></td></tr></table></figure>
<h1 id="K-æŠ˜äº¤å‰éªŒè¯"><a href="#K-æŠ˜äº¤å‰éªŒè¯" class="headerlink" title="K-æŠ˜äº¤å‰éªŒè¯"></a>K-æŠ˜äº¤å‰éªŒè¯</h1><p>æ‰€è°“K-æŠ˜äº¤å‰éªŒè¯å°±æ˜¯æŠŠtrain dataåˆ†ä¸ºKä»½ï¼Œæ¯æ¬¡1/Kä»½ä½œä¸ºéªŒè¯é›†ï¼ŒæŠŠå¦å¤–çš„1 - 1/Kä»½ä½œä¸ºè®­ç»ƒé›†ã€‚äº‹å®ä¸Šï¼Œ<code>get_k_fold_data</code>å°±æ˜¯åœ¨åšè¿™ä»¶äº‹ã€‚</p>
<p>K-æŠ˜äº¤å‰éªŒè¯æœ‰åŠ©äºæ¨¡å‹é€‰æ‹©å’Œè¶…å‚æ•°è°ƒæ•´ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_k_fold_data</span>(<span class="params">k, i, X, y</span>):</span><br><span class="line">    <span class="keyword">assert</span> k &gt; <span class="number">1</span></span><br><span class="line">    fold_size = X.shape[<span class="number">0</span>] // k</span><br><span class="line">    X_train, y_train = <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="comment"># sliceæ–¹æ³•è¯´æ˜è¯¦è§å‚è€ƒèµ„æ–™6</span></span><br><span class="line">        idx = <span class="built_in">slice</span>(j * fold_size, (j + <span class="number">1</span>) * fold_size)</span><br><span class="line">        X_part, y_part = X[idx, :], y[idx]</span><br><span class="line">        <span class="keyword">if</span> j == i:</span><br><span class="line">            X_valid, y_valid = X_part, y_part</span><br><span class="line">        <span class="keyword">elif</span> X_train <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            X_train, y_train = X_part, y_part</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            X_train = torch.cat([X_train, X_part], <span class="number">0</span>) <span class="comment"># å°†å·²æœ‰çš„X_trainå’ŒX_partè¿æ¥èµ·æ¥</span></span><br><span class="line">            y_train = torch.cat([y_train, y_part], <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> X_train, y_train, X_valid, y_valid</span><br></pre></td></tr></table></figure>
<p><code>k_fold</code>ä¸­å…ˆæ±‚æ¯ä¸€æŠ˜å¾—åˆ°çš„trian-loss, valid-lossï¼Œæ³¨æ„train_lså’Œvalid_lsæ˜¯ä¸€ä¸ªlistï¼Œå­˜æ”¾äº†æ¯æ¬¡è¿­ä»£ålosså€¼ï¼Œæˆ‘ä»¬å–train_ls[-1]ï¼Œä¹Ÿå°±æ˜¯æœ€ç»ˆçš„é‚£ä¸ªloss</p>
<p>æœ€åæŠŠæ‰€æœ‰K-æŠ˜å¾—åˆ°çš„train-lossçš„å¹³å‡å’Œvalid-lossçš„å¹³å‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">k_fold</span>(<span class="params">k, X_train, y_train, num_epochs, learning_rate, weight_decay,</span></span><br><span class="line"><span class="params">           batch_size</span>):</span><br><span class="line">    train_l_sum, valid_l_sum = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="comment"># è¿™é‡Œdataå®é™…æ˜¯ä¸€ä¸ªå…ƒç»„(X_train, y_train, X_valid, y_valid)</span></span><br><span class="line">        data = get_k_fold_data(k, i, X_train, y_train)</span><br><span class="line">        net = get_net()</span><br><span class="line">        <span class="comment"># æŠŠdataè¿™ä¸ªå…ƒç»„ä¼ å…¥ï¼Œå¯¹åº”trainä¸­çš„train_features, train_labels, test_features, test_labelså››ä¸ªå‚æ•°</span></span><br><span class="line">        train_ls, valid_ls = train(net, *data, num_epochs, learning_rate,</span><br><span class="line">                                   weight_decay, batch_size)</span><br><span class="line">        train_l_sum += train_ls[-<span class="number">1</span>]</span><br><span class="line">        valid_l_sum += valid_ls[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            d2l.plot(<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>, num_epochs + <span class="number">1</span>)), [train_ls, valid_ls],</span><br><span class="line">                     xlabel=<span class="string">&#x27;epoch&#x27;</span>, ylabel=<span class="string">&#x27;rmse&#x27;</span>, xlim=[<span class="number">1</span>, num_epochs],</span><br><span class="line">                     legend=[<span class="string">&#x27;train&#x27;</span>, <span class="string">&#x27;valid&#x27;</span>], yscale=<span class="string">&#x27;log&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;æŠ˜<span class="subst">&#123;i + <span class="number">1</span>&#125;</span>ï¼Œè®­ç»ƒlog rmse<span class="subst">&#123;<span class="built_in">float</span>(train_ls[-<span class="number">1</span>]):f&#125;</span>, &#x27;</span></span><br><span class="line">              <span class="string">f&#x27;éªŒè¯log rmse<span class="subst">&#123;<span class="built_in">float</span>(valid_ls[-<span class="number">1</span>]):f&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> train_l_sum / k, valid_l_sum / k</span><br></pre></td></tr></table></figure>
<h1 id="æ¨¡å‹é€‰æ‹©"><a href="#æ¨¡å‹é€‰æ‹©" class="headerlink" title="æ¨¡å‹é€‰æ‹©"></a>æ¨¡å‹é€‰æ‹©</h1><p>ä¸‹é¢æ˜¯ä¸€ç»„è¶…å‚æ•°ï¼Œåé¢æˆ‘ä»¬å¯ä»¥å¯¹æ­¤è¿›è¡Œè°ƒä¼˜ï¼ˆæ”¹æ”¹æ•°ï¼Œ run run codeï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">k, num_epochs, lr, weight_decay, batch_size = <span class="number">5</span>, <span class="number">100</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">64</span></span><br><span class="line">train_l, valid_l = k_fold(k, train_features, train_labels, num_epochs, lr,</span><br><span class="line">                          weight_decay, batch_size)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;k&#125;</span>-æŠ˜éªŒè¯: å¹³å‡è®­ç»ƒlog rmse: <span class="subst">&#123;<span class="built_in">float</span>(train_l):f&#125;</span>, &#x27;</span></span><br><span class="line">      <span class="string">f&#x27;å¹³å‡éªŒè¯log rmse: <span class="subst">&#123;<span class="built_in">float</span>(valid_l):f&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>æŠ˜1ï¼Œè®­ç»ƒlog rmse0.168934, éªŒè¯log rmse0.158768
æŠ˜2ï¼Œè®­ç»ƒlog rmse0.162051, éªŒè¯log rmse0.186553
æŠ˜3ï¼Œè®­ç»ƒlog rmse0.163633, éªŒè¯log rmse0.167966
æŠ˜4ï¼Œè®­ç»ƒlog rmse0.167716, éªŒè¯log rmse0.154111
æŠ˜5ï¼Œè®­ç»ƒlog rmse0.161381, éªŒè¯log rmse0.184188
5-æŠ˜éªŒè¯: å¹³å‡è®­ç»ƒlog rmse: 0.164743, å¹³å‡éªŒè¯log rmse: 0.170317
</code></pre><p><img src="kaggle-house-prices_31_1.svg" alt="svg"></p>
<p>è¯·æ³¨æ„ï¼Œæœ‰æ—¶ä¸€ç»„è¶…å‚æ•°çš„è®­ç»ƒè¯¯å·®å¯èƒ½éå¸¸ä½ï¼Œä½† K æŠ˜äº¤å‰éªŒè¯çš„è¯¯å·®è¦é«˜å¾—å¤šï¼Œ è¿™è¡¨æ˜æ¨¡å‹è¿‡æ‹Ÿåˆäº†ã€‚ åœ¨æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä½ å°†å¸Œæœ›ç›‘æ§è®­ç»ƒè¯¯å·®å’ŒéªŒè¯è¯¯å·®è¿™ä¸¤ä¸ªæ•°å­—ã€‚ è¾ƒå°‘çš„è¿‡æ‹Ÿåˆå¯èƒ½è¡¨æ˜ç°æœ‰æ•°æ®å¯ä»¥æ”¯æ’‘ä¸€ä¸ªæ›´å¼ºå¤§çš„æ¨¡å‹ï¼Œ è¾ƒå¤§çš„è¿‡æ‹Ÿåˆå¯èƒ½æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€šè¿‡æ­£åˆ™åŒ–æŠ€æœ¯æ¥è·ç›Šã€‚</p>
<h1 id="æäº¤Kaggleé¢„æµ‹"><a href="#æäº¤Kaggleé¢„æµ‹" class="headerlink" title="æäº¤Kaggleé¢„æµ‹"></a>æäº¤Kaggleé¢„æµ‹</h1><p>å½“æˆ‘ä»¬ç”¨ä¸Šé¢çš„K-æŠ˜äº¤å‰éªŒè¯ç¡®å®šå‚æ•°åï¼Œæˆ‘ä»¬å°†è¶…å‚æ•°å›ºå®šä½ï¼ŒæŠŠæ‰€æœ‰çš„train dataæ‹¿æ¥trainã€‚</p>
<p>å¦‚æœæµ‹è¯•é›†ä¸Šçš„é¢„æµ‹ä¸ K å€äº¤å‰éªŒè¯è¿‡ç¨‹ä¸­çš„é¢„æµ‹ç›¸ä¼¼ï¼Œ é‚£å°±æ˜¯æ—¶å€™æŠŠå®ƒä»¬ä¸Šä¼ åˆ°Kaggleäº†ã€‚ ä¸‹é¢çš„ä»£ç å°†ç”Ÿæˆä¸€ä¸ªåä¸ºsubmission.csvçš„æ–‡ä»¶ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train_and_pred</span>(<span class="params">train_features, test_feature, train_labels, test_data,</span></span><br><span class="line"><span class="params">                   num_epochs, lr, weight_decay, batch_size</span>):</span><br><span class="line">    net = get_net()</span><br><span class="line">    train_ls, _ = train(net, train_features, train_labels, <span class="literal">None</span>, <span class="literal">None</span>,</span><br><span class="line">                        num_epochs, lr, weight_decay, batch_size)</span><br><span class="line">    d2l.plot(np.arange(<span class="number">1</span>, num_epochs + <span class="number">1</span>), [train_ls], xlabel=<span class="string">&#x27;epoch&#x27;</span>,</span><br><span class="line">             ylabel=<span class="string">&#x27;log rmse&#x27;</span>, xlim=[<span class="number">1</span>, num_epochs], yscale=<span class="string">&#x27;log&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;è®­ç»ƒlog rmseï¼š<span class="subst">&#123;<span class="built_in">float</span>(train_ls[-<span class="number">1</span>]):f&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="comment"># å°†ç½‘ç»œåº”ç”¨äºæµ‹è¯•é›†ã€‚</span></span><br><span class="line">    preds = net(test_features).detach().numpy()</span><br><span class="line">    <span class="comment"># å°†å…¶é‡æ–°æ ¼å¼åŒ–ä»¥å¯¼å‡ºåˆ°Kaggle</span></span><br><span class="line">    test_data[<span class="string">&#x27;SalePrice&#x27;</span>] = pd.Series(preds.reshape(<span class="number">1</span>, -<span class="number">1</span>)[<span class="number">0</span>])</span><br><span class="line">    submission = pd.concat([test_data[<span class="string">&#x27;Id&#x27;</span>], test_data[<span class="string">&#x27;SalePrice&#x27;</span>]], axis=<span class="number">1</span>)</span><br><span class="line">    submission.to_csv(<span class="string">&#x27;submission.csv&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">train_and_pred(train_features, test_features, train_labels, test_data,</span><br><span class="line">               num_epochs, lr, weight_decay, batch_size)</span><br></pre></td></tr></table></figure>
<pre><code>è®­ç»ƒlog rmseï¼š0.162150
</code></pre><p><img src="kaggle-house-prices_34_1.svg" alt="svg"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ç”Ÿæˆçš„<code>submission.csv</code>æ–‡ä»¶æäº¤åˆ°Kaggleï¼š</p>
<ul>
<li>è®¿é—®<a target="_blank" rel="noopener" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data">https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data</a></li>
<li>ç‚¹å‡»â€œSubmit Predictionsâ€</li>
<li>é€‰æ‹©ä½ è¦ä¸Šä¼ çš„é¢„æµ‹æ–‡ä»¶<code>submission.csv</code></li>
<li>ç‚¹å‡»é¡µé¢åº•éƒ¨çš„â€œMake Submissionâ€æŒ‰é’®ï¼Œå³å¯æŸ¥çœ‹ç»“æœã€‚</li>
</ul>
<h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><ul>
<li>çœŸå®æ•°æ®é€šå¸¸æ··åˆäº†ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œéœ€è¦è¿›è¡Œé¢„å¤„ç†ã€‚</li>
<li>å¸¸ç”¨çš„é¢„å¤„ç†æ–¹æ³•ï¼šå°†å®å€¼æ•°æ®é‡æ–°ç¼©æ”¾ä¸ºé›¶å‡å€¼å’Œå•ä½æ–¹æ³•ï¼›ç”¨å‡å€¼æ›¿æ¢ç¼ºå¤±å€¼ã€‚</li>
<li>å°†ç±»åˆ«ç‰¹å¾è½¬åŒ–ä¸ºæŒ‡æ ‡ç‰¹å¾ï¼Œå¯ä»¥ä½¿æˆ‘ä»¬æŠŠè¿™ä¸ªç‰¹å¾å½“ä½œä¸€ä¸ªç‹¬çƒ­å‘é‡æ¥å¯¹å¾…ã€‚</li>
<li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ K æŠ˜äº¤å‰éªŒè¯æ¥é€‰æ‹©æ¨¡å‹å¹¶è°ƒæ•´è¶…å‚æ•°ã€‚</li>
<li>å¯¹æ•°å¯¹äºç›¸å¯¹è¯¯å·®å¾ˆæœ‰ç”¨ã€‚</li>
</ul>
<h1 id="æ›´è¿›ä¸€æ­¥"><a href="#æ›´è¿›ä¸€æ­¥" class="headerlink" title="æ›´è¿›ä¸€æ­¥"></a>æ›´è¿›ä¸€æ­¥</h1><p>è¿™é‡Œæ˜¯ä¹¦ä¸­ç»™å‡ºçš„ä¸€äº›æ€è€ƒé—®é¢˜ï¼Œæˆ‘æ²¡åšï¼Œä½†æ˜¯ä¾ç„¶åˆ—å‡ºæ¥ä¾›å‚è€ƒï¼š</p>
<ol>
<li>å°†è¯•å›¾é¢„æµ‹ä»·æ ¼æ”¹ä¸ºè¯•å›¾é¢„æµ‹ä»·æ ¼çš„å¯¹æ•°ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</li>
<li>ç”¨å¹³å‡å€¼æ›¿æ¢ç¼ºå¤±å€¼æ€»æ˜¯å¥½ä¸»æ„å—ï¼Ÿæç¤ºï¼šä½ èƒ½æ„é€ ä¸€ä¸ªä¸éšæœºä¸¢å¤±å€¼çš„æƒ…å†µå—ï¼Ÿ</li>
<li>é€šè¿‡ K æŠ˜äº¤å‰éªŒè¯è°ƒæ•´è¶…å‚æ•°ï¼Œä»è€Œæé«˜Kaggleçš„å¾—åˆ†ã€‚</li>
<li>é€šè¿‡æ”¹è¿›æ¨¡å‹ï¼ˆä¾‹å¦‚ï¼Œå±‚ã€æƒé‡è¡°å‡å’Œdropoutï¼‰æ¥æé«˜åˆ†æ•°ã€‚</li>
<li>å¦‚æœæˆ‘ä»¬æ²¡æœ‰åƒæœ¬èŠ‚æ‰€åšçš„é‚£æ ·æ ‡å‡†åŒ–è¿ç»­çš„æ•°å€¼ç‰¹å¾ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</li>
</ol>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>æˆ‘ä»”ç»†é˜…è¯»åŸæ–‡ï¼Œæ‹äº†ä¸€è¾¹ä»£ç ã€‚</p>
<p>åŸºç¡€æ¯”è¾ƒå·®ï¼Œæœ‰äº›åœ°æ–¹è®¤è¯†ä¸å¤ªæ¸…æ™°ï¼Œå…¨å‡­è‡ªå·±ç†è§£ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œè¯·å¤šåŒ…æ¶µï¼Œæˆ–ç›´æ¥é‚®ç®±è”ç³»æˆ‘ã€‚</p>
<p>æˆ‘åŸä»¥ä¸ºä¼šæœ‰è®­ç»ƒæ¨¡å‹é”™è¯¯ç‡ä¸æ–­é™ä½çš„æˆå°±æ„Ÿã€‚ã€‚ä½†å®é™…ä¸Šå…¨æ˜¯å¤åˆ¶ç²˜è´´run codeã€‚</p>
<p>å¥½åƒå­¦åˆ°äº†åˆå¥½åƒæ²¡å­¦åˆ°ã€‚ğŸ¤¦â€</p>
<h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ol>
<li><a target="_blank" rel="noopener" href="http://zh-v2.d2l.ai/chapter_multilayer-perceptrons/kaggle-house-price.html#id6">ã€ŠåŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ã€‹ 4.10. å®æˆ˜Kaggleæ¯”èµ›ï¼šé¢„æµ‹æˆ¿ä»·</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangqiang9/p/9285594.html">æ•°æ®é¢„å¤„ç†ä¹‹ä¸­å¿ƒåŒ–ï¼ˆé›¶å‡å€¼åŒ–ï¼‰ä¸æ ‡å‡†åŒ–ï¼ˆå½’ä¸€åŒ–ï¼‰</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/373032887">æœºå™¨å­¦ä¹ â€”â€”æŸå¤±å‡½æ•°(loss)ä¸è¯„ä»·æŒ‡æ ‡(metric)çš„åŒºåˆ«ï¼Ÿ</a></li>
<li><a target="_blank" rel="noopener" href="https://codeantenna.com/a/7p6uOqnNhx">kerasä¸­compileæ–¹æ³•çš„ loss å’Œ metrics åŒºåˆ«</a></li>
<li><a target="_blank" rel="noopener" href="https://pytorch.org/docs/stable/generated/torch.clamp.html">torch.clampæ–¹æ³•è¯´æ˜</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-slice.html">Python sliceæ–¹æ³•è¯´æ˜</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37871195/article/details/79829488">æ·±åº¦å­¦ä¹ ä¸­iterationã€epochã€batchsizeçš„å®šä¹‰</a></li>
<li><a target="_blank" rel="noopener" href="https://pytorch.org/docs/1.9.1/generated/torch.Tensor.detach.html">torch.detachæ–¹æ³•è¯´æ˜</a></li>
<li><a target="_blank" rel="noopener" href="https://pytorch.org/docs/stable/generated/torch.cat.html#torch.cat">torch.catæ–¹æ³•è¯´æ˜</a></li>
<li><a target="_blank" rel="noopener" href="https://csbwang.github.io/dl_ch2">æœºå™¨å­¦ä¹ åŸºç¡€</a></li>
</ol>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Met Guo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://guoyujian.github.io/2022/01/12/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%AE%AD%E7%BB%83%E5%88%9D%E4%BD%93%E9%AA%8C-%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B%E6%AF%94%E8%B5%9B/">https://guoyujian.github.io/2022/01/12/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%AE%AD%E7%BB%83%E5%88%9D%E4%BD%93%E9%AA%8C-%E6%88%BF%E4%BB%B7%E9%A2%84%E6%B5%8B%E6%AF%94%E8%B5%9B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://guoyujian.github.io">Gmet's Blog</a>ï¼</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2022/01/15/HTTP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%B9%82%E7%AD%89%E6%80%A7/"><i class="fa fa-chevron-left">  </i><span>HTTPåè®®çš„å¹‚ç­‰æ€§</span></a></div><div class="next-post pull-right"><a href="/2022/01/10/%E3%80%8A%E5%8A%A8%E6%89%8B%E5%AD%A6%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89-%E5%89%8D%E8%A8%80/"><span>ã€ŠåŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ã€‹è¯»ä¹¦ç¬”è®°ï¼ˆä¸€ï¼‰ å‰è¨€</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://images7.alphacoders.com/550/thumb-1920-550739.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2021 - 2023 By Met Guo</div><div class="framework-info"><span>é©±åŠ¨ - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.8.2"></script><script src="/js/fancybox.js?version=1.8.2"></script><script src="/js/sidebar.js?version=1.8.2"></script><script src="/js/copy.js?version=1.8.2"></script><script src="/js/fireworks.js?version=1.8.2"></script><script src="/js/transition.js?version=1.8.2"></script><script src="/js/scroll.js?version=1.8.2"></script><script src="/js/head.js?version=1.8.2"></script><script src="/js/search/algolia.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>